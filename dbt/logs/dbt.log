[0m09:01:13.375502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d2ee6ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d2f023690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d2f1f8350>]}


============================== 09:01:13.387913 | dad63ffa-2d87-4fc9-8a5f-74297f72a74e ==============================
[0m09:01:13.387913 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m09:01:13.389668 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'log_path': 'logs', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'empty': 'None', 'quiet': 'False'}
[0m09:01:13.422046 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m09:01:13.423755 [info ] [MainThread]: python version: 3.11.2
[0m09:01:13.425260 [info ] [MainThread]: python path: /usr/local/bin/python
[0m09:01:13.426914 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m09:01:13.428613 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m09:01:13.430526 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m09:01:13.431894 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:01:13.433558 [info ] [MainThread]: Configuration:
[0m09:01:13.435042 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m09:01:13.436792 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m09:01:13.438529 [info ] [MainThread]: Required dependencies:
[0m09:01:13.439907 [debug] [MainThread]: Executing "git --help"
[0m09:01:13.461308 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:01:13.466950 [debug] [MainThread]: STDERR: "b''"
[0m09:01:13.468024 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:01:13.469461 [info ] [MainThread]: Connection test skipped since no profile was found
[0m09:01:13.471141 [info ] [MainThread]: [31m2 checks failed:[0m
[0m09:01:13.472949 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m09:01:13.474685 [info ] [MainThread]: Project loading failed for the following reason:
 project path </usr/app/dbt_project.yml> not found

[0m09:01:13.480271 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.18394795, "process_in_blocks": "2000", "process_kernel_time": 0.590978, "process_mem_max_rss": "98312", "process_out_blocks": "1576", "process_user_time": 1.22684}
[0m09:01:13.482233 [debug] [MainThread]: Command `dbt debug` failed at 09:01:13.481975 after 0.19 seconds
[0m09:01:13.483479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d2ee6e1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d2ee7a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723d2ee6d5d0>]}
[0m09:01:13.484476 [debug] [MainThread]: Flushing usage events
[0m09:01:13.946118 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:02:59.271911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6418f12c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6418e5c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6418a8ce90>]}


============================== 10:02:59.291908 | a901c20e-4cac-41ff-8e32-5daab5c81fb1 ==============================
[0m10:02:59.291908 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m10:02:59.293942 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/usr/app/logs', 'quiet': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'debug': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/app', 'version_check': 'True'}
[0m10:02:59.336866 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m10:02:59.340244 [info ] [MainThread]: python version: 3.11.2
[0m10:02:59.342993 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:02:59.345275 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m10:02:59.372126 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m10:02:59.375074 [info ] [MainThread]: Using profiles dir at /usr/app
[0m10:02:59.377353 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m10:02:59.379731 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m10:02:59.505052 [info ] [MainThread]: Configuration:
[0m10:02:59.506991 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m10:02:59.508854 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:02:59.510773 [info ] [MainThread]: Required dependencies:
[0m10:02:59.512517 [debug] [MainThread]: Executing "git --help"
[0m10:02:59.551955 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:02:59.553958 [debug] [MainThread]: STDERR: "b''"
[0m10:02:59.555666 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:02:59.557195 [info ] [MainThread]: Connection test skipped since no profile was found
[0m10:02:59.559007 [info ] [MainThread]: [31m1 check failed:[0m
[0m10:02:59.560603 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "hubspot_elt", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!


[0m10:02:59.564792 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.41496494, "process_in_blocks": "11880", "process_kernel_time": 1.211723, "process_mem_max_rss": "99936", "process_out_blocks": "1576", "process_user_time": 1.678939}
[0m10:02:59.566434 [debug] [MainThread]: Command `dbt debug` failed at 10:02:59.566242 after 0.42 seconds
[0m10:02:59.567834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6418b91690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6418b920d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6418c7bcd0>]}
[0m10:02:59.569655 [debug] [MainThread]: Flushing usage events
[0m10:03:00.009069 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:06:42.787103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bd8250c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bd80c75ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bd80c762f0>]}


============================== 10:06:42.794040 | 55b2c1b1-b539-4a7e-99fb-d9e7e31d4d06 ==============================
[0m10:06:42.794040 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:06:42.796079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:06:42.799001 [info ] [MainThread]: dbt version: 1.7.10
[0m10:06:42.800750 [info ] [MainThread]: python version: 3.10.7
[0m10:06:42.802724 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:06:42.804683 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m10:06:42.934128 [info ] [MainThread]: Using profiles dir at /usr/app
[0m10:06:42.936393 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m10:06:42.938250 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m10:06:42.940400 [info ] [MainThread]: adapter type: postgres
[0m10:06:42.942058 [info ] [MainThread]: adapter version: 1.7.10
[0m10:06:43.030187 [info ] [MainThread]: Configuration:
[0m10:06:43.032647 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:06:43.034729 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:06:43.036505 [info ] [MainThread]: Required dependencies:
[0m10:06:43.038199 [debug] [MainThread]: Executing "git --help"
[0m10:06:43.043100 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:06:43.044991 [debug] [MainThread]: STDERR: "b''"
[0m10:06:43.046320 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:06:43.047990 [info ] [MainThread]: Connection:
[0m10:06:43.050011 [info ] [MainThread]:   host: postgres
[0m10:06:43.052018 [info ] [MainThread]:   port: 5432
[0m10:06:43.053818 [info ] [MainThread]:   user: elt
[0m10:06:43.055296 [info ] [MainThread]:   database: warehouse
[0m10:06:43.057425 [info ] [MainThread]:   schema: marts
[0m10:06:43.059524 [info ] [MainThread]:   connect_timeout: 10
[0m10:06:43.061313 [info ] [MainThread]:   role: None
[0m10:06:43.062785 [info ] [MainThread]:   search_path: None
[0m10:06:43.064762 [info ] [MainThread]:   keepalives_idle: 0
[0m10:06:43.066852 [info ] [MainThread]:   sslmode: None
[0m10:06:43.068630 [info ] [MainThread]:   sslcert: None
[0m10:06:43.070341 [info ] [MainThread]:   sslkey: None
[0m10:06:43.072701 [info ] [MainThread]:   sslrootcert: None
[0m10:06:43.074605 [info ] [MainThread]:   application_name: dbt
[0m10:06:43.076417 [info ] [MainThread]:   retries: 1
[0m10:06:43.078168 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:06:43.080665 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:06:43.082439 [debug] [MainThread]: Using postgres connection "debug"
[0m10:06:43.083769 [debug] [MainThread]: On debug: select 1 as id
[0m10:06:43.085311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:06:43.102103 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:06:43.104361 [debug] [MainThread]: On debug: Close
[0m10:06:43.106008 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:06:43.107706 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:06:43.110603 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.38084432, "process_user_time": 1.908243, "process_kernel_time": 0.289812, "process_mem_max_rss": "93788", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m10:06:43.112615 [debug] [MainThread]: Command `dbt debug` succeeded at 10:06:43.112409 after 0.38 seconds
[0m10:06:43.113951 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:06:43.115183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bd8250c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bd80c77a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bd7eff9bd0>]}
[0m10:06:43.116891 [debug] [MainThread]: Flushing usage events
[0m10:06:55.650324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbcfba4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbcdfd57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbcdfd5780>]}


============================== 10:06:55.657394 | 0a94b633-329f-46c7-b4fd-3b2312865cc1 ==============================
[0m10:06:55.657394 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:06:55.659413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:06:55.867482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a94b633-329f-46c7-b4fd-3b2312865cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbce00b550>]}
[0m10:06:55.954573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a94b633-329f-46c7-b4fd-3b2312865cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbd00dc340>]}
[0m10:06:55.957013 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:06:55.967008 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:06:55.973877 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:06:55.975428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0a94b633-329f-46c7-b4fd-3b2312865cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbcdfd73a0>]}
[0m10:06:57.676621 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:06:57.684074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a94b633-329f-46c7-b4fd-3b2312865cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbca48feb0>]}
[0m10:06:57.731168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a94b633-329f-46c7-b4fd-3b2312865cc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbca48f670>]}
[0m10:06:57.733449 [info ] [MainThread]: Found 33 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:06:57.736942 [info ] [MainThread]: 
[0m10:06:57.739110 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:06:57.741564 [debug] [MainThread]: Command end result
[0m10:06:57.772560 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.1790817, "process_user_time": 3.194017, "process_kernel_time": 0.48233, "process_mem_max_rss": "100760", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m10:06:57.774863 [debug] [MainThread]: Command `dbt build` succeeded at 10:06:57.774643 after 2.18 seconds
[0m10:06:57.776949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbcfba4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbcc6bbc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dbcc7b6890>]}
[0m10:06:57.778734 [debug] [MainThread]: Flushing usage events
[0m10:09:53.839975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8f248880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8db666b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8db65360>]}


============================== 10:09:53.847575 | baf4a8a8-8bac-4f38-a4be-6d53b32704bb ==============================
[0m10:09:53.847575 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:09:53.849211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type model', 'send_anonymous_usage_stats': 'True'}
[0m10:09:54.049143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baf4a8a8-8bac-4f38-a4be-6d53b32704bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8fa54fa0>]}
[0m10:09:54.135021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baf4a8a8-8bac-4f38-a4be-6d53b32704bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8f781090>]}
[0m10:09:54.137409 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:09:54.154718 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:09:55.084556 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:09:55.086513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:09:55.089321 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:09:55.096573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baf4a8a8-8bac-4f38-a4be-6d53b32704bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8ba3c0d0>]}
[0m10:09:55.139029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baf4a8a8-8bac-4f38-a4be-6d53b32704bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8bb25f60>]}
[0m10:09:55.140880 [info ] [MainThread]: Found 33 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:09:55.143189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baf4a8a8-8bac-4f38-a4be-6d53b32704bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8bb260b0>]}
[0m10:09:55.146737 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.3651929, "process_user_time": 2.010348, "process_kernel_time": 0.386897, "process_mem_max_rss": "97652", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m10:09:55.148643 [debug] [MainThread]: Command `dbt ls` succeeded at 10:09:55.148450 after 1.37 seconds
[0m10:09:55.150248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8f248880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8bd28610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799f8bb256f0>]}
[0m10:09:55.151738 [debug] [MainThread]: Flushing usage events
[0m10:34:47.804201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbcf0858880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbceefce6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbceefcd360>]}


============================== 10:34:47.812827 | bfdf5f8c-5a2a-4ef4-8c0b-9dcf60116e7b ==============================
[0m10:34:47.812827 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:34:47.815040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type source', 'send_anonymous_usage_stats': 'True'}
[0m10:34:48.117166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfdf5f8c-5a2a-4ef4-8c0b-9dcf60116e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbcf1070fa0>]}
[0m10:34:48.220327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfdf5f8c-5a2a-4ef4-8c0b-9dcf60116e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbcf0ee5090>]}
[0m10:34:48.223286 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:34:48.243628 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:34:49.192026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:34:49.193672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:34:49.196071 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:34:49.203907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfdf5f8c-5a2a-4ef4-8c0b-9dcf60116e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbced09c0d0>]}
[0m10:34:49.245914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfdf5f8c-5a2a-4ef4-8c0b-9dcf60116e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbced181f60>]}
[0m10:34:49.247608 [info ] [MainThread]: Found 33 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:34:49.249598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfdf5f8c-5a2a-4ef4-8c0b-9dcf60116e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbced1820b0>]}
[0m10:34:49.251960 [warn ] [MainThread]: No nodes selected!
[0m10:34:49.255413 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.5306451, "process_user_time": 2.720427, "process_kernel_time": 0.490818, "process_mem_max_rss": "96832", "process_in_blocks": "78656", "process_out_blocks": "608"}
[0m10:34:49.257222 [debug] [MainThread]: Command `dbt ls` succeeded at 10:34:49.257041 after 1.53 seconds
[0m10:34:49.259045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbcf0858880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbced38c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbced1816f0>]}
[0m10:34:49.260794 [debug] [MainThread]: Flushing usage events
[0m10:41:05.351682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77991ccf4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77991b45e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77991b45d3c0>]}


============================== 10:41:05.361013 | c1aa8fff-ed00-4f35-8469-626c6de442c7 ==============================
[0m10:41:05.361013 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:41:05.363555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type source', 'send_anonymous_usage_stats': 'True'}
[0m10:41:05.687647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1aa8fff-ed00-4f35-8469-626c6de442c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77991b19f700>]}
[0m10:41:05.777718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1aa8fff-ed00-4f35-8469-626c6de442c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77991d371060>]}
[0m10:41:05.780519 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:41:05.798581 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:41:06.572213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:41:06.574296 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/sources/src_hubspot.yml
[0m10:41:06.679869 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:41:06.688778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1aa8fff-ed00-4f35-8469-626c6de442c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779919427ee0>]}
[0m10:41:06.731860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1aa8fff-ed00-4f35-8469-626c6de442c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779919615fc0>]}
[0m10:41:06.733964 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:41:06.736110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1aa8fff-ed00-4f35-8469-626c6de442c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779919616170>]}
[0m10:41:06.741684 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.4720696, "process_user_time": 2.347457, "process_kernel_time": 0.56689, "process_mem_max_rss": "98644", "process_in_blocks": "73704", "process_out_blocks": "608"}
[0m10:41:06.743701 [debug] [MainThread]: Command `dbt ls` succeeded at 10:41:06.743497 after 1.47 seconds
[0m10:41:06.745384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77991ccf4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77991d371060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7799196161d0>]}
[0m10:41:06.746654 [debug] [MainThread]: Flushing usage events
[0m10:41:30.931603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b49e8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b2e69780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b2e69720>]}


============================== 10:41:30.938202 | d29a4b01-c3fc-4a4a-88df-03574547988e ==============================
[0m10:41:30.938202 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:41:30.940190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s tag:staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:31.153262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd29a4b01-c3fc-4a4a-88df-03574547988e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b2eab4f0>]}
[0m10:41:31.240979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd29a4b01-c3fc-4a4a-88df-03574547988e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b50742e0>]}
[0m10:41:31.243636 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:41:31.260143 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:41:31.924492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:41:31.926548 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:41:31.928859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:41:31.936009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd29a4b01-c3fc-4a4a-88df-03574547988e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b1243d90>]}
[0m10:41:31.974751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd29a4b01-c3fc-4a4a-88df-03574547988e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b1307340>]}
[0m10:41:31.976868 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:41:31.979132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd29a4b01-c3fc-4a4a-88df-03574547988e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b1307490>]}
[0m10:41:31.981183 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any nodes
[0m10:41:31.983595 [info ] [MainThread]: 
[0m10:41:31.985693 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:41:31.987959 [debug] [MainThread]: Command end result
[0m10:41:32.015071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1416097, "process_user_time": 2.11482, "process_kernel_time": 0.29941, "process_mem_max_rss": "97484", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m10:41:32.017227 [debug] [MainThread]: Command `dbt run` succeeded at 10:41:32.016979 after 1.14 seconds
[0m10:41:32.019109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b49e8a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b50742e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b2b1519660>]}
[0m10:41:32.021219 [debug] [MainThread]: Flushing usage events
[0m10:52:03.582227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070f950a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070e0c16f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070e0c08e0>]}


============================== 10:52:03.590881 | c7dba957-28b1-4173-b8f6-d8f2e2bb3458 ==============================
[0m10:52:03.590881 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:52:03.593083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ls --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m10:52:03.910566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7dba957-28b1-4173-b8f6-d8f2e2bb3458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070e0c3ac0>]}
[0m10:52:04.020837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7dba957-28b1-4173-b8f6-d8f2e2bb3458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070ffd9030>]}
[0m10:52:04.023634 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:52:04.041428 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:52:04.779948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:04.781708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:04.784073 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:52:04.792007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7dba957-28b1-4173-b8f6-d8f2e2bb3458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070c19bfd0>]}
[0m10:52:04.836622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7dba957-28b1-4173-b8f6-d8f2e2bb3458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070c25f640>]}
[0m10:52:04.838724 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:52:04.840754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7dba957-28b1-4173-b8f6-d8f2e2bb3458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070c25f7c0>]}
[0m10:52:04.846743 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.336307, "process_user_time": 2.353253, "process_kernel_time": 0.500772, "process_mem_max_rss": "96856", "process_in_blocks": "78656", "process_out_blocks": "608"}
[0m10:52:04.851088 [debug] [MainThread]: Command `dbt ls` succeeded at 10:52:04.850851 after 1.34 seconds
[0m10:52:04.853470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070f950a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070c444e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76070c25f790>]}
[0m10:52:04.855064 [debug] [MainThread]: Flushing usage events
[0m10:52:22.806400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9f33c72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9f183d930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9f183d8d0>]}


============================== 10:52:22.813103 | f5d11a91-85fb-4690-b140-f45b56bfd169 ==============================
[0m10:52:22.813103 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:52:22.815430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s tag:staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:52:23.017465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d11a91-85fb-4690-b140-f45b56bfd169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9f1883580>]}
[0m10:52:23.103302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d11a91-85fb-4690-b140-f45b56bfd169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9f1c58ac0>]}
[0m10:52:23.105840 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:52:23.122655 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:52:23.728377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:52:23.730492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:52:23.732789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:52:23.740560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5d11a91-85fb-4690-b140-f45b56bfd169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9efc1fe20>]}
[0m10:52:23.787585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5d11a91-85fb-4690-b140-f45b56bfd169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9efbe73d0>]}
[0m10:52:23.789885 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:52:23.792183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d11a91-85fb-4690-b140-f45b56bfd169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9efbe7550>]}
[0m10:52:23.794569 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any nodes
[0m10:52:23.797222 [info ] [MainThread]: 
[0m10:52:23.799027 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:52:23.801605 [debug] [MainThread]: Command end result
[0m10:52:23.830035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0821936, "process_user_time": 2.019053, "process_kernel_time": 0.307165, "process_mem_max_rss": "97604", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m10:52:23.832636 [debug] [MainThread]: Command `dbt run` succeeded at 10:52:23.832418 after 1.08 seconds
[0m10:52:23.834160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9f33c72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9f1c58ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d9efbe66b0>]}
[0m10:52:23.835422 [debug] [MainThread]: Flushing usage events
[0m10:54:37.699685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211f31b4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211f162d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211f162d630>]}


============================== 10:54:37.713243 | 6c8e25ce-4a06-4a31-9d1e-519728d5eaef ==============================
[0m10:54:37.713243 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:54:37.716453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --no-partial-parse -s tag:staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:38.028462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c8e25ce-4a06-4a31-9d1e-519728d5eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211f1673460>]}
[0m10:54:38.133447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c8e25ce-4a06-4a31-9d1e-519728d5eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211f1a14610>]}
[0m10:54:38.136007 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:54:38.155841 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:54:38.164520 [debug] [MainThread]: Partial parsing not enabled
[0m10:54:40.029807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:54:40.037406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c8e25ce-4a06-4a31-9d1e-519728d5eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211ed7dc3a0>]}
[0m10:54:40.081282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c8e25ce-4a06-4a31-9d1e-519728d5eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211ed981de0>]}
[0m10:54:40.083341 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:54:40.085656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c8e25ce-4a06-4a31-9d1e-519728d5eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211efb06050>]}
[0m10:54:40.087972 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any nodes
[0m10:54:40.090890 [info ] [MainThread]: 
[0m10:54:40.092872 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:54:40.095039 [debug] [MainThread]: Command end result
[0m10:54:40.126795 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5671902, "process_user_time": 3.508487, "process_kernel_time": 0.569559, "process_mem_max_rss": "101972", "process_in_blocks": "78760", "process_out_blocks": "608"}
[0m10:54:40.128619 [debug] [MainThread]: Command `dbt run` succeeded at 10:54:40.128418 after 2.57 seconds
[0m10:54:40.130061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211f31b4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211efd1c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7211f1673460>]}
[0m10:54:40.131659 [debug] [MainThread]: Flushing usage events
[0m10:56:48.607593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd98c6c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd97095690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd97095630>]}


============================== 10:56:48.615371 | 988ec0c6-6fdb-44f5-ab01-6042820d5a0e ==============================
[0m10:56:48.615371 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:56:48.617360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s models/staging/hubspot/stg_hubspot_contacts.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:56:48.907454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '988ec0c6-6fdb-44f5-ab01-6042820d5a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd970db460>]}
[0m10:56:49.021443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '988ec0c6-6fdb-44f5-ab01-6042820d5a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd97678610>]}
[0m10:56:49.023906 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:56:49.042148 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:56:50.125439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:50.127190 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:50.129778 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:56:50.137506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '988ec0c6-6fdb-44f5-ab01-6042820d5a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd954705b0>]}
[0m10:56:50.189783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '988ec0c6-6fdb-44f5-ab01-6042820d5a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd955472b0>]}
[0m10:56:50.191914 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:56:50.194814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '988ec0c6-6fdb-44f5-ab01-6042820d5a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd95547400>]}
[0m10:56:50.206096 [warn ] [MainThread]: The selection criterion 'models/staging/hubspot/stg_hubspot_contacts.sql' does not match any nodes
[0m10:56:50.209429 [info ] [MainThread]: 
[0m10:56:50.211442 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:56:50.213556 [debug] [MainThread]: Command end result
[0m10:56:50.242627 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6986982, "process_user_time": 2.72648, "process_kernel_time": 0.515718, "process_mem_max_rss": "97124", "process_in_blocks": "78656", "process_out_blocks": "608"}
[0m10:56:50.244788 [debug] [MainThread]: Command `dbt run` succeeded at 10:56:50.244591 after 1.70 seconds
[0m10:56:50.246865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd98c6c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd95784730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77fd95546140>]}
[0m10:56:50.248348 [debug] [MainThread]: Flushing usage events
[0m10:59:08.809898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd7608370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd5a85690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd5a85630>]}


============================== 10:59:08.816914 | b6d7eef2-b5e3-4080-a0c0-7b2bd1178951 ==============================
[0m10:59:08.816914 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:59:08.818923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s path:models/staging/hubspot/stg_hubspot_contacts.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:09.022773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6d7eef2-b5e3-4080-a0c0-7b2bd1178951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd5ac7460>]}
[0m10:59:09.126600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6d7eef2-b5e3-4080-a0c0-7b2bd1178951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd5e6c610>]}
[0m10:59:09.129397 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:59:09.147614 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:59:09.853220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:09.855703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:09.858682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:59:09.866263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6d7eef2-b5e3-4080-a0c0-7b2bd1178951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd3e5c5b0>]}
[0m10:59:09.910315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6d7eef2-b5e3-4080-a0c0-7b2bd1178951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd3f332b0>]}
[0m10:59:09.912082 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:59:09.914051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6d7eef2-b5e3-4080-a0c0-7b2bd1178951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd3f33400>]}
[0m10:59:09.926126 [warn ] [MainThread]: The selection criterion 'path:models/staging/hubspot/stg_hubspot_contacts.sql' does not match any nodes
[0m10:59:09.928874 [info ] [MainThread]: 
[0m10:59:09.931518 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:59:09.933669 [debug] [MainThread]: Command end result
[0m10:59:09.961440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2070024, "process_user_time": 2.591597, "process_kernel_time": 0.314587, "process_mem_max_rss": "97432", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m10:59:09.963249 [debug] [MainThread]: Command `dbt run` succeeded at 10:59:09.963109 after 1.21 seconds
[0m10:59:09.964861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd7608370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd4170730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd3f32140>]}
[0m10:59:09.967002 [debug] [MainThread]: Flushing usage events
[0m11:00:28.624225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce5df0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce4269720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce42696c0>]}


============================== 11:00:28.631713 | b98eb6c5-ef22-42be-a347-8e0cfff60d72 ==============================
[0m11:00:28.631713 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:00:28.633810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s path:C:\\Users\\eyaja\\Desktop\\projet_pfe\\dbt\\models\\staging\\hubspot\\stg_hubspot_contacts.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:28.857042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b98eb6c5-ef22-42be-a347-8e0cfff60d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce42af4c0>]}
[0m11:00:28.955929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b98eb6c5-ef22-42be-a347-8e0cfff60d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce647ead0>]}
[0m11:00:28.958512 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:00:28.976048 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:00:29.808052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:00:29.810280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:00:29.813321 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:00:29.821439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b98eb6c5-ef22-42be-a347-8e0cfff60d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce2644610>]}
[0m11:00:29.862588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b98eb6c5-ef22-42be-a347-8e0cfff60d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce271b310>]}
[0m11:00:29.864685 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:00:29.866676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b98eb6c5-ef22-42be-a347-8e0cfff60d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce271b460>]}
[0m11:00:29.884943 [warn ] [MainThread]: The selection criterion 'path:C:\Users\eyaja\Desktop\projet_pfe\dbt\models\staging\hubspot\stg_hubspot_contacts.sql' does not match any nodes
[0m11:00:29.887962 [info ] [MainThread]: 
[0m11:00:29.889950 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:00:29.892124 [debug] [MainThread]: Command end result
[0m11:00:29.920862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3588313, "process_user_time": 2.374243, "process_kernel_time": 0.40766, "process_mem_max_rss": "97908", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:00:29.922933 [debug] [MainThread]: Command `dbt run` succeeded at 11:00:29.922736 after 1.36 seconds
[0m11:00:29.925001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce5df0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce2923a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782ce271a2c0>]}
[0m11:00:29.926993 [debug] [MainThread]: Flushing usage events
[0m11:01:45.859747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b8ba172b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b8a17f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b8a17c940>]}


============================== 11:01:45.867224 | 91d738a6-be5b-4f96-899e-7c2b7e1feca9 ==============================
[0m11:01:45.867224 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:01:45.869565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls -s stg_hubspot_contacts', 'send_anonymous_usage_stats': 'True'}
[0m11:01:46.083005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91d738a6-be5b-4f96-899e-7c2b7e1feca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b8a17fb20>]}
[0m11:01:46.174214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91d738a6-be5b-4f96-899e-7c2b7e1feca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b8a2702b0>]}
[0m11:01:46.179592 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:01:46.234255 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:01:47.158296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:01:47.160303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:01:47.162875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:01:47.170594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91d738a6-be5b-4f96-899e-7c2b7e1feca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b88267fd0>]}
[0m11:01:47.216607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91d738a6-be5b-4f96-899e-7c2b7e1feca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b88324160>]}
[0m11:01:47.218685 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:01:47.220949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91d738a6-be5b-4f96-899e-7c2b7e1feca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b88327700>]}
[0m11:01:47.223888 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.4232433, "process_user_time": 2.128216, "process_kernel_time": 0.379361, "process_mem_max_rss": "97484", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:01:47.226088 [debug] [MainThread]: Command `dbt ls` succeeded at 11:01:47.225884 after 1.43 seconds
[0m11:01:47.227796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b8ba172b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b8a2702b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6b883276d0>]}
[0m11:01:47.229529 [debug] [MainThread]: Flushing usage events
[0m11:04:01.291169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7593718089a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75936fc71900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75936fc718a0>]}


============================== 11:04:01.300140 | 7a8a1a03-f1e3-412a-aabf-3da2afb64200 ==============================
[0m11:04:01.300140 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:04:01.302439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s hubspot_dbt.staging.hubspot.stg_hubspot_contacts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:04:01.538326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a8a1a03-f1e3-412a-aabf-3da2afb64200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75936fcb7550>]}
[0m11:04:01.637615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a8a1a03-f1e3-412a-aabf-3da2afb64200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759371e84340>]}
[0m11:04:01.639780 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:04:01.658161 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:04:02.356441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:02.358395 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:02.360813 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:04:02.368582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a8a1a03-f1e3-412a-aabf-3da2afb64200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75936e057d90>]}
[0m11:04:02.412081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a8a1a03-f1e3-412a-aabf-3da2afb64200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75936e1273a0>]}
[0m11:04:02.414010 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:04:02.416686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a8a1a03-f1e3-412a-aabf-3da2afb64200', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75936e1274f0>]}
[0m11:04:02.418965 [warn ] [MainThread]: The selection criterion 'hubspot_dbt.staging.hubspot.stg_hubspot_contacts' does not match any nodes
[0m11:04:02.421749 [info ] [MainThread]: 
[0m11:04:02.423721 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:04:02.425947 [debug] [MainThread]: Command end result
[0m11:04:02.454401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2330202, "process_user_time": 2.301828, "process_kernel_time": 0.360847, "process_mem_max_rss": "97496", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:04:02.456364 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:02.456173 after 1.24 seconds
[0m11:04:02.457755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7593718089a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75936e360520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75936e1263e0>]}
[0m11:04:02.459419 [debug] [MainThread]: Flushing usage events
[0m11:04:31.967297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd416bd8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd415055690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd415055630>]}


============================== 11:04:31.974572 | 3e8ddf81-632f-43a3-812e-41bd09304209 ==============================
[0m11:04:31.974572 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:04:31.976817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_hubspot_contacts', 'send_anonymous_usage_stats': 'True'}
[0m11:04:32.186837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e8ddf81-632f-43a3-812e-41bd09304209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd415097460>]}
[0m11:04:32.275284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e8ddf81-632f-43a3-812e-41bd09304209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd41543c610>]}
[0m11:04:32.277975 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:04:32.296256 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:04:32.973873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:32.975884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:32.978770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:04:32.987218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e8ddf81-632f-43a3-812e-41bd09304209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd41342c5b0>]}
[0m11:04:33.031080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e8ddf81-632f-43a3-812e-41bd09304209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd4135032b0>]}
[0m11:04:33.033320 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:04:33.035263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e8ddf81-632f-43a3-812e-41bd09304209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd413503400>]}
[0m11:04:33.037306 [warn ] [MainThread]: The selection criterion 'stg_hubspot_contacts' does not match any nodes
[0m11:04:33.039780 [info ] [MainThread]: 
[0m11:04:33.041640 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:04:33.043930 [debug] [MainThread]: Command end result
[0m11:04:33.072560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1667976, "process_user_time": 2.05382, "process_kernel_time": 0.402563, "process_mem_max_rss": "97688", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:04:33.074567 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:33.074386 after 1.17 seconds
[0m11:04:33.075888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd416bd8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd413740730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd4135022f0>]}
[0m11:04:33.077480 [debug] [MainThread]: Flushing usage events
[0m11:06:29.600110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86d0490880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86ce8f9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86ce8f9720>]}


============================== 11:06:29.607324 | 5a29fee1-42c5-42c0-abea-05fffbf83e00 ==============================
[0m11:06:29.607324 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:06:29.609510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_hubspot_contacts.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:06:29.832300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a29fee1-42c5-42c0-abea-05fffbf83e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86ce93f4f0>]}
[0m11:06:29.917564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a29fee1-42c5-42c0-abea-05fffbf83e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86d0b0c2e0>]}
[0m11:06:29.920074 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:06:29.937661 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:06:30.676954 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:30.679159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:30.681892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:06:30.689421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a29fee1-42c5-42c0-abea-05fffbf83e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86cccd8640>]}
[0m11:06:30.734523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a29fee1-42c5-42c0-abea-05fffbf83e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86ccdaf2e0>]}
[0m11:06:30.736490 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:06:30.738888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a29fee1-42c5-42c0-abea-05fffbf83e00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86ccdaf430>]}
[0m11:06:30.741430 [warn ] [MainThread]: The selection criterion 'stg_hubspot_contacts.sql' does not match any nodes
[0m11:06:30.744432 [info ] [MainThread]: 
[0m11:06:30.746713 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:06:30.748884 [debug] [MainThread]: Command end result
[0m11:06:30.781057 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2506112, "process_user_time": 2.161474, "process_kernel_time": 0.339498, "process_mem_max_rss": "97776", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:06:30.783749 [debug] [MainThread]: Command `dbt run` succeeded at 11:06:30.783483 after 1.25 seconds
[0m11:06:30.785797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86d0490880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86d0b0c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b86ccfb5660>]}
[0m11:06:30.787354 [debug] [MainThread]: Flushing usage events
[0m11:07:45.464379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00dddc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00c5456f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00c5448b0>]}


============================== 11:07:45.471611 | 468bcdbc-066f-442c-9e8b-439fd7909fb5 ==============================
[0m11:07:45.471611 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:07:45.473819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls -s stg_hubspot_contacts --output json', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:07:45.687219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '468bcdbc-066f-442c-9e8b-439fd7909fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00c547a90>]}
[0m11:07:45.774294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '468bcdbc-066f-442c-9e8b-439fd7909fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00e459030>]}
[0m11:07:45.776593 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:07:45.793604 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:07:46.455969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:46.457703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:46.460282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:07:46.468145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '468bcdbc-066f-442c-9e8b-439fd7909fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00a62ff70>]}
[0m11:07:46.509130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '468bcdbc-066f-442c-9e8b-439fd7909fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00a6ef5e0>]}
[0m11:07:46.510798 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:07:46.512645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '468bcdbc-066f-442c-9e8b-439fd7909fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00a6ef760>]}
[0m11:07:46.515912 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.1109344, "process_user_time": 2.067256, "process_kernel_time": 0.325817, "process_mem_max_rss": "97668", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:07:46.517815 [debug] [MainThread]: Command `dbt ls` succeeded at 11:07:46.517625 after 1.11 seconds
[0m11:07:46.519188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00dddc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00aac0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ec00a6eece0>]}
[0m11:07:46.520668 [debug] [MainThread]: Flushing usage events
[0m11:08:13.741081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2716c8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a26fb35a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a26fb359c0>]}


============================== 11:08:13.748667 | 46f782b0-c1f7-45f1-97b9-e95bc4596461 ==============================
[0m11:08:13.748667 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:08:13.751015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls -s hubspot_dbt.staging.hubspot.* --output json', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:08:13.964237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46f782b0-c1f7-45f1-97b9-e95bc4596461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a26fb77670>]}
[0m11:08:14.053505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46f782b0-c1f7-45f1-97b9-e95bc4596461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a271d45270>]}
[0m11:08:14.056819 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:08:14.075997 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:08:14.748549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:08:14.750844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:08:14.753651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:08:14.761298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46f782b0-c1f7-45f1-97b9-e95bc4596461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a26df1beb0>]}
[0m11:08:14.802386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46f782b0-c1f7-45f1-97b9-e95bc4596461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a26dfd8040>]}
[0m11:08:14.804403 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:08:14.806646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46f782b0-c1f7-45f1-97b9-e95bc4596461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a26dfdb5e0>]}
[0m11:08:14.810914 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.1299049, "process_user_time": 2.101442, "process_kernel_time": 0.273937, "process_mem_max_rss": "97692", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:08:14.813334 [debug] [MainThread]: Command `dbt ls` succeeded at 11:08:14.813013 after 1.13 seconds
[0m11:08:14.815532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a2716c8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a271d45270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a26dfdb5b0>]}
[0m11:08:14.817760 [debug] [MainThread]: Flushing usage events
[0m11:11:08.585434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a005a818c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0058f8ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0058f8e0b0>]}


============================== 11:11:08.592511 | f178a299-3401-4744-b65e-d935b17f04dd ==============================
[0m11:11:08.592511 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:11:08.594218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:11:08.683150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f178a299-3401-4744-b65e-d935b17f04dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a00595c6a70>]}
[0m11:11:08.716323 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.18647078, "process_user_time": 2.226233, "process_kernel_time": 0.369781, "process_mem_max_rss": "86908", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:11:08.718890 [debug] [MainThread]: Command `dbt clean` succeeded at 11:11:08.718645 after 0.19 seconds
[0m11:11:08.720893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a005a818c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a005aea5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a005aea4a60>]}
[0m11:11:08.722390 [debug] [MainThread]: Flushing usage events
[0m11:11:23.009844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8d5f0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8ba716f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8ba71690>]}


============================== 11:11:23.017302 | 98062ba9-71eb-451d-b845-fe657cdc87d8 ==============================
[0m11:11:23.017302 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:11:23.019375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:11:23.228491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98062ba9-71eb-451d-b845-fe657cdc87d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8baa7490>]}
[0m11:11:23.323351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98062ba9-71eb-451d-b845-fe657cdc87d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8dc7b160>]}
[0m11:11:23.325811 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:11:23.336709 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:11:23.345123 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:11:23.347215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98062ba9-71eb-451d-b845-fe657cdc87d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8ba722f0>]}
[0m11:11:24.996984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:11:25.004181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98062ba9-71eb-451d-b845-fe657cdc87d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e53b683d0>]}
[0m11:11:25.054011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98062ba9-71eb-451d-b845-fe657cdc87d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e881b92a0>]}
[0m11:11:25.055874 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:11:25.057809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98062ba9-71eb-451d-b845-fe657cdc87d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e880d53c0>]}
[0m11:11:25.060743 [info ] [MainThread]: 
[0m11:11:25.062707 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:11:25.065476 [debug] [MainThread]: Command end result
[0m11:11:25.093901 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.1425037, "process_user_time": 2.890086, "process_kernel_time": 0.406418, "process_mem_max_rss": "102200", "process_in_blocks": "480", "process_out_blocks": "608"}
[0m11:11:25.095584 [debug] [MainThread]: Command `dbt compile` succeeded at 11:11:25.095389 after 2.14 seconds
[0m11:11:25.097264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8d5f0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8a0e6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739e8baa7490>]}
[0m11:11:25.099107 [debug] [MainThread]: Flushing usage events
[0m11:11:55.098215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f642828610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f640c51720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f640c516c0>]}


============================== 11:11:55.105261 | 7c0a379c-896a-4b09-9ada-08283b13c4fc ==============================
[0m11:11:55.105261 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:11:55.107275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s model.hubspot_dbt.stg_hubspot_contacts', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:11:55.307751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c0a379c-896a-4b09-9ada-08283b13c4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f640c974c0>]}
[0m11:11:55.393674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c0a379c-896a-4b09-9ada-08283b13c4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f642d62ad0>]}
[0m11:11:55.396263 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:11:55.412610 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:11:56.025092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:56.027310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:56.029648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:11:56.036914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c0a379c-896a-4b09-9ada-08283b13c4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f63f02c610>]}
[0m11:11:56.077883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c0a379c-896a-4b09-9ada-08283b13c4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f63f103310>]}
[0m11:11:56.079673 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:11:56.081656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c0a379c-896a-4b09-9ada-08283b13c4fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f63f103460>]}
[0m11:11:56.083524 [warn ] [MainThread]: The selection criterion 'model.hubspot_dbt.stg_hubspot_contacts' does not match any nodes
[0m11:11:56.085923 [info ] [MainThread]: 
[0m11:11:56.087690 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:11:56.090199 [debug] [MainThread]: Command end result
[0m11:11:56.116721 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.075203, "process_user_time": 2.014627, "process_kernel_time": 0.332656, "process_mem_max_rss": "98204", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:11:56.119143 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:56.118943 after 1.08 seconds
[0m11:11:56.120794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f642828610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f63f30fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70f63f102350>]}
[0m11:11:56.122538 [debug] [MainThread]: Flushing usage events
[0m11:12:28.366771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be18f30580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be17399690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be17399630>]}


============================== 11:12:28.373623 | 34129fe8-f0b6-48b4-96d7-1e140227753a ==============================
[0m11:12:28.373623 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:12:28.375721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s fqn:staging.hubspot.stg_hubspot_contacts', 'send_anonymous_usage_stats': 'True'}
[0m11:12:28.586956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34129fe8-f0b6-48b4-96d7-1e140227753a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be173df460>]}
[0m11:12:28.680153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34129fe8-f0b6-48b4-96d7-1e140227753a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be1778c610>]}
[0m11:12:28.682973 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:12:28.702741 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:12:29.451883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:12:29.454235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:12:29.457252 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:12:29.465288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34129fe8-f0b6-48b4-96d7-1e140227753a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be157785b0>]}
[0m11:12:29.510147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34129fe8-f0b6-48b4-96d7-1e140227753a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be158532b0>]}
[0m11:12:29.512149 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:12:29.514580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34129fe8-f0b6-48b4-96d7-1e140227753a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be15853400>]}
[0m11:12:29.517215 [warn ] [MainThread]: The selection criterion 'fqn:staging.hubspot.stg_hubspot_contacts' does not match any nodes
[0m11:12:29.522608 [info ] [MainThread]: 
[0m11:12:29.524945 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:12:29.526944 [debug] [MainThread]: Command end result
[0m11:12:29.554962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2480453, "process_user_time": 2.436079, "process_kernel_time": 0.365983, "process_mem_max_rss": "97724", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:12:29.557365 [debug] [MainThread]: Command `dbt run` succeeded at 11:12:29.557139 after 1.25 seconds
[0m11:12:29.559077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be18f30580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be15a8c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77be15852260>]}
[0m11:12:29.561482 [debug] [MainThread]: Flushing usage events
[0m11:13:01.777766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d51dc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d3605690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d3605630>]}


============================== 11:13:01.784852 | 1f80658f-538f-4942-a930-e7ffbefd56ba ==============================
[0m11:13:01.784852 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:13:01.786886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s resource_type:model name:stg_hubspot_contacts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:13:01.988936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f80658f-538f-4942-a930-e7ffbefd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d364b460>]}
[0m11:13:02.073058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f80658f-538f-4942-a930-e7ffbefd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d3be89a0>]}
[0m11:13:02.075800 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:13:02.092810 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:13:02.705862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:02.707989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:02.710388 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:13:02.717755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f80658f-538f-4942-a930-e7ffbefd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d19e05b0>]}
[0m11:13:02.762288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f80658f-538f-4942-a930-e7ffbefd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d1ab72b0>]}
[0m11:13:02.763887 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:13:02.766189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f80658f-538f-4942-a930-e7ffbefd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d1ab7400>]}
[0m11:13:02.768246 [error] [MainThread]: Encountered an error:
Runtime Error
  'name' is not a valid method name
[0m11:13:02.770596 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0488628, "process_user_time": 1.983202, "process_kernel_time": 0.296729, "process_mem_max_rss": "97396", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m11:13:02.772177 [debug] [MainThread]: Command `dbt run` failed at 11:13:02.772027 after 1.05 seconds
[0m11:13:02.773479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d51dc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d1ab7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76d4d1ab66b0>]}
[0m11:13:02.774840 [debug] [MainThread]: Flushing usage events
[0m11:17:37.384893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4425ffc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4424767220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4424765150>]}


============================== 11:17:37.392471 | c247648b-480f-435f-bb04-eeb9074e6ec8 ==============================
[0m11:17:37.392471 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:17:37.394847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:17:37.485381 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not parse selector file data: 
  description: Tous
  name: staging_all
  
  Valid root-level selector definitions: union, intersection, string, dictionary. No lists. 
  https://docs.getdbt.com/reference/node-selection/yaml-selectors
[0m11:17:37.488447 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_wall_clock_time": 0.17039588, "process_user_time": 1.82431, "process_kernel_time": 0.285871, "process_mem_max_rss": "86944", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m11:17:37.490480 [debug] [MainThread]: Command `dbt clean` failed at 11:17:37.490288 after 0.17 seconds
[0m11:17:37.492057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d4425ffc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d442667ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d442449ca60>]}
[0m11:17:37.494042 [debug] [MainThread]: Flushing usage events
[0m11:17:55.422939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77093b914610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770939d91720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x770939d916c0>]}


============================== 11:17:55.429763 | 8a63e696-0dae-432b-b065-5685f8ace5dd ==============================
[0m11:17:55.429763 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:17:55.431552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:17:55.628757 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not parse selector file data: 
  description: Tous
  name: staging_all
  
  Valid root-level selector definitions: union, intersection, string, dictionary. No lists. 
  https://docs.getdbt.com/reference/node-selection/yaml-selectors
[0m11:17:55.631770 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.26576027, "process_user_time": 1.873189, "process_kernel_time": 0.215994, "process_mem_max_rss": "90664", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m11:17:55.633690 [debug] [MainThread]: Command `dbt compile` failed at 11:17:55.633492 after 0.27 seconds
[0m11:17:55.635296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77093b914610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77093a08b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77093840e4d0>]}
[0m11:17:55.636530 [debug] [MainThread]: Flushing usage events
[0m11:18:08.493655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023dc978610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023dade1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023dade16c0>]}


============================== 11:18:08.501166 | d5ad2723-0bed-4f70-8d61-e7277136d9d1 ==============================
[0m11:18:08.501166 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:18:08.503528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --selector staging_all', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:18:08.697223 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not parse selector file data: 
  description: Tous
  name: staging_all
  
  Valid root-level selector definitions: union, intersection, string, dictionary. No lists. 
  https://docs.getdbt.com/reference/node-selection/yaml-selectors
[0m11:18:08.700214 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.26675248, "process_user_time": 2.297019, "process_kernel_time": 0.283349, "process_mem_max_rss": "90980", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m11:18:08.702000 [debug] [MainThread]: Command `dbt run` failed at 11:18:08.701845 after 0.27 seconds
[0m11:18:08.703257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023dc978610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023db0e3220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7023d94664d0>]}
[0m11:18:08.704480 [debug] [MainThread]: Flushing usage events
[0m11:20:51.738711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8181bc4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d81804e27d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d81804e0bb0>]}


============================== 11:20:51.746529 | d335861c-2a3d-4500-9a26-05feba8c5886 ==============================
[0m11:20:51.746529 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:20:51.748457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:51.847699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd335861c-2a3d-4500-9a26-05feba8c5886', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d818097e8f0>]}
[0m11:20:51.883105 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.20786697, "process_user_time": 1.926407, "process_kernel_time": 0.251597, "process_mem_max_rss": "86892", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:20:51.885358 [debug] [MainThread]: Command `dbt clean` succeeded at 11:20:51.885114 after 0.21 seconds
[0m11:20:51.887136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8181bc4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d81820fe500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d81805d2dd0>]}
[0m11:20:51.888802 [debug] [MainThread]: Flushing usage events
[0m11:21:07.767183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759648d14c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759647633e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759647630a90>]}


============================== 11:21:07.786984 | 515ddc13-021b-4da9-928c-749384625c26 ==============================
[0m11:21:07.786984 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:21:07.797857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:21:08.156949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '515ddc13-021b-4da9-928c-749384625c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759647177400>]}
[0m11:21:08.256597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '515ddc13-021b-4da9-928c-749384625c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75964924c400>]}
[0m11:21:08.258974 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:21:08.269303 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:21:08.278705 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:21:08.280650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '515ddc13-021b-4da9-928c-749384625c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596458b2440>]}
[0m11:21:10.057870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:21:10.064821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '515ddc13-021b-4da9-928c-749384625c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75963f438400>]}
[0m11:21:10.123893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '515ddc13-021b-4da9-928c-749384625c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75963f5cd480>]}
[0m11:21:10.126377 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:21:10.128290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '515ddc13-021b-4da9-928c-749384625c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759645626080>]}
[0m11:21:10.131329 [info ] [MainThread]: 
[0m11:21:10.133164 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:21:10.135636 [debug] [MainThread]: Command end result
[0m11:21:10.161142 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.5467207, "process_user_time": 3.090299, "process_kernel_time": 0.425858, "process_mem_max_rss": "102084", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:21:10.163389 [debug] [MainThread]: Command `dbt compile` succeeded at 11:21:10.163183 after 2.55 seconds
[0m11:21:10.165305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759648d14c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7596455b3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759647177400>]}
[0m11:21:10.167505 [debug] [MainThread]: Flushing usage events
[0m11:22:40.519570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e6948370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e50bd870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e50bca90>]}


============================== 11:22:40.526738 | 41346eda-7497-4913-83f5-f3ad9e3f5384 ==============================
[0m11:22:40.526738 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:22:40.528683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --selector staging_all', 'send_anonymous_usage_stats': 'True'}
[0m11:22:40.743687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41346eda-7497-4913-83f5-f3ad9e3f5384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e4e03430>]}
[0m11:22:40.834095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41346eda-7497-4913-83f5-f3ad9e3f5384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e50be2f0>]}
[0m11:22:40.836676 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:22:40.855010 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:22:41.638282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:41.640133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:41.642549 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:22:41.650443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41346eda-7497-4913-83f5-f3ad9e3f5384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e31a0640>]}
[0m11:22:41.694908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41346eda-7497-4913-83f5-f3ad9e3f5384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e3167370>]}
[0m11:22:41.696871 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:22:41.698897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41346eda-7497-4913-83f5-f3ad9e3f5384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e31674c0>]}
[0m11:22:41.701781 [info ] [MainThread]: 
[0m11:22:41.704087 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:22:41.706627 [debug] [MainThread]: Command end result
[0m11:22:41.736606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2811714, "process_user_time": 2.358094, "process_kernel_time": 0.411251, "process_mem_max_rss": "97472", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:22:41.738505 [debug] [MainThread]: Command `dbt run` succeeded at 11:22:41.738311 after 1.28 seconds
[0m11:22:41.739917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e6948370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e34afb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7263e3166470>]}
[0m11:22:41.741777 [debug] [MainThread]: Flushing usage events
[0m11:25:15.443138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd4904a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd2d6d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd2d6d750>]}


============================== 11:25:15.450388 | 91172c50-a659-459e-a778-09fef1cb7c4f ==============================
[0m11:25:15.450388 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:25:15.452458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s unique_id:model.hubspot_dbt.stg_hubspot_contacts', 'send_anonymous_usage_stats': 'True'}
[0m11:25:15.660847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91172c50-a659-459e-a778-09fef1cb7c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd2db34f0>]}
[0m11:25:15.750384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91172c50-a659-459e-a778-09fef1cb7c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd4f802e0>]}
[0m11:25:15.752630 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:25:15.769143 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:25:16.455146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:25:16.457110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:25:16.459798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:25:16.467914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91172c50-a659-459e-a778-09fef1cb7c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd115bdf0>]}
[0m11:25:16.515959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91172c50-a659-459e-a778-09fef1cb7c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd111c040>]}
[0m11:25:16.518030 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:25:16.520252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91172c50-a659-459e-a778-09fef1cb7c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd111f610>]}
[0m11:25:16.522728 [error] [MainThread]: Encountered an error:
Runtime Error
  'unique_id' is not a valid method name
[0m11:25:16.525256 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1412977, "process_user_time": 2.131924, "process_kernel_time": 0.378, "process_mem_max_rss": "97576", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m11:25:16.527196 [debug] [MainThread]: Command `dbt run` failed at 11:25:16.526992 after 1.14 seconds
[0m11:25:16.529025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd4904a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd111ea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dacd111e890>]}
[0m11:25:16.530857 [debug] [MainThread]: Flushing usage events
[0m11:34:12.617721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a46088880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a447fd6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a447fc8b0>]}


============================== 11:34:12.627412 | 5d34ab93-807f-4a34-84dd-d241424e7989 ==============================
[0m11:34:12.627412 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:34:12.630241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls -s tag:staging --output name', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:12.985728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d34ab93-807f-4a34-84dd-d241424e7989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a44547730>]}
[0m11:34:13.110064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d34ab93-807f-4a34-84dd-d241424e7989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a46715030>]}
[0m11:34:13.112982 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:34:13.133830 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:34:14.039919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:34:14.041669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:34:14.044619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:34:14.053257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d34ab93-807f-4a34-84dd-d241424e7989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a428efeb0>]}
[0m11:34:14.100329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d34ab93-807f-4a34-84dd-d241424e7989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a428ac1f0>]}
[0m11:34:14.102026 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:34:14.104102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d34ab93-807f-4a34-84dd-d241424e7989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a428af790>]}
[0m11:34:14.108569 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.5780953, "process_user_time": 2.462964, "process_kernel_time": 0.487222, "process_mem_max_rss": "96948", "process_in_blocks": "78280", "process_out_blocks": "608"}
[0m11:34:14.110393 [debug] [MainThread]: Command `dbt ls` succeeded at 11:34:14.110190 after 1.58 seconds
[0m11:34:14.112130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a46088880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a46715030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a428af760>]}
[0m11:34:14.113967 [debug] [MainThread]: Flushing usage events
[0m11:34:39.256945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f5ca0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f410d7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f410d780>]}


============================== 11:34:39.263881 | 93b8971b-34a2-47d7-a2f9-53c77c543e8f ==============================
[0m11:34:39.263881 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:34:39.265835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_hubspot_contacts', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:34:39.467374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b8971b-34a2-47d7-a2f9-53c77c543e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f414f520>]}
[0m11:34:39.551698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b8971b-34a2-47d7-a2f9-53c77c543e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f631c310>]}
[0m11:34:39.554095 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:34:39.570923 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:34:40.185338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:34:40.187513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:34:40.190144 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:34:40.197466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b8971b-34a2-47d7-a2f9-53c77c543e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f24f7e20>]}
[0m11:34:40.241388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b8971b-34a2-47d7-a2f9-53c77c543e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f24bb4c0>]}
[0m11:34:40.243063 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:34:40.244815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b8971b-34a2-47d7-a2f9-53c77c543e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f24bb640>]}
[0m11:34:40.246885 [warn ] [MainThread]: The selection criterion 'stg_hubspot_contacts' does not match any nodes
[0m11:34:40.249487 [info ] [MainThread]: 
[0m11:34:40.251273 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:34:40.253533 [debug] [MainThread]: Command end result
[0m11:34:40.281498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0835365, "process_user_time": 2.27976, "process_kernel_time": 0.31276, "process_mem_max_rss": "97736", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:34:40.284315 [debug] [MainThread]: Command `dbt run` succeeded at 11:34:40.283796 after 1.09 seconds
[0m11:34:40.286070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f5ca0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f28fa440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7505f24ba530>]}
[0m11:34:40.287478 [debug] [MainThread]: Flushing usage events
[0m11:35:25.822288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbf780a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbdbf97b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbdbf9750>]}


============================== 11:35:25.828923 | 864b2a53-6c95-4445-b91f-fb6d0386f44a ==============================
[0m11:35:25.828923 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:35:25.830938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s staging/ stg_hubspot_contacts', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:35:26.031490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '864b2a53-6c95-4445-b91f-fb6d0386f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbdc3f4f0>]}
[0m11:35:26.118829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '864b2a53-6c95-4445-b91f-fb6d0386f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbfe082e0>]}
[0m11:35:26.121517 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:35:26.138985 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:35:24.924006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:24.925599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:24.927898 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m11:35:24.935924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '864b2a53-6c95-4445-b91f-fb6d0386f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbbfd7df0>]}
[0m11:35:24.983371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '864b2a53-6c95-4445-b91f-fb6d0386f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbbf98040>]}
[0m11:35:24.985066 [info ] [MainThread]: Found 33 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:35:24.987105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '864b2a53-6c95-4445-b91f-fb6d0386f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbbf9b610>]}
[0m11:35:24.990733 [warn ] [MainThread]: The selection criterion 'staging/' does not match any nodes
[0m11:35:24.992738 [warn ] [MainThread]: The selection criterion 'stg_hubspot_contacts' does not match any nodes
[0m11:35:24.995724 [info ] [MainThread]: 
[0m11:35:24.998008 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:35:25.000125 [debug] [MainThread]: Command end result
[0m11:35:25.026821 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1600019, "process_user_time": 2.095336, "process_kernel_time": 0.28966, "process_mem_max_rss": "97584", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m11:35:25.028974 [debug] [MainThread]: Command `dbt run` succeeded at 11:35:25.028767 after 1.16 seconds
[0m11:35:25.030399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbf780a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbc2e3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752fbbf9a320>]}
[0m11:35:25.031744 [debug] [MainThread]: Flushing usage events
[0m20:21:31.438208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc0f40610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abbf85d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abbf85dd80>]}


============================== 20:21:31.447116 | 63c28961-e5e8-4e7d-926e-473056e81508 ==============================
[0m20:21:31.447116 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:21:31.449119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:21:31.451600 [info ] [MainThread]: dbt version: 1.7.10
[0m20:21:31.453131 [info ] [MainThread]: python version: 3.10.7
[0m20:21:31.455437 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:21:31.457153 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m20:21:31.651361 [info ] [MainThread]: Using profiles dir at /usr/app
[0m20:21:31.653430 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m20:21:31.655256 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m20:21:31.657605 [info ] [MainThread]: adapter type: postgres
[0m20:21:31.659236 [info ] [MainThread]: adapter version: 1.7.10
[0m20:21:31.745815 [info ] [MainThread]: Configuration:
[0m20:21:31.747581 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:21:31.749383 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:21:31.751400 [info ] [MainThread]: Required dependencies:
[0m20:21:31.753234 [debug] [MainThread]: Executing "git --help"
[0m20:21:31.777069 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:21:31.778927 [debug] [MainThread]: STDERR: "b''"
[0m20:21:31.780379 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:21:31.782272 [info ] [MainThread]: Connection:
[0m20:21:31.784179 [info ] [MainThread]:   host: postgres
[0m20:21:31.786253 [info ] [MainThread]:   port: 5432
[0m20:21:31.788149 [info ] [MainThread]:   user: elt
[0m20:21:31.789931 [info ] [MainThread]:   database: warehouse
[0m20:21:31.792210 [info ] [MainThread]:   schema: marts
[0m20:21:31.794066 [info ] [MainThread]:   connect_timeout: 10
[0m20:21:31.796170 [info ] [MainThread]:   role: None
[0m20:21:31.798232 [info ] [MainThread]:   search_path: None
[0m20:21:31.800667 [info ] [MainThread]:   keepalives_idle: 0
[0m20:21:31.802982 [info ] [MainThread]:   sslmode: None
[0m20:21:31.804916 [info ] [MainThread]:   sslcert: None
[0m20:21:31.807059 [info ] [MainThread]:   sslkey: None
[0m20:21:31.809272 [info ] [MainThread]:   sslrootcert: None
[0m20:21:31.811422 [info ] [MainThread]:   application_name: dbt
[0m20:21:31.813897 [info ] [MainThread]:   retries: 1
[0m20:21:31.815738 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m20:21:31.818362 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:21:31.820441 [debug] [MainThread]: Using postgres connection "debug"
[0m20:21:31.822199 [debug] [MainThread]: On debug: select 1 as id
[0m20:21:31.824104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:31.868684 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:21:31.870788 [debug] [MainThread]: On debug: Close
[0m20:21:31.872346 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:21:31.874147 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:21:31.877745 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5571374, "process_user_time": 2.172619, "process_kernel_time": 0.484994, "process_mem_max_rss": "92452", "process_in_blocks": "82968", "process_out_blocks": "608"}
[0m20:21:31.879508 [debug] [MainThread]: Command `dbt debug` succeeded at 20:21:31.879309 after 0.56 seconds
[0m20:21:31.880948 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:21:31.882400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abc0f40610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abbf3b73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75abbf85f3a0>]}
[0m20:21:31.884126 [debug] [MainThread]: Flushing usage events
[0m20:23:58.885454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2fa135c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9f7dd7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9f7dd750>]}


============================== 20:23:58.893601 | 2cc4057f-8847-4f16-a100-e95ab2b1a64c ==============================
[0m20:23:58.893601 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:23:58.895640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:59.191972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cc4057f-8847-4f16-a100-e95ab2b1a64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9f813520>]}
[0m20:23:59.288088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cc4057f-8847-4f16-a100-e95ab2b1a64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9face2c0>]}
[0m20:23:59.290476 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m20:23:59.311695 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:23:59.319534 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:23:59.321305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2cc4057f-8847-4f16-a100-e95ab2b1a64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9dd42710>]}
[0m20:24:01.420113 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m20:24:01.427863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc4057f-8847-4f16-a100-e95ab2b1a64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9db61a50>]}
[0m20:24:01.474176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cc4057f-8847-4f16-a100-e95ab2b1a64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9df12560>]}
[0m20:24:01.476215 [info ] [MainThread]: Found 48 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:24:01.478321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc4057f-8847-4f16-a100-e95ab2b1a64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9dc3b280>]}
[0m20:24:01.481090 [info ] [MainThread]: 
[0m20:24:01.483103 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:24:01.486122 [debug] [MainThread]: Command end result
[0m20:24:01.520246 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7059312, "process_user_time": 3.195116, "process_kernel_time": 0.686275, "process_mem_max_rss": "101940", "process_in_blocks": "82240", "process_out_blocks": "608"}
[0m20:24:01.522382 [debug] [MainThread]: Command `dbt run` succeeded at 20:24:01.522150 after 2.71 seconds
[0m20:24:01.523827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2fa135c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9de8bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2f9de52c20>]}
[0m20:24:01.525280 [debug] [MainThread]: Flushing usage events
[0m20:32:58.120489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719683fac9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7196827156f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719682714910>]}


============================== 20:32:58.128852 | c1ea2fef-7350-47fb-a776-1835eb5b5ded ==============================
[0m20:32:58.128852 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:32:58.130973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --resource-type source', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:58.419860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1ea2fef-7350-47fb-a776-1835eb5b5ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719682717af0>]}
[0m20:32:58.521836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1ea2fef-7350-47fb-a776-1835eb5b5ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719684629030>]}
[0m20:32:58.524282 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m20:32:58.541322 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:32:59.567307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:32:59.569028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:32:59.571771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m20:32:59.579774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1ea2fef-7350-47fb-a776-1835eb5b5ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719680818be0>]}
[0m20:32:59.624749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1ea2fef-7350-47fb-a776-1835eb5b5ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7196808dc460>]}
[0m20:32:59.626485 [info ] [MainThread]: Found 48 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:32:59.628720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1ea2fef-7350-47fb-a776-1835eb5b5ded', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7196808dfac0>]}
[0m20:32:59.633552 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.5825655, "process_user_time": 2.354489, "process_kernel_time": 0.649244, "process_mem_max_rss": "97912", "process_in_blocks": "78640", "process_out_blocks": "608"}
[0m20:32:59.635829 [debug] [MainThread]: Command `dbt ls` succeeded at 20:32:59.635632 after 1.58 seconds
[0m20:32:59.637857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719683fac9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719680c90e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7196808df970>]}
[0m20:32:59.639555 [debug] [MainThread]: Flushing usage events
[0m20:56:56.819134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160ddeec580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160dc369a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160dc3699c0>]}


============================== 20:56:56.827351 | c02c4f23-a4bd-4f43-8e96-0d6183284d50 ==============================
[0m20:56:56.827351 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:56:56.829559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type source', 'send_anonymous_usage_stats': 'True'}
[0m20:56:57.139641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c02c4f23-a4bd-4f43-8e96-0d6183284d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160dc3a7670>]}
[0m20:56:57.243750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c02c4f23-a4bd-4f43-8e96-0d6183284d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160de575270>]}
[0m20:56:57.246583 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m20:56:57.264454 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:56:58.631356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:58.633047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:58.635715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m20:56:58.643489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c02c4f23-a4bd-4f43-8e96-0d6183284d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160da754b20>]}
[0m20:56:58.687964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c02c4f23-a4bd-4f43-8e96-0d6183284d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160da81c430>]}
[0m20:56:58.690135 [info ] [MainThread]: Found 48 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:56:58.692404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c02c4f23-a4bd-4f43-8e96-0d6183284d50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160da81f940>]}
[0m20:56:58.697336 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.9544363, "process_user_time": 2.78633, "process_kernel_time": 0.600973, "process_mem_max_rss": "97724", "process_in_blocks": "78264", "process_out_blocks": "608"}
[0m20:56:58.699501 [debug] [MainThread]: Command `dbt ls` succeeded at 20:56:58.699296 after 1.96 seconds
[0m20:56:58.701289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160ddeec580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160de575270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7160da81f910>]}
[0m20:56:58.702752 [debug] [MainThread]: Flushing usage events
[0m20:57:13.757087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b72809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b56fd9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b56fd990>]}


============================== 20:57:13.763631 | cae6f379-b681-4a3c-ace9-da5cf8b6d9ef ==============================
[0m20:57:13.763631 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:57:13.765745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt source freshness --select hubspot.*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:57:13.981956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae6f379-b681-4a3c-ace9-da5cf8b6d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b573b640>]}
[0m20:57:14.084591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cae6f379-b681-4a3c-ace9-da5cf8b6d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b7908f40>]}
[0m20:57:14.087131 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m20:57:14.103381 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m20:57:15.107560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:57:15.109721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:57:15.112461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m20:57:15.120504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cae6f379-b681-4a3c-ace9-da5cf8b6d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b3ae0af0>]}
[0m20:57:15.163228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cae6f379-b681-4a3c-ace9-da5cf8b6d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b3bac400>]}
[0m20:57:15.164870 [info ] [MainThread]: Found 48 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:57:15.166779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cae6f379-b681-4a3c-ace9-da5cf8b6d9ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b3baf910>]}
[0m20:57:15.169056 [warn ] [MainThread]: The selection criterion 'hubspot.*' does not match any nodes
[0m20:57:15.172078 [info ] [MainThread]: 
[0m20:57:15.174027 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:57:15.202269 [info ] [MainThread]: Done.
[0m20:57:15.205289 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 1.5038108, "process_user_time": 2.040335, "process_kernel_time": 0.399613, "process_mem_max_rss": "97872", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m20:57:15.207633 [debug] [MainThread]: Command `dbt source freshness` succeeded at 20:57:15.207448 after 1.51 seconds
[0m20:57:15.209217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b72809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b7908f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b5b3baee30>]}
[0m20:57:15.210771 [debug] [MainThread]: Flushing usage events
[0m21:06:05.829712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a129d49a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a1113d6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a1113c910>]}


============================== 21:06:05.837718 | 3802389c-b80e-4be6-8fd3-04ffc8aa91b2 ==============================
[0m21:06:05.837718 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:06:05.839729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type source', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:06:06.132743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3802389c-b80e-4be6-8fd3-04ffc8aa91b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a1113faf0>]}
[0m21:06:06.235970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3802389c-b80e-4be6-8fd3-04ffc8aa91b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a13051030>]}
[0m21:06:06.238251 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m21:06:06.254284 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:06:07.693505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:06:07.695227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:06:07.698186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m21:06:07.705760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3802389c-b80e-4be6-8fd3-04ffc8aa91b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a0f240be0>]}
[0m21:06:07.750672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3802389c-b80e-4be6-8fd3-04ffc8aa91b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a0f304460>]}
[0m21:06:07.752504 [info ] [MainThread]: Found 48 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:06:07.754628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3802389c-b80e-4be6-8fd3-04ffc8aa91b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a0f307ac0>]}
[0m21:06:07.760064 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.9974519, "process_user_time": 2.288528, "process_kernel_time": 0.709331, "process_mem_max_rss": "97532", "process_in_blocks": "78264", "process_out_blocks": "608"}
[0m21:06:07.762085 [debug] [MainThread]: Command `dbt ls` succeeded at 21:06:07.761890 after 2.00 seconds
[0m21:06:07.763545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a129d49a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a0f4c0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763a0f307970>]}
[0m21:06:07.764804 [debug] [MainThread]: Flushing usage events
[0m21:16:23.221349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be7c07e8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be7bf105150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be7bf104850>]}


============================== 21:16:23.229180 | d8f03992-867e-4ecb-aa5f-5b424575a516 ==============================
[0m21:16:23.229180 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:16:23.231479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:23.347170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8f03992-867e-4ecb-aa5f-5b424575a516', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be7bf5ba8c0>]}
[0m21:16:23.387268 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.23350671, "process_user_time": 2.169422, "process_kernel_time": 0.566922, "process_mem_max_rss": "86588", "process_in_blocks": "67656", "process_out_blocks": "608"}
[0m21:16:23.389494 [debug] [MainThread]: Command `dbt clean` succeeded at 21:16:23.389274 after 0.24 seconds
[0m21:16:23.391133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be7c07e8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be7bf02b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be7bf02ba90>]}
[0m21:16:23.392782 [debug] [MainThread]: Flushing usage events
[0m21:16:51.174237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6edc4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6d538b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6d538a90>]}


============================== 21:16:51.180912 | 6788a51b-26cb-4dd8-a9d7-07c1f2efbcca ==============================
[0m21:16:51.180912 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:16:51.184064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt parse', 'send_anonymous_usage_stats': 'True'}
[0m21:16:51.462866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6788a51b-26cb-4dd8-a9d7-07c1f2efbcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6d277370>]}
[0m21:16:51.548252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6788a51b-26cb-4dd8-a9d7-07c1f2efbcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6d62b160>]}
[0m21:16:51.551385 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m21:16:51.562574 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:16:51.568621 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:16:51.570279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6788a51b-26cb-4dd8-a9d7-07c1f2efbcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6b7afeb0>]}
[0m21:16:53.583005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m21:16:53.590565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6788a51b-26cb-4dd8-a9d7-07c1f2efbcca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac69640dc0>]}
[0m21:16:53.597687 [info ] [MainThread]: Performance info: /usr/app/target/perf_info.json
[0m21:16:53.629512 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 2.512855, "process_user_time": 3.10765, "process_kernel_time": 0.398024, "process_mem_max_rss": "102184", "process_in_blocks": "11304", "process_out_blocks": "608"}
[0m21:16:53.631453 [debug] [MainThread]: Command `dbt parse` succeeded at 21:16:53.631262 after 2.51 seconds
[0m21:16:53.632934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6edc4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac6b888fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dac696ccac0>]}
[0m21:16:53.634629 [debug] [MainThread]: Flushing usage events
[0m21:17:08.072775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b1c2b4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b1aa1e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b1aa1d3c0>]}


============================== 21:17:08.079628 | 621ca6d8-4b2b-477b-8e98-4b16b2eb2e6d ==============================
[0m21:17:08.079628 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:17:08.081413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type source', 'send_anonymous_usage_stats': 'True'}
[0m21:17:08.277212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '621ca6d8-4b2b-477b-8e98-4b16b2eb2e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b1a75f700>]}
[0m21:17:08.362914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '621ca6d8-4b2b-477b-8e98-4b16b2eb2e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b1c931060>]}
[0m21:17:08.365061 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m21:17:08.375754 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:17:09.331497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:17:09.333440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:17:09.336215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m21:17:09.343762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '621ca6d8-4b2b-477b-8e98-4b16b2eb2e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b18b20bb0>]}
[0m21:17:09.394474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '621ca6d8-4b2b-477b-8e98-4b16b2eb2e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b18be4430>]}
[0m21:17:09.396778 [info ] [MainThread]: Found 48 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:17:09.398871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '621ca6d8-4b2b-477b-8e98-4b16b2eb2e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b18be79d0>]}
[0m21:17:09.402566 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.3849683, "process_user_time": 2.299774, "process_kernel_time": 0.37815, "process_mem_max_rss": "97928", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m21:17:09.404642 [debug] [MainThread]: Command `dbt ls` succeeded at 21:17:09.404450 after 1.39 seconds
[0m21:17:09.406242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b1c2b4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b18f987c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767b18be7940>]}
[0m21:17:09.408110 [debug] [MainThread]: Flushing usage events
[0m21:18:05.027222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9ac470580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9aa8f1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9aa8f19c0>]}


============================== 21:18:05.035574 | 18a98c4a-8243-4c32-b926-012dbc941844 ==============================
[0m21:18:05.035574 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:18:05.037618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --resource-type source', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:18:05.323684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18a98c4a-8243-4c32-b926-012dbc941844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9aa92b670>]}
[0m21:18:05.422749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18a98c4a-8243-4c32-b926-012dbc941844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9acafd270>]}
[0m21:18:05.425408 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m21:18:05.443320 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m21:18:06.455334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:06.459054 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:06.464710 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m21:18:06.479524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18a98c4a-8243-4c32-b926-012dbc941844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9a8ce4b20>]}
[0m21:18:06.530645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18a98c4a-8243-4c32-b926-012dbc941844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9a8dac430>]}
[0m21:18:06.532643 [info ] [MainThread]: Found 48 models, 10 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:18:06.534943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18a98c4a-8243-4c32-b926-012dbc941844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9a8daf940>]}
[0m21:18:06.540234 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.5810373, "process_user_time": 2.378271, "process_kernel_time": 0.548536, "process_mem_max_rss": "97876", "process_in_blocks": "78672", "process_out_blocks": "608"}
[0m21:18:06.542316 [debug] [MainThread]: Command `dbt ls` succeeded at 21:18:06.542109 after 1.58 seconds
[0m21:18:06.544053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9ac470580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9acafd270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a9a8daf910>]}
[0m21:18:06.545777 [debug] [MainThread]: Flushing usage events
[0m09:01:31.693586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b103130610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b1018a4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b1018a4a90>]}


============================== 09:01:31.702177 | 3d59b036-a03c-406b-b283-740c31a6c040 ==============================
[0m09:01:31.702177 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:01:31.704215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:01:31.815920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d59b036-a03c-406b-b283-740c31a6c040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b101edeb00>]}
[0m09:01:31.852420 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.27909735, "process_user_time": 2.100645, "process_kernel_time": 0.515327, "process_mem_max_rss": "86296", "process_in_blocks": "74808", "process_out_blocks": "608"}
[0m09:01:31.854675 [debug] [MainThread]: Command `dbt clean` succeeded at 09:01:31.854435 after 0.28 seconds
[0m09:01:31.856214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b103130610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b1037bc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71b101997ca0>]}
[0m09:01:31.858458 [debug] [MainThread]: Flushing usage events
[0m09:01:42.280034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767332aac580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767331221150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767331220850>]}


============================== 09:01:42.287106 | e9d5b53b-66c9-4662-a32a-3853d0565096 ==============================
[0m09:01:42.287106 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:01:42.289583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt parse', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:01:42.549229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9d5b53b-66c9-4662-a32a-3853d0565096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767330f5f340>]}
[0m09:01:42.640297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9d5b53b-66c9-4662-a32a-3853d0565096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7673313130a0>]}
[0m09:01:42.643141 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:01:42.657653 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:01:42.665378 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:01:42.666968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e9d5b53b-66c9-4662-a32a-3853d0565096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76732f760940>]}
[0m09:01:44.899159 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:01:44.907364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9d5b53b-66c9-4662-a32a-3853d0565096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76732d2f40d0>]}
[0m09:01:44.914375 [info ] [MainThread]: Performance info: /usr/app/target/perf_info.json
[0m09:01:44.943636 [debug] [MainThread]: Resource report: {"command_name": "parse", "command_success": true, "command_wall_clock_time": 2.7250433, "process_user_time": 3.157094, "process_kernel_time": 0.52027, "process_mem_max_rss": "102532", "process_in_blocks": "12168", "process_out_blocks": "608"}
[0m09:01:44.945903 [debug] [MainThread]: Command `dbt parse` succeeded at 09:01:44.945669 after 2.73 seconds
[0m09:01:44.948320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767332aac580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76732f571480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76732f385060>]}
[0m09:01:44.949814 [debug] [MainThread]: Flushing usage events
[0m09:01:57.826227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af88c564580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af88a9d1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af88a9d19c0>]}


============================== 09:01:57.833160 | a24d1e50-8786-42e0-a17b-c059e5725745 ==============================
[0m09:01:57.833160 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:01:57.835008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type source', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:01:58.053096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a24d1e50-8786-42e0-a17b-c059e5725745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af88aa0f670>]}
[0m09:01:58.152952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a24d1e50-8786-42e0-a17b-c059e5725745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af88cbe1270>]}
[0m09:01:58.155102 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:01:58.165573 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:01:59.211809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:01:59.214103 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:01:59.217311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:01:59.224994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a24d1e50-8786-42e0-a17b-c059e5725745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af888dddd20>]}
[0m09:01:59.270471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a24d1e50-8786-42e0-a17b-c059e5725745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af888e98970>]}
[0m09:01:59.272467 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:01:59.274671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a24d1e50-8786-42e0-a17b-c059e5725745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af888e98c10>]}
[0m09:01:59.278760 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.5142878, "process_user_time": 2.601028, "process_kernel_time": 0.346279, "process_mem_max_rss": "97564", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:01:59.280956 [debug] [MainThread]: Command `dbt ls` succeeded at 09:01:59.280691 after 1.52 seconds
[0m09:01:59.283051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af88c564580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af88cbe1270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7af888e98c40>]}
[0m09:01:59.284569 [debug] [MainThread]: Flushing usage events
[0m09:12:35.350794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656dcba0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656db009720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656db0096c0>]}


============================== 09:12:35.358786 | f8dafa5f-a176-4cd9-bb28-5fd903f229c5 ==============================
[0m09:12:35.358786 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:12:35.361160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_deals', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:12:35.665851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8dafa5f-a176-4cd9-bb28-5fd903f229c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656db04f4c0>]}
[0m09:12:35.768368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8dafa5f-a176-4cd9-bb28-5fd903f229c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656dd21ead0>]}
[0m09:12:35.771202 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:12:35.792868 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:12:37.261755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:12:37.265230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:12:37.272184 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:12:37.288815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8dafa5f-a176-4cd9-bb28-5fd903f229c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656d9415b70>]}
[0m09:12:37.408953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8dafa5f-a176-4cd9-bb28-5fd903f229c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656d94d0880>]}
[0m09:12:37.412019 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:12:37.414650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8dafa5f-a176-4cd9-bb28-5fd903f229c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656d94d0a60>]}
[0m09:12:37.418157 [warn ] [MainThread]: The selection criterion 'stg_deals' does not match any nodes
[0m09:12:37.423049 [info ] [MainThread]: 
[0m09:12:37.426131 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:12:37.429028 [debug] [MainThread]: Command end result
[0m09:12:37.464342 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1958687, "process_user_time": 2.357633, "process_kernel_time": 0.772535, "process_mem_max_rss": "98152", "process_in_blocks": "19080", "process_out_blocks": "608"}
[0m09:12:37.467406 [debug] [MainThread]: Command `dbt run` succeeded at 09:12:37.467121 after 2.20 seconds
[0m09:12:37.470035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656dcba0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656d96cba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7656d94d0a00>]}
[0m09:12:37.471651 [debug] [MainThread]: Flushing usage events
[0m09:15:16.973818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f4734610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f2e9e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f2e9d540>]}


============================== 09:15:16.981801 | a8c42dc9-6003-4fc6-acd4-ef5ad8a98543 ==============================
[0m09:15:16.981801 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:15:16.984744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls --resource-type model', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:17.376797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8c42dc9-6003-4fc6-acd4-ef5ad8a98543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f325b5b0>]}
[0m09:15:17.515455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8c42dc9-6003-4fc6-acd4-ef5ad8a98543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f4db1030>]}
[0m09:15:17.518117 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:15:17.535634 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:15:18.495453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:15:18.497802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:15:18.500833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:15:18.508397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8c42dc9-6003-4fc6-acd4-ef5ad8a98543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f0fadd50>]}
[0m09:15:18.566061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8c42dc9-6003-4fc6-acd4-ef5ad8a98543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f1064a60>]}
[0m09:15:18.567932 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:15:18.569895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8c42dc9-6003-4fc6-acd4-ef5ad8a98543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f1064be0>]}
[0m09:15:18.576040 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.6786425, "process_user_time": 2.445832, "process_kernel_time": 0.611458, "process_mem_max_rss": "96936", "process_in_blocks": "704", "process_out_blocks": "608"}
[0m09:15:18.578426 [debug] [MainThread]: Command `dbt ls` succeeded at 09:15:18.578224 after 1.68 seconds
[0m09:15:18.580614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f4734610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f125d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7123f1064070>]}
[0m09:15:18.582624 [debug] [MainThread]: Flushing usage events
[0m09:18:54.544633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78e5af2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78ca29930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78ca298d0>]}


============================== 09:18:54.553454 | b906cf12-7cb5-4cdc-ae8d-896d38ae2f49 ==============================
[0m09:18:54.553454 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:18:54.555651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s staging.hubspot.stg_deals', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:18:54.789932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b906cf12-7cb5-4cdc-ae8d-896d38ae2f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78ca6b580>]}
[0m09:18:54.890963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b906cf12-7cb5-4cdc-ae8d-896d38ae2f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78ce40ac0>]}
[0m09:18:54.893086 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:18:54.910406 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:18:55.830752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:18:55.832773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:18:55.835719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:18:55.844468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b906cf12-7cb5-4cdc-ae8d-896d38ae2f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78ae2dc30>]}
[0m09:18:55.891692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b906cf12-7cb5-4cdc-ae8d-896d38ae2f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78aee8940>]}
[0m09:18:55.893501 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:18:55.895719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b906cf12-7cb5-4cdc-ae8d-896d38ae2f49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78aee88e0>]}
[0m09:18:55.898276 [warn ] [MainThread]: The selection criterion 'staging.hubspot.stg_deals' does not match any nodes
[0m09:18:55.900869 [info ] [MainThread]: 
[0m09:18:55.902646 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:18:55.905022 [debug] [MainThread]: Command end result
[0m09:18:55.934601 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4550623, "process_user_time": 2.290795, "process_kernel_time": 0.439168, "process_mem_max_rss": "98028", "process_in_blocks": "1312", "process_out_blocks": "608"}
[0m09:18:55.936697 [debug] [MainThread]: Command `dbt run` succeeded at 09:18:55.936449 after 1.46 seconds
[0m09:18:55.938755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78e5af2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78ce40ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e78b2125f0>]}
[0m09:18:55.940412 [debug] [MainThread]: Flushing usage events
[0m09:20:01.468641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61233cc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6121849720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61218496c0>]}


============================== 09:20:01.476997 | dca98ebd-0306-4a74-83c4-9f1acb49427e ==============================
[0m09:20:01.476997 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:20:01.479214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s hubspot_dbt.staging.hubspot.stg_companies', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:20:01.707406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dca98ebd-0306-4a74-83c4-9f1acb49427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f612188b4c0>]}
[0m09:20:01.808241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dca98ebd-0306-4a74-83c4-9f1acb49427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6123a56ad0>]}
[0m09:20:01.810418 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:20:01.827914 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:20:02.913210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:20:02.915291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:20:02.918525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:20:02.926701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dca98ebd-0306-4a74-83c4-9f1acb49427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611fc41b70>]}
[0m09:20:02.983437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dca98ebd-0306-4a74-83c4-9f1acb49427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611fd04880>]}
[0m09:20:02.985777 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:20:02.988073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dca98ebd-0306-4a74-83c4-9f1acb49427e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611fd04a60>]}
[0m09:20:02.990254 [warn ] [MainThread]: The selection criterion 'hubspot_dbt.staging.hubspot.stg_companies' does not match any nodes
[0m09:20:02.992944 [info ] [MainThread]: 
[0m09:20:02.995088 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:20:02.997740 [debug] [MainThread]: Command end result
[0m09:20:03.032621 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6347224, "process_user_time": 2.327624, "process_kernel_time": 0.444471, "process_mem_max_rss": "97812", "process_in_blocks": "1688", "process_out_blocks": "608"}
[0m09:20:03.034334 [debug] [MainThread]: Command `dbt run` succeeded at 09:20:03.034124 after 1.64 seconds
[0m09:20:03.036352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61233cc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611fefba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f611fd04a00>]}
[0m09:20:03.038180 [debug] [MainThread]: Flushing usage events
[0m09:30:02.902856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468cc0ac610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468ca525720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468ca5256c0>]}


============================== 09:30:02.910120 | 5f9f55df-9fb6-4b69-8c95-1d4b8420a27f ==============================
[0m09:30:02.910120 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:30:02.912131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_deals', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:30:03.159211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f9f55df-9fb6-4b69-8c95-1d4b8420a27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468ca56b4c0>]}
[0m09:30:03.262262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f9f55df-9fb6-4b69-8c95-1d4b8420a27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468cc73aad0>]}
[0m09:30:03.264900 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:30:03.282628 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:30:04.194746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:30:04.196880 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:30:04.200352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:30:04.208926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f9f55df-9fb6-4b69-8c95-1d4b8420a27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468c892db70>]}
[0m09:30:04.267467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f9f55df-9fb6-4b69-8c95-1d4b8420a27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468c88fc880>]}
[0m09:30:04.269242 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:30:04.271722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f9f55df-9fb6-4b69-8c95-1d4b8420a27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468c88fca60>]}
[0m09:30:04.273868 [warn ] [MainThread]: The selection criterion 'stg_deals' does not match any nodes
[0m09:30:04.276325 [info ] [MainThread]: 
[0m09:30:04.278161 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:30:04.280438 [debug] [MainThread]: Command end result
[0m09:30:04.310362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4720678, "process_user_time": 2.407115, "process_kernel_time": 0.743946, "process_mem_max_rss": "98032", "process_in_blocks": "4784", "process_out_blocks": "608"}
[0m09:30:04.312584 [debug] [MainThread]: Command `dbt run` succeeded at 09:30:04.312275 after 1.47 seconds
[0m09:30:04.314426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468cc0ac610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468c8bdfa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7468c88fca00>]}
[0m09:30:04.315848 [debug] [MainThread]: Flushing usage events
[0m09:30:37.061975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ce034c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdeac26b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdeac1510>]}


============================== 09:30:37.069263 | 1faa560f-4010-43fb-a190-d3ed78e151b3 ==============================
[0m09:30:37.069263 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:30:37.071420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls -s stg_deals', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:30:37.375078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1faa560f-4010-43fb-a190-d3ed78e151b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdee769e0>]}
[0m09:30:37.501249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1faa560f-4010-43fb-a190-d3ed78e151b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ce09d9030>]}
[0m09:30:37.504236 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:30:37.527489 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:30:38.682309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:30:38.684164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:30:38.687370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:30:38.695241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1faa560f-4010-43fb-a190-d3ed78e151b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdcbd1d50>]}
[0m09:30:38.747797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1faa560f-4010-43fb-a190-d3ed78e151b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdcb9ca60>]}
[0m09:30:38.750189 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:30:38.752927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1faa560f-4010-43fb-a190-d3ed78e151b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdcb9cbe0>]}
[0m09:30:38.757232 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.7647953, "process_user_time": 2.220633, "process_kernel_time": 0.544311, "process_mem_max_rss": "98144", "process_in_blocks": "3168", "process_out_blocks": "608"}
[0m09:30:38.759698 [debug] [MainThread]: Command `dbt ls` succeeded at 09:30:38.759384 after 1.77 seconds
[0m09:30:38.761708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1ce034c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdce7d330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b1cdcb9c070>]}
[0m09:30:38.763587 [debug] [MainThread]: Flushing usage events
[0m09:36:34.135263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae3f40a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae26a96f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae26a93f0>]}


============================== 09:36:34.145828 | d8c5be3e-28b0-48e4-93e5-f99fedb63065 ==============================
[0m09:36:34.145828 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:36:34.147965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls -s stg_deals', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:36:34.389111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8c5be3e-28b0-48e4-93e5-f99fedb63065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae26a88e0>]}
[0m09:36:34.490832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8c5be3e-28b0-48e4-93e5-f99fedb63065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae45bd030>]}
[0m09:36:34.493554 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:36:34.514266 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:36:34.521353 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:36:34.523049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8c5be3e-28b0-48e4-93e5-f99fedb63065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae0ba0100>]}
[0m09:36:36.580174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:36:36.589263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8c5be3e-28b0-48e4-93e5-f99fedb63065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ada554190>]}
[0m09:36:36.646699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8c5be3e-28b0-48e4-93e5-f99fedb63065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae0ba0100>]}
[0m09:36:36.648522 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:36:36.650648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8c5be3e-28b0-48e4-93e5-f99fedb63065', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae080d330>]}
[0m09:36:36.656152 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.5880797, "process_user_time": 3.249034, "process_kernel_time": 0.804448, "process_mem_max_rss": "101920", "process_in_blocks": "3760", "process_out_blocks": "608"}
[0m09:36:36.658031 [debug] [MainThread]: Command `dbt ls` succeeded at 09:36:36.657842 after 2.59 seconds
[0m09:36:36.659524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae3f40a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae0a73100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737ae0ba0100>]}
[0m09:36:36.661716 [debug] [MainThread]: Flushing usage events
[0m09:36:54.918318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db15598370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db13a15690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db13a15630>]}


============================== 09:36:54.925117 | 9863c96f-8a5f-4533-97dd-aafff2056490 ==============================
[0m09:36:54.925117 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:36:54.927189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_deals', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:36:55.133419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9863c96f-8a5f-4533-97dd-aafff2056490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db13a57460>]}
[0m09:36:55.223305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9863c96f-8a5f-4533-97dd-aafff2056490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db13dfc610>]}
[0m09:36:55.225586 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:36:55.244473 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:36:56.164076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:36:56.166403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:36:56.169175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:36:56.177107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9863c96f-8a5f-4533-97dd-aafff2056490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db11e19b10>]}
[0m09:36:56.222027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9863c96f-8a5f-4533-97dd-aafff2056490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db11de87f0>]}
[0m09:36:56.224131 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:36:56.226114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9863c96f-8a5f-4533-97dd-aafff2056490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db11de8a00>]}
[0m09:36:56.228237 [warn ] [MainThread]: The selection criterion 'stg_deals' does not match any nodes
[0m09:36:56.230939 [info ] [MainThread]: 
[0m09:36:56.233113 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:36:56.236156 [debug] [MainThread]: Command end result
[0m09:36:56.265905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4061518, "process_user_time": 2.196923, "process_kernel_time": 0.409462, "process_mem_max_rss": "97936", "process_in_blocks": "8192", "process_out_blocks": "608"}
[0m09:36:56.268612 [debug] [MainThread]: Command `dbt run` succeeded at 09:36:56.268342 after 1.41 seconds
[0m09:36:56.270488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db15598370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db120c43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77db13a57460>]}
[0m09:36:56.272264 [debug] [MainThread]: Flushing usage events
[0m09:43:32.572989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266f460580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266d88d6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266d88d690>]}


============================== 09:43:32.582478 | c15fc5e9-904b-4413-92ae-73e4f2783c44 ==============================
[0m09:43:32.582478 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:43:32.584556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s hubspot_dbt.staging.hubspot.stg_deals', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:43:32.865220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c15fc5e9-904b-4413-92ae-73e4f2783c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266d8cf490>]}
[0m09:43:32.968167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c15fc5e9-904b-4413-92ae-73e4f2783c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266f99b130>]}
[0m09:43:32.970697 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:43:32.989169 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:43:33.945632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:43:33.947469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:43:33.950462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:43:33.958226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c15fc5e9-904b-4413-92ae-73e4f2783c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266bc91b40>]}
[0m09:43:34.016814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c15fc5e9-904b-4413-92ae-73e4f2783c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266bc60820>]}
[0m09:43:34.018946 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:43:34.021230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c15fc5e9-904b-4413-92ae-73e4f2783c44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266bc60a30>]}
[0m09:43:34.023529 [warn ] [MainThread]: The selection criterion 'hubspot_dbt.staging.hubspot.stg_deals' does not match any nodes
[0m09:43:34.026549 [info ] [MainThread]: 
[0m09:43:34.028919 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:43:34.031586 [debug] [MainThread]: Command end result
[0m09:43:34.064286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5580649, "process_user_time": 2.343845, "process_kernel_time": 0.880409, "process_mem_max_rss": "97832", "process_in_blocks": "11592", "process_out_blocks": "608"}
[0m09:43:34.066137 [debug] [MainThread]: Command `dbt run` succeeded at 09:43:34.065928 after 1.56 seconds
[0m09:43:34.067984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266f460580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266bf3dc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74266bc607f0>]}
[0m09:43:34.069624 [debug] [MainThread]: Flushing usage events
[0m09:46:14.789897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837ea57c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837e89a9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837e89a9720>]}


============================== 09:46:14.798841 | d12d6bac-08bf-4840-bdff-e164d998de08 ==============================
[0m09:46:14.798841 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:46:14.801181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s model:hubspot_dbt.staging.hubspot.stg_deals', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:46:15.039527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12d6bac-08bf-4840-bdff-e164d998de08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837e89eb4f0>]}
[0m09:46:15.144898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd12d6bac-08bf-4840-bdff-e164d998de08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837eaab42e0>]}
[0m09:46:15.147288 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:46:15.166114 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:46:16.100892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:16.103048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:16.106002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:46:16.115941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12d6bac-08bf-4840-bdff-e164d998de08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837e6dadba0>]}
[0m09:46:16.176130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd12d6bac-08bf-4840-bdff-e164d998de08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837e6d7c070>]}
[0m09:46:16.178241 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:46:16.180631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12d6bac-08bf-4840-bdff-e164d998de08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837e6d7cb20>]}
[0m09:46:16.182868 [error] [MainThread]: Encountered an error:
Runtime Error
  'model' is not a valid method name
[0m09:46:16.186861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4646453, "process_user_time": 2.163901, "process_kernel_time": 0.573852, "process_mem_max_rss": "97872", "process_in_blocks": "7920", "process_out_blocks": "608", "command_success": false}
[0m09:46:16.188784 [debug] [MainThread]: Command `dbt run` failed at 09:46:16.188499 after 1.47 seconds
[0m09:46:16.190259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837ea57c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837e6d6fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7837e6d6fa60>]}
[0m09:46:16.191656 [debug] [MainThread]: Flushing usage events
[0m09:46:44.231687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b715478a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7138e57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7138e5750>]}


============================== 09:46:44.239368 | 86ea9ef6-62a1-4523-a6f6-81227d4facc3 ==============================
[0m09:46:44.239368 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:46:44.241456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s models/staging/hubspot/stg_deals.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:46:44.460319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86ea9ef6-62a1-4523-a6f6-81227d4facc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b71392b520>]}
[0m09:46:44.558349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86ea9ef6-62a1-4523-a6f6-81227d4facc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b713be22f0>]}
[0m09:46:44.560618 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:46:44.579449 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:46:45.625468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:45.627553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:45.630645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:46:45.639162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86ea9ef6-62a1-4523-a6f6-81227d4facc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b711cedbd0>]}
[0m09:46:45.691364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86ea9ef6-62a1-4523-a6f6-81227d4facc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b711cbc0a0>]}
[0m09:46:45.693464 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:46:45.695790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86ea9ef6-62a1-4523-a6f6-81227d4facc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b711cbcac0>]}
[0m09:46:45.708047 [warn ] [MainThread]: The selection criterion 'models/staging/hubspot/stg_deals.sql' does not match any nodes
[0m09:46:45.711437 [info ] [MainThread]: 
[0m09:46:45.714110 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:46:45.716637 [debug] [MainThread]: Command end result
[0m09:46:45.747680 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5775155, "process_user_time": 2.167455, "process_kernel_time": 0.550587, "process_mem_max_rss": "97900", "process_in_blocks": "1928", "process_out_blocks": "608"}
[0m09:46:45.750889 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:45.750670 after 1.58 seconds
[0m09:46:45.752752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b715478a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b7138e4ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72b713be22f0>]}
[0m09:46:45.754739 [debug] [MainThread]: Flushing usage events
[0m09:47:11.932285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69916d72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698fb4d930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698fb4d8d0>]}


============================== 09:47:11.939056 | 4d3e6d69-689e-44b3-9049-7990f3fbb00d ==============================
[0m09:47:11.939056 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:47:11.940969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s tag:staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:47:12.181175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3e6d69-689e-44b3-9049-7990f3fbb00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698fb93580>]}
[0m09:47:12.298658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3e6d69-689e-44b3-9049-7990f3fbb00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698ff64ac0>]}
[0m09:47:12.301122 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:47:12.320994 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:47:13.384925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:47:13.386928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:47:13.389919 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:47:13.399259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d3e6d69-689e-44b3-9049-7990f3fbb00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698df49c30>]}
[0m09:47:13.471292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d3e6d69-689e-44b3-9049-7990f3fbb00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698df18940>]}
[0m09:47:13.473088 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:47:13.475345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3e6d69-689e-44b3-9049-7990f3fbb00d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698df188e0>]}
[0m09:47:13.477551 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any nodes
[0m09:47:13.480038 [info ] [MainThread]: 
[0m09:47:13.481917 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:47:13.484378 [debug] [MainThread]: Command end result
[0m09:47:13.515873 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6426016, "process_user_time": 2.406905, "process_kernel_time": 0.517991, "process_mem_max_rss": "98296", "process_in_blocks": "32", "process_out_blocks": "608"}
[0m09:47:13.517991 [debug] [MainThread]: Command `dbt run` succeeded at 09:47:13.517775 after 1.64 seconds
[0m09:47:13.520166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69916d72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698ff64ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698fa225f0>]}
[0m09:47:13.521647 [debug] [MainThread]: Flushing usage events
[0m09:47:40.262233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96ec8c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96d0b5900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96d0b58a0>]}


============================== 09:47:40.269638 | 31de3529-968c-4390-9947-c76f86ba62e8 ==============================
[0m09:47:40.269638 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:47:40.271959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s hubspot_dbt.staging.hubspot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:47:40.497935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31de3529-968c-4390-9947-c76f86ba62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96d0fb550>]}
[0m09:47:40.598278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31de3529-968c-4390-9947-c76f86ba62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96f1c4340>]}
[0m09:47:40.600487 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:47:40.616097 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:47:41.604523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:47:41.606308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:47:41.608892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:47:41.616591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31de3529-968c-4390-9947-c76f86ba62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96b4bdc00>]}
[0m09:47:41.660148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31de3529-968c-4390-9947-c76f86ba62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96b48c940>]}
[0m09:47:41.661877 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:47:41.664162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31de3529-968c-4390-9947-c76f86ba62e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96b48c850>]}
[0m09:47:41.666311 [warn ] [MainThread]: The selection criterion 'hubspot_dbt.staging.hubspot' does not match any nodes
[0m09:47:41.669972 [info ] [MainThread]: 
[0m09:47:41.671790 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:47:41.674078 [debug] [MainThread]: Command end result
[0m09:47:41.704077 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.500159, "process_user_time": 2.848045, "process_kernel_time": 0.452566, "process_mem_max_rss": "98044", "process_in_blocks": "2184", "process_out_blocks": "608"}
[0m09:47:41.706054 [debug] [MainThread]: Command `dbt run` succeeded at 09:47:41.705730 after 1.50 seconds
[0m09:47:41.707545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96ec8c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96b7a0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a96b48cb20>]}
[0m09:47:41.708868 [debug] [MainThread]: Flushing usage events
[0m09:49:21.699210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799528d40880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995274b5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995274b62f0>]}


============================== 09:49:21.706671 | dd6a5341-ca44-4ab4-b35e-bdbc794ef1be ==============================
[0m09:49:21.706671 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:49:21.708756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m09:49:21.815658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd6a5341-ca44-4ab4-b35e-bdbc794ef1be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995275d4e50>]}
[0m09:49:21.847629 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.21213865, "process_user_time": 2.068179, "process_kernel_time": 0.369317, "process_mem_max_rss": "86920", "process_in_blocks": "2432", "process_out_blocks": "608"}
[0m09:49:21.849774 [debug] [MainThread]: Command `dbt clean` succeeded at 09:49:21.849532 after 0.21 seconds
[0m09:49:21.851269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799528d40880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995275d5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995275a6950>]}
[0m09:49:21.852960 [debug] [MainThread]: Flushing usage events
[0m09:51:05.250987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abde9fc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abdd16d150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abdd16c850>]}


============================== 09:51:05.258554 | 54dfeb59-8f1d-440a-9a2b-b201f89d59bf ==============================
[0m09:51:05.258554 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:51:05.260541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:51:05.352329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54dfeb59-8f1d-440a-9a2b-b201f89d59bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abdd67e8c0>]}
[0m09:51:05.364336 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1738921, "process_user_time": 1.954157, "process_kernel_time": 0.289647, "process_mem_max_rss": "86584", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:51:05.366164 [debug] [MainThread]: Command `dbt clean` succeeded at 09:51:05.365972 after 0.18 seconds
[0m09:51:05.367564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abde9fc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abdd25cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78abdf0843d0>]}
[0m09:51:05.369036 [debug] [MainThread]: Flushing usage events
[0m09:51:20.933870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd8b0100610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd8ae870b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd8ae870a90>]}


============================== 09:51:20.940458 | f26317fa-9b18-4681-b37d-fecd6e4e544a ==============================
[0m09:51:20.940458 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:51:20.942683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:51:20.945297 [info ] [MainThread]: dbt version: 1.7.10
[0m09:51:20.947411 [info ] [MainThread]: python version: 3.10.7
[0m09:51:20.949739 [info ] [MainThread]: python path: /usr/local/bin/python
[0m09:51:20.951591 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m09:51:21.105554 [info ] [MainThread]: Using profiles dir at /usr/app
[0m09:51:21.107791 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m09:51:21.109983 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m09:51:21.113259 [info ] [MainThread]: adapter type: postgres
[0m09:51:21.115880 [info ] [MainThread]: adapter version: 1.7.10
[0m09:51:21.221788 [info ] [MainThread]: Configuration:
[0m09:51:21.223897 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:51:21.225975 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:51:21.228052 [info ] [MainThread]: Required dependencies:
[0m09:51:21.230138 [debug] [MainThread]: Executing "git --help"
[0m09:51:21.259952 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:51:21.262234 [debug] [MainThread]: STDERR: "b''"
[0m09:51:21.264372 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:51:21.266912 [info ] [MainThread]: Connection:
[0m09:51:21.269234 [info ] [MainThread]:   host: postgres
[0m09:51:21.271697 [info ] [MainThread]:   port: 5432
[0m09:51:21.274178 [info ] [MainThread]:   user: elt
[0m09:51:21.276767 [info ] [MainThread]:   database: warehouse
[0m09:51:21.279736 [info ] [MainThread]:   schema: marts
[0m09:51:21.283039 [info ] [MainThread]:   connect_timeout: 10
[0m09:51:21.285641 [info ] [MainThread]:   role: None
[0m09:51:21.288210 [info ] [MainThread]:   search_path: None
[0m09:51:21.290483 [info ] [MainThread]:   keepalives_idle: 0
[0m09:51:21.292772 [info ] [MainThread]:   sslmode: None
[0m09:51:21.295144 [info ] [MainThread]:   sslcert: None
[0m09:51:21.297562 [info ] [MainThread]:   sslkey: None
[0m09:51:21.299919 [info ] [MainThread]:   sslrootcert: None
[0m09:51:21.302211 [info ] [MainThread]:   application_name: dbt
[0m09:51:21.304575 [info ] [MainThread]:   retries: 1
[0m09:51:21.307411 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:51:21.310514 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:51:21.312405 [debug] [MainThread]: Using postgres connection "debug"
[0m09:51:21.314833 [debug] [MainThread]: On debug: select 1 as id
[0m09:51:21.317218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:51:21.367638 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:51:21.370090 [debug] [MainThread]: On debug: Close
[0m09:51:21.371860 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:51:21.374063 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:51:21.377778 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.49918205, "process_user_time": 2.07733, "process_kernel_time": 0.39438, "process_mem_max_rss": "92768", "process_in_blocks": "4168", "process_out_blocks": "608"}
[0m09:51:21.381673 [debug] [MainThread]: Command `dbt debug` succeeded at 09:51:21.381451 after 0.50 seconds
[0m09:51:21.383347 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:51:21.384865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd8b0100610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd8ae870220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd8acbf6050>]}
[0m09:51:21.386383 [debug] [MainThread]: Flushing usage events
[0m09:51:52.493508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b8a1c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b6e999f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b6e99990>]}


============================== 09:51:52.500228 | 4bfee6d2-f2a1-4a80-8711-eaabd3eacca7 ==============================
[0m09:51:52.500228 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:51:52.502330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls --resource-type model', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:51:52.707394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bfee6d2-f2a1-4a80-8711-eaabd3eacca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b6ed3640>]}
[0m09:51:52.795580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bfee6d2-f2a1-4a80-8711-eaabd3eacca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b90a4f40>]}
[0m09:51:52.797937 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:51:52.808628 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:51:52.816397 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:51:52.818191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4bfee6d2-f2a1-4a80-8711-eaabd3eacca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b55d5540>]}
[0m09:51:54.798812 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:51:54.807076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bfee6d2-f2a1-4a80-8711-eaabd3eacca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a196f540d0>]}
[0m09:51:54.866924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bfee6d2-f2a1-4a80-8711-eaabd3eacca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b55d5480>]}
[0m09:51:54.868913 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:51:54.871048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bfee6d2-f2a1-4a80-8711-eaabd3eacca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b54bc1c0>]}
[0m09:51:54.875151 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.4390578, "process_user_time": 3.16586, "process_kernel_time": 0.38053, "process_mem_max_rss": "102468", "process_in_blocks": "416", "process_out_blocks": "608"}
[0m09:51:54.877530 [debug] [MainThread]: Command `dbt ls` succeeded at 09:51:54.877294 after 2.44 seconds
[0m09:51:54.879840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b8a1c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b52fa0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b567ea70>]}
[0m09:51:54.881914 [debug] [MainThread]: Flushing usage events
[0m09:53:20.838444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416c2d4c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416c11c96f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416c11c9690>]}


============================== 09:53:20.845333 | 2b242312-13aa-4a78-a834-ff6394963c96 ==============================
[0m09:53:20.845333 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:53:20.847615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s staging.hubspot.*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:53:21.051479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b242312-13aa-4a78-a834-ff6394963c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416c120b490>]}
[0m09:53:21.150617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b242312-13aa-4a78-a834-ff6394963c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416c33db130>]}
[0m09:53:21.153480 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:53:21.173993 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:53:22.115643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:53:22.117669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:53:22.120327 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:53:22.127714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b242312-13aa-4a78-a834-ff6394963c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416bf5cdb40>]}
[0m09:53:22.169365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b242312-13aa-4a78-a834-ff6394963c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416bf688820>]}
[0m09:53:22.171103 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:53:22.173253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b242312-13aa-4a78-a834-ff6394963c96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416bf688a30>]}
[0m09:53:22.175638 [warn ] [MainThread]: The selection criterion 'staging.hubspot.*' does not match any nodes
[0m09:53:22.178169 [info ] [MainThread]: 
[0m09:53:22.179923 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:53:22.182267 [debug] [MainThread]: Command end result
[0m09:53:22.209387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4285606, "process_user_time": 2.401071, "process_kernel_time": 0.489538, "process_mem_max_rss": "98344", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:53:22.211452 [debug] [MainThread]: Command `dbt run` succeeded at 09:53:22.211148 after 1.43 seconds
[0m09:53:22.213035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416c2d4c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416bf87dc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7416bf6887f0>]}
[0m09:53:22.214585 [debug] [MainThread]: Flushing usage events
[0m09:53:54.940015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8332a8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb831bc66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb831bc5540>]}


============================== 09:53:54.948682 | ae12bc27-3dfe-4af6-aa15-21025ca76334 ==============================
[0m09:53:54.948682 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:53:54.951415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type model', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:55.204792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae12bc27-3dfe-4af6-aa15-21025ca76334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb831f82950>]}
[0m09:53:55.298722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae12bc27-3dfe-4af6-aa15-21025ca76334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8337e1030>]}
[0m09:53:55.301693 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:53:55.319279 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:53:56.237194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:53:56.239440 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:53:56.242860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:53:56.253327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae12bc27-3dfe-4af6-aa15-21025ca76334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb82faddd50>]}
[0m09:53:56.300437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae12bc27-3dfe-4af6-aa15-21025ca76334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb82faa4a60>]}
[0m09:53:56.302612 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:53:56.305151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae12bc27-3dfe-4af6-aa15-21025ca76334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb82faa4be0>]}
[0m09:53:56.309676 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.4450843, "process_user_time": 2.313033, "process_kernel_time": 0.371179, "process_mem_max_rss": "98192", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:53:56.311732 [debug] [MainThread]: Command `dbt ls` succeeded at 09:53:56.311497 after 1.45 seconds
[0m09:53:56.313198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8332a8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb82fd89330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb82faa4070>]}
[0m09:53:56.314553 [debug] [MainThread]: Flushing usage events
[0m09:54:42.086540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78494b708880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784949b71780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784949b71720>]}


============================== 09:54:42.095080 | be1d2f98-a52e-47ab-9aca-0645257de7cf ==============================
[0m09:54:42.095080 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:54:42.097374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s staging', 'send_anonymous_usage_stats': 'True'}
[0m09:54:42.339128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be1d2f98-a52e-47ab-9aca-0645257de7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784949bbb4f0>]}
[0m09:54:42.441543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be1d2f98-a52e-47ab-9aca-0645257de7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78494bd842e0>]}
[0m09:54:42.444452 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:54:42.464977 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:54:43.462355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:54:43.464929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:54:43.468368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:54:43.477189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be1d2f98-a52e-47ab-9aca-0645257de7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784947f7dba0>]}
[0m09:54:43.520837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be1d2f98-a52e-47ab-9aca-0645257de7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784947f4c070>]}
[0m09:54:43.522826 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:54:43.525267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be1d2f98-a52e-47ab-9aca-0645257de7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784947f4cb20>]}
[0m09:54:43.527688 [warn ] [MainThread]: The selection criterion 'staging' does not match any nodes
[0m09:54:43.530649 [info ] [MainThread]: 
[0m09:54:43.532642 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:54:43.535007 [debug] [MainThread]: Command end result
[0m09:54:43.564770 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5411972, "process_user_time": 2.289993, "process_kernel_time": 0.335501, "process_mem_max_rss": "98000", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:54:43.566739 [debug] [MainThread]: Command `dbt run` succeeded at 09:54:43.566527 after 1.54 seconds
[0m09:54:43.568681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78494b708880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78494bd842e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784948229660>]}
[0m09:54:43.570436 [debug] [MainThread]: Flushing usage events
[0m09:55:41.806153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e8026b0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e800e266b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e800e25300>]}


============================== 09:55:41.814156 | 58fb4491-4622-4711-a778-6b2f6811b09f ==============================
[0m09:55:41.814156 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:55:41.816692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls -s stg_deals --output json', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:55:42.033511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58fb4491-4622-4711-a778-6b2f6811b09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e802ec8f40>]}
[0m09:55:42.121258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58fb4491-4622-4711-a778-6b2f6811b09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e802d3d090>]}
[0m09:55:42.123862 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:55:42.140828 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:55:43.176007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:55:43.178066 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:55:43.181201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:55:43.188761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58fb4491-4622-4711-a778-6b2f6811b09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e7fef35d80>]}
[0m09:55:43.230642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58fb4491-4622-4711-a778-6b2f6811b09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e7fef00a90>]}
[0m09:55:43.232693 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:55:43.235228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fb4491-4622-4711-a778-6b2f6811b09f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e7fef00c10>]}
[0m09:55:43.238487 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.5031253, "process_user_time": 2.337881, "process_kernel_time": 0.415101, "process_mem_max_rss": "98220", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:55:43.240994 [debug] [MainThread]: Command `dbt ls` succeeded at 09:55:43.240683 after 1.51 seconds
[0m09:55:43.243495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e8026b0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e7ff1e8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79e7fef00190>]}
[0m09:55:43.245480 [debug] [MainThread]: Flushing usage events
[0m09:56:15.947716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241c2f54a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241c16c96f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241c16c88b0>]}


============================== 09:56:15.954784 | 7e8b12a0-5e99-4fdb-b01a-d0a5001c62b3 ==============================
[0m09:56:15.954784 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:56:15.957031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls -s stg_deals --output path', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:16.182892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e8b12a0-5e99-4fdb-b01a-d0a5001c62b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241c16cba90>]}
[0m09:56:16.280584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e8b12a0-5e99-4fdb-b01a-d0a5001c62b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241c35e1030>]}
[0m09:56:16.283121 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:56:16.302209 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:56:17.315063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:56:17.317121 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:56:17.320525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:56:17.328630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e8b12a0-5e99-4fdb-b01a-d0a5001c62b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241bf7d9de0>]}
[0m09:56:17.373271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e8b12a0-5e99-4fdb-b01a-d0a5001c62b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241bf7a4af0>]}
[0m09:56:17.375782 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:56:17.378252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e8b12a0-5e99-4fdb-b01a-d0a5001c62b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241bf7a4c70>]}
[0m09:56:17.381534 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.4976532, "process_user_time": 2.275105, "process_kernel_time": 0.355119, "process_mem_max_rss": "97664", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:56:17.383543 [debug] [MainThread]: Command `dbt ls` succeeded at 09:56:17.383295 after 1.50 seconds
[0m09:56:17.385221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241c2f54a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241bfa48e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7241bf7a41c0>]}
[0m09:56:17.387031 [debug] [MainThread]: Flushing usage events
[0m09:56:46.100201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfdeec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfc80a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfc809360>]}


============================== 09:56:46.107924 | 86a4153b-6559-49fa-86c3-70900d0898ef ==============================
[0m09:56:46.107924 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:56:46.110442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls -s stg_deals --output name', 'send_anonymous_usage_stats': 'True'}
[0m09:56:46.367989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86a4153b-6559-49fa-86c3-70900d0898ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfc357700>]}
[0m09:56:46.474363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86a4153b-6559-49fa-86c3-70900d0898ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfe425060>]}
[0m09:56:46.476864 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:56:46.498650 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:56:47.550011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:56:47.552501 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:56:47.555785 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:56:47.563786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86a4153b-6559-49fa-86c3-70900d0898ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfa721db0>]}
[0m09:56:47.607813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86a4153b-6559-49fa-86c3-70900d0898ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfa6eca00>]}
[0m09:56:47.609574 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:56:47.611839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86a4153b-6559-49fa-86c3-70900d0898ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfa6ecc70>]}
[0m09:56:47.615241 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.5859789, "process_user_time": 2.448337, "process_kernel_time": 0.429329, "process_mem_max_rss": "97972", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:56:47.617499 [debug] [MainThread]: Command `dbt ls` succeeded at 09:56:47.617297 after 1.59 seconds
[0m09:56:47.619310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfdeec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfe425060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9cfa6eccd0>]}
[0m09:56:47.621450 [debug] [MainThread]: Flushing usage events
[0m09:57:11.847501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438ab3e4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a9865690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a9865630>]}


============================== 09:57:11.854703 | c1680eb0-d802-4e93-85fe-1b7e8c8d75f5 ==============================
[0m09:57:11.854703 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:57:11.856819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fqn:hubspot_dbt.staging.hubspot.stg_deals', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:57:12.080277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1680eb0-d802-4e93-85fe-1b7e8c8d75f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a989f460>]}
[0m09:57:12.166911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1680eb0-d802-4e93-85fe-1b7e8c8d75f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a9c44610>]}
[0m09:57:12.169405 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:57:12.188202 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:57:13.217503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:13.219766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:13.222816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:57:13.231274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1680eb0-d802-4e93-85fe-1b7e8c8d75f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a7c55b10>]}
[0m09:57:13.277830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1680eb0-d802-4e93-85fe-1b7e8c8d75f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a7c247f0>]}
[0m09:57:13.279764 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:57:13.282178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1680eb0-d802-4e93-85fe-1b7e8c8d75f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a7c24a00>]}
[0m09:57:13.284457 [warn ] [MainThread]: The selection criterion 'fqn:hubspot_dbt.staging.hubspot.stg_deals' does not match any nodes
[0m09:57:13.287242 [info ] [MainThread]: 
[0m09:57:13.289420 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:57:13.292086 [debug] [MainThread]: Command end result
[0m09:57:13.321659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5354347, "process_user_time": 2.263481, "process_kernel_time": 0.356978, "process_mem_max_rss": "98280", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:57:13.323734 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:13.323520 after 1.54 seconds
[0m09:57:13.325449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438ab3e4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a7f14cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7438a989f460>]}
[0m09:57:13.327326 [debug] [MainThread]: Flushing usage events
[0m09:57:43.620467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd4baf8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd49f29690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd49f29630>]}


============================== 09:57:43.627251 | 18e1be3b-5d6f-4f96-9b8f-7677a0431843 ==============================
[0m09:57:43.627251 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:57:43.629442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/staging/hubspot/stg_deals.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:43.835301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18e1be3b-5d6f-4f96-9b8f-7677a0431843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd49f63460>]}
[0m09:57:43.928649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18e1be3b-5d6f-4f96-9b8f-7677a0431843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd4a504610>]}
[0m09:57:43.931108 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:57:43.949351 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:57:44.984411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:44.986307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:44.989107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:57:44.996499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18e1be3b-5d6f-4f96-9b8f-7677a0431843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd48325b10>]}
[0m09:57:45.037738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18e1be3b-5d6f-4f96-9b8f-7677a0431843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd482f87f0>]}
[0m09:57:45.039203 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:57:45.041295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18e1be3b-5d6f-4f96-9b8f-7677a0431843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd482f8a00>]}
[0m09:57:45.051912 [warn ] [MainThread]: The selection criterion 'path:models/staging/hubspot/stg_deals.sql' does not match any nodes
[0m09:57:45.054673 [info ] [MainThread]: 
[0m09:57:45.056540 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:57:45.059281 [debug] [MainThread]: Command end result
[0m09:57:45.088308 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5270661, "process_user_time": 2.17701, "process_kernel_time": 0.40257, "process_mem_max_rss": "98428", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:57:45.090573 [debug] [MainThread]: Command `dbt run` succeeded at 09:57:45.090381 after 1.53 seconds
[0m09:57:45.092099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd4baf8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd487a12a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bd49f63460>]}
[0m09:57:45.094450 [debug] [MainThread]: Flushing usage events
[0m09:58:12.487528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779142da8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779141229720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791412296c0>]}


============================== 09:58:12.494327 | 4e86a004-6c7a-4f07-877b-aaedab4e6fb3 ==============================
[0m09:58:12.494327 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:58:12.496182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select hubspot_dbt.staging.hubspot.stg_deals', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:58:12.696357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e86a004-6c7a-4f07-877b-aaedab4e6fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7791412634c0>]}
[0m09:58:12.782163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e86a004-6c7a-4f07-877b-aaedab4e6fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779143432ad0>]}
[0m09:58:12.784443 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:58:12.801105 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:58:13.679353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:13.681491 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:13.684082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:58:13.692355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e86a004-6c7a-4f07-877b-aaedab4e6fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77913f619b70>]}
[0m09:58:13.732331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e86a004-6c7a-4f07-877b-aaedab4e6fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77913f5e8880>]}
[0m09:58:13.734041 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:58:13.735990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e86a004-6c7a-4f07-877b-aaedab4e6fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77913f5e8a60>]}
[0m09:58:13.738086 [warn ] [MainThread]: The selection criterion 'hubspot_dbt.staging.hubspot.stg_deals' does not match any nodes
[0m09:58:13.740599 [info ] [MainThread]: 
[0m09:58:13.742344 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:58:13.744966 [debug] [MainThread]: Command end result
[0m09:58:13.772649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3449982, "process_user_time": 2.175295, "process_kernel_time": 0.367655, "process_mem_max_rss": "98168", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:58:13.774758 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:13.774488 after 1.35 seconds
[0m09:58:13.776593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x779142da8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77913f8d3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77913f5e8a00>]}
[0m09:58:13.778361 [debug] [MainThread]: Flushing usage events
[0m09:58:44.597002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a993428c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9932baa6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9932ba9540>]}


============================== 09:58:44.604285 | df425ce2-9e51-478d-8605-d752454e3517 ==============================
[0m09:58:44.604285 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:58:44.606454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ls --output name', 'send_anonymous_usage_stats': 'True'}
[0m09:58:44.808742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df425ce2-9e51-478d-8605-d752454e3517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9932f66950>]}
[0m09:58:44.898113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df425ce2-9e51-478d-8605-d752454e3517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a99347c5030>]}
[0m09:58:44.900761 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:58:44.917776 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:58:45.841383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:45.842995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:45.845892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:58:45.853993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df425ce2-9e51-478d-8605-d752454e3517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9930abdd50>]}
[0m09:58:45.898459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df425ce2-9e51-478d-8605-d752454e3517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9930b7ca60>]}
[0m09:58:45.900149 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:58:45.902334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df425ce2-9e51-478d-8605-d752454e3517', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9930b7cbe0>]}
[0m09:58:45.907623 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.3679395, "process_user_time": 2.167821, "process_kernel_time": 0.311916, "process_mem_max_rss": "97820", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:58:45.909863 [debug] [MainThread]: Command `dbt ls` succeeded at 09:58:45.909607 after 1.37 seconds
[0m09:58:45.911870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a993428c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9930d68610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a9930b7c070>]}
[0m09:58:45.913550 [debug] [MainThread]: Flushing usage events
[0m09:59:13.085582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c275b61c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2759a99780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2759a99720>]}


============================== 09:59:13.092853 | fd50348c-b0de-4a9a-861f-ddb4cbabf4d3 ==============================
[0m09:59:13.092853 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:59:13.094844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_ticket_contacts', 'send_anonymous_usage_stats': 'True'}
[0m09:59:13.307680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd50348c-b0de-4a9a-861f-ddb4cbabf4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2759ad74f0>]}
[0m09:59:13.395878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd50348c-b0de-4a9a-861f-ddb4cbabf4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c275bca42e0>]}
[0m09:59:13.398407 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m09:59:13.415817 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:59:14.333284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:59:14.335528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:59:14.338461 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m09:59:14.346375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd50348c-b0de-4a9a-861f-ddb4cbabf4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2757e8dba0>]}
[0m09:59:14.389914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd50348c-b0de-4a9a-861f-ddb4cbabf4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2757e5c070>]}
[0m09:59:14.391428 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:59:14.393543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd50348c-b0de-4a9a-861f-ddb4cbabf4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2757e5cb20>]}
[0m09:59:14.395764 [warn ] [MainThread]: The selection criterion 'stg_ticket_contacts' does not match any nodes
[0m09:59:14.398351 [info ] [MainThread]: 
[0m09:59:14.400011 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:59:14.402499 [debug] [MainThread]: Command end result
[0m09:59:14.429614 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.405803, "process_user_time": 2.180802, "process_kernel_time": 0.401829, "process_mem_max_rss": "97980", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m09:59:14.431781 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:14.431580 after 1.41 seconds
[0m09:59:14.433113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c275b61c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c275bca42e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c275814d660>]}
[0m09:59:14.434233 [debug] [MainThread]: Flushing usage events
[0m10:00:03.502406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce8a37c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce887a5900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce887a58a0>]}


============================== 10:00:03.509226 | d9a58a95-5665-4490-8727-46d0a183dda1 ==============================
[0m10:00:03.509226 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:00:03.511219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s tag:staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:00:03.716627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9a58a95-5665-4490-8727-46d0a183dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce887eb550>]}
[0m10:00:03.806889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9a58a95-5665-4490-8727-46d0a183dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce8a8b4340>]}
[0m10:00:03.809288 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:00:03.826336 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:00:04.683300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:00:04.685117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:00:04.687848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:00:04.695281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9a58a95-5665-4490-8727-46d0a183dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce86badc00>]}
[0m10:00:04.740731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9a58a95-5665-4490-8727-46d0a183dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce86b7c940>]}
[0m10:00:04.743127 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:00:04.745770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9a58a95-5665-4490-8727-46d0a183dda1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce86b7c850>]}
[0m10:00:04.748744 [warn ] [MainThread]: The selection criterion 'tag:staging' does not match any nodes
[0m10:00:04.751925 [info ] [MainThread]: 
[0m10:00:04.754491 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:00:04.757140 [debug] [MainThread]: Command end result
[0m10:00:04.788855 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3438874, "process_user_time": 2.257529, "process_kernel_time": 0.324739, "process_mem_max_rss": "98040", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m10:00:04.791045 [debug] [MainThread]: Command `dbt run` succeeded at 10:00:04.790842 after 1.35 seconds
[0m10:00:04.792357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce8a37c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce86e90520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72ce86b7cb20>]}
[0m10:00:04.793710 [debug] [MainThread]: Flushing usage events
[0m10:02:57.640638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a3a994610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a38e15720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a38e156c0>]}


============================== 10:02:57.647162 | 9ea35dac-cfa6-4802-81d1-ae4222cfc3cf ==============================
[0m10:02:57.647162 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:02:57.649085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select unique_id:model.hubspot_dbt.stg_deals', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:02:57.849689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ea35dac-cfa6-4802-81d1-ae4222cfc3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a38e4f4c0>]}
[0m10:02:57.946387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ea35dac-cfa6-4802-81d1-ae4222cfc3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a3b022ad0>]}
[0m10:02:57.948222 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:02:57.964451 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:02:59.380515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:02:59.382711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:02:59.385390 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:02:59.393225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ea35dac-cfa6-4802-81d1-ae4222cfc3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a37215b70>]}
[0m10:02:59.441663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ea35dac-cfa6-4802-81d1-ae4222cfc3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a371e4880>]}
[0m10:02:59.443845 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:02:59.446431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea35dac-cfa6-4802-81d1-ae4222cfc3cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a371e4a60>]}
[0m10:02:59.449028 [error] [MainThread]: Encountered an error:
Runtime Error
  'unique_id' is not a valid method name
[0m10:02:59.451632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8673728, "process_user_time": 2.269547, "process_kernel_time": 0.45544, "process_mem_max_rss": "97676", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m10:02:59.453358 [debug] [MainThread]: Command `dbt run` failed at 10:02:59.453145 after 1.87 seconds
[0m10:02:59.454920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a3a994610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a371d7bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767a371d79d0>]}
[0m10:02:59.456627 [debug] [MainThread]: Flushing usage events
[0m10:56:27.581897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79872f7dca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79872e0f9210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79872e0faf50>]}


============================== 10:56:27.594255 | a5413e1a-4df8-4687-acd4-cb66f88b9b92 ==============================
[0m10:56:27.594255 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:56:27.596358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:56:27.599838 [info ] [MainThread]: dbt version: 1.7.10
[0m10:56:27.602126 [info ] [MainThread]: python version: 3.10.7
[0m10:56:27.604267 [info ] [MainThread]: python path: /usr/local/bin/python
[0m10:56:27.606268 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m10:56:27.800118 [info ] [MainThread]: Using profiles dir at /usr/app
[0m10:56:27.802301 [info ] [MainThread]: Using profiles.yml file at /usr/app/profiles.yml
[0m10:56:27.804088 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m10:56:27.806203 [info ] [MainThread]: adapter type: postgres
[0m10:56:27.808122 [info ] [MainThread]: adapter version: 1.7.10
[0m10:56:27.905231 [info ] [MainThread]: Configuration:
[0m10:56:27.907300 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:56:27.909238 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:56:27.911002 [info ] [MainThread]: Required dependencies:
[0m10:56:27.912788 [debug] [MainThread]: Executing "git --help"
[0m10:56:27.927068 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:56:27.928819 [debug] [MainThread]: STDERR: "b''"
[0m10:56:27.931004 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:56:27.934178 [info ] [MainThread]: Connection:
[0m10:56:27.936274 [info ] [MainThread]:   host: postgres
[0m10:56:27.938614 [info ] [MainThread]:   port: 5432
[0m10:56:27.940454 [info ] [MainThread]:   user: elt
[0m10:56:27.942558 [info ] [MainThread]:   database: warehouse
[0m10:56:27.944365 [info ] [MainThread]:   schema: marts
[0m10:56:27.946714 [info ] [MainThread]:   connect_timeout: 10
[0m10:56:27.948623 [info ] [MainThread]:   role: None
[0m10:56:27.950503 [info ] [MainThread]:   search_path: None
[0m10:56:27.952684 [info ] [MainThread]:   keepalives_idle: 0
[0m10:56:27.955196 [info ] [MainThread]:   sslmode: None
[0m10:56:27.956989 [info ] [MainThread]:   sslcert: None
[0m10:56:27.959177 [info ] [MainThread]:   sslkey: None
[0m10:56:27.961369 [info ] [MainThread]:   sslrootcert: None
[0m10:56:27.963400 [info ] [MainThread]:   application_name: dbt
[0m10:56:27.965262 [info ] [MainThread]:   retries: 1
[0m10:56:27.967746 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:56:27.970474 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:56:27.972092 [debug] [MainThread]: Using postgres connection "debug"
[0m10:56:27.973717 [debug] [MainThread]: On debug: select 1 as id
[0m10:56:27.975469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:28.015117 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:56:28.018251 [debug] [MainThread]: On debug: Close
[0m10:56:28.020021 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:56:28.022160 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:56:28.024835 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.53804725, "process_user_time": 2.150544, "process_kernel_time": 0.323737, "process_mem_max_rss": "93332", "process_in_blocks": "3776", "process_out_blocks": "608"}
[0m10:56:28.027340 [debug] [MainThread]: Command `dbt debug` succeeded at 10:56:28.027115 after 0.54 seconds
[0m10:56:28.028930 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:56:28.030546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79872f7dca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79872e5969e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79872e1ebdf0>]}
[0m10:56:28.031957 [debug] [MainThread]: Flushing usage events
[0m10:56:41.783202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3f4ab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3fbeb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3fbea140>]}


============================== 10:56:41.788576 | aa8378df-bab7-4864-844c-75d3dbd00451 ==============================
[0m10:56:41.788576 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:56:41.791404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt ls -s stg_deals', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:56:42.038300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa8378df-bab7-4864-844c-75d3dbd00451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3c18a6b0>]}
[0m10:56:42.128012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa8378df-bab7-4864-844c-75d3dbd00451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3d8d0b80>]}
[0m10:56:42.130185 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:56:42.147511 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:56:42.154576 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:56:42.156815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa8378df-bab7-4864-844c-75d3dbd00451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3c0fd9f0>]}
[0m10:56:44.210398 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:56:44.217818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa8378df-bab7-4864-844c-75d3dbd00451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f39b280d0>]}
[0m10:56:44.266832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa8378df-bab7-4864-844c-75d3dbd00451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3c0fd120>]}
[0m10:56:44.268794 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:56:44.271199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa8378df-bab7-4864-844c-75d3dbd00451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3c0ffac0>]}
[0m10:56:44.276055 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 2.5669823, "process_user_time": 3.215577, "process_kernel_time": 0.446499, "process_mem_max_rss": "102704", "process_in_blocks": "2768", "process_out_blocks": "0"}
[0m10:56:44.278355 [debug] [MainThread]: Command `dbt ls` succeeded at 10:56:44.278134 after 2.57 seconds
[0m10:56:44.280280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3f4ab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3c0ffac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d3f3c0fd9f0>]}
[0m10:56:44.281807 [debug] [MainThread]: Flushing usage events
[0m10:57:03.264251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf83b533a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf84296cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf842950f0>]}


============================== 10:57:03.268199 | 0facf4e1-b51e-4be4-876e-b3c303fcc1ab ==============================
[0m10:57:03.268199 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:57:03.270349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_deals', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:57:03.500319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0facf4e1-b51e-4be4-876e-b3c303fcc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf8077d1e0>]}
[0m10:57:03.597555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0facf4e1-b51e-4be4-876e-b3c303fcc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf8072d180>]}
[0m10:57:03.601759 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:57:03.627111 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:57:04.615173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:04.617200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:04.620127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:57:04.628384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0facf4e1-b51e-4be4-876e-b3c303fcc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf803c1900>]}
[0m10:57:04.671016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0facf4e1-b51e-4be4-876e-b3c303fcc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf80390550>]}
[0m10:57:04.672796 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:57:04.674629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0facf4e1-b51e-4be4-876e-b3c303fcc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf803908b0>]}
[0m10:57:04.677548 [info ] [MainThread]: 
[0m10:57:04.679887 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:04.682901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m10:57:04.696211 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m10:57:04.700464 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:57:04.701876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:04.742302 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.0 seconds
[0m10:57:04.744771 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:57:04.747601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now create_warehouse_marts_staging)
[0m10:57:04.750158 [debug] [ThreadPool]: Creating schema "database: "warehouse"
schema: "marts_staging"
"
[0m10:57:04.756897 [debug] [ThreadPool]: Using postgres connection "create_warehouse_marts_staging"
[0m10:57:04.758700 [debug] [ThreadPool]: On create_warehouse_marts_staging: BEGIN
[0m10:57:04.760322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:04.782796 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:04.784589 [debug] [ThreadPool]: Using postgres connection "create_warehouse_marts_staging"
[0m10:57:04.786201 [debug] [ThreadPool]: On create_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "create_warehouse_marts_staging"} */
create schema if not exists "marts_staging"
[0m10:57:04.797182 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m10:57:04.799751 [debug] [ThreadPool]: On create_warehouse_marts_staging: COMMIT
[0m10:57:04.801256 [debug] [ThreadPool]: Using postgres connection "create_warehouse_marts_staging"
[0m10:57:04.802850 [debug] [ThreadPool]: On create_warehouse_marts_staging: COMMIT
[0m10:57:04.807646 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m10:57:04.809397 [debug] [ThreadPool]: On create_warehouse_marts_staging: Close
[0m10:57:04.815126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_warehouse_marts_staging, now list_warehouse_marts_kpi)
[0m10:57:04.817343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m10:57:04.818796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m10:57:04.820706 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m10:57:04.829465 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m10:57:04.833150 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m10:57:04.837241 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m10:57:04.841008 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m10:57:04.843349 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m10:57:04.844982 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m10:57:04.846926 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m10:57:04.848295 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m10:57:04.850048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:04.851651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:04.853107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:04.854363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:04.867465 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:04.869408 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m10:57:04.870018 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:04.870599 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:04.871504 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m10:57:04.873293 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m10:57:04.874813 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m10:57:04.876576 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:04.878097 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m10:57:04.879779 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m10:57:04.881328 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m10:57:04.885716 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m10:57:04.902601 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:57:04.903204 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:57:04.903730 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:57:04.904244 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:57:04.906448 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m10:57:04.908911 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m10:57:04.911137 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m10:57:04.913392 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m10:57:04.915152 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m10:57:04.916695 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m10:57:04.917854 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m10:57:04.919593 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m10:57:04.932331 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:04.934080 [debug] [MainThread]: On master: BEGIN
[0m10:57:04.935673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:04.946827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:04.948582 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:04.950310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:04.993434 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:57:04.996642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0facf4e1-b51e-4be4-876e-b3c303fcc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf80400d00>]}
[0m10:57:04.998377 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:05.000332 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.002051 [debug] [MainThread]: On master: BEGIN
[0m10:57:05.004167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:05.005990 [debug] [MainThread]: On master: COMMIT
[0m10:57:05.007679 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.009101 [debug] [MainThread]: On master: COMMIT
[0m10:57:05.010849 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:05.012325 [debug] [MainThread]: On master: Close
[0m10:57:05.014348 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:57:05.016275 [info ] [MainThread]: 
[0m10:57:05.027006 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deals
[0m10:57:05.029229 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deals ............................ [RUN]
[0m10:57:05.032014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_deals)
[0m10:57:05.033627 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deals
[0m10:57:05.042266 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deals"
[0m10:57:05.075614 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (compile): 10:57:05.035140 => 10:57:05.075220
[0m10:57:05.077327 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deals
[0m10:57:05.111845 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deals"
[0m10:57:05.139613 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m10:57:05.140999 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: BEGIN
[0m10:57:05.142519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:05.154951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:57:05.157172 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m10:57:05.158905 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */

  create view "warehouse"."marts_staging"."stg_deals__dbt_tmp"
    
    
  as (
    with src as (
    select
      (_airbyte_data)::jsonb as j,
      _airbyte_emitted_at,
      _airbyte_extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_deals
  ),

  base as (
    select
      (j->>'id')::bigint                                         as deal_id,
      (j->>'createdAt')::timestamptz                             as created_at,
      (j->>'updatedAt')::timestamptz                             as updated_at,

      /* propriétés hubspot */
      (j->'properties'->>'dealname')                             as deal_name,
      (j->'properties'->>'pipeline')                             as pipeline_id,
      (j->'properties'->>'dealstage')                            as deal_stage_id,
      nullif(j->'properties'->>'dealtype','')                    as deal_type,
      (j->'properties'->>'deal_currency_code')                   as currency,

      /* ownership / relations */
      nullif(j->'properties'->>'hubspot_owner_id','')::bigint    as owner_id,
      nullif(j->'properties'->>'hs_primary_associated_company','')::bigint as primary_company_id,

      /* montants */
      nullif(j->'properties'->>'hs_acv','')::numeric             as hs_acv,
      nullif(j->'properties'->>'hs_tcv','')::numeric             as hs_tcv,
      nullif(j->'properties'->>'amount_in_home_currency','')::numeric as amount_in_home_currency,
      nullif(j->'properties'->>'hs_closed_amount','')::numeric   as hs_closed_amount,
      nullif(j->'properties'->>'hs_closed_amount_in_home_currency','')::numeric as hs_closed_amount_in_home_currency,

      /* états */
      coalesce((j->'properties'->>'hs_is_closed')::boolean, false)       as is_closed,
      coalesce((j->'properties'->>'hs_is_closed_won')::boolean, false)   as is_won,
      coalesce((j->'properties'->>'hs_is_closed_lost')::boolean, false)  as is_lost,

      /* probabilités / analytics */
      nullif(j->'properties'->>'hs_deal_stage_probability','')::numeric  as stage_probability,
      nullif(j->'properties'->>'hs_deal_stage_probability_shadow','')::numeric as stage_probability_shadow,
      (j->'properties'->>'hs_analytics_latest_source')                   as analytics_latest_source,
      nullif(j->'properties'->>'hs_analytics_latest_source_timestamp','')::timestamptz as analytics_latest_source_ts,
      nullif(j->'properties'->>'hs_analytics_source_data_1','')          as analytics_source_data_1,

      /* dates clés */
      nullif(j->'properties'->>'createdate','')::timestamptz             as createdate,
      nullif(j->'properties'->>'closedate','')::timestamptz              as closedate,
      nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz    as lastmodifieddate,
      nullif(j->'properties'->>'hubspot_owner_assigneddate','')::timestamptz as owner_assigned_at,

      /* aide pour ponts */
      j->'companies'                                             as companies_json,
      j->'line_items'                                            as line_items_json
    from src
  )

  select * from base;
  );
[0m10:57:05.163319 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 63:   select * from base;
                             ^

[0m10:57:05.165210 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: ROLLBACK
[0m10:57:05.167446 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (execute): 10:57:05.079007 => 10:57:05.167117
[0m10:57:05.169251 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: Close
[0m10:57:05.181300 [debug] [Thread-1 (]: Database Error in model stg_deals (models/staging/hubspot/stg_deals.sql)
  syntax error at or near ";"
  LINE 63:   select * from base;
                               ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deals.sql
[0m10:57:05.183189 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0facf4e1-b51e-4be4-876e-b3c303fcc1ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf803fac20>]}
[0m10:57:05.185348 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_deals ................... [[31mERROR[0m in 0.15s]
[0m10:57:05.187949 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deals
[0m10:57:05.191761 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.193276 [debug] [MainThread]: On master: BEGIN
[0m10:57:05.194753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:05.202893 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:05.204667 [debug] [MainThread]: On master: COMMIT
[0m10:57:05.206206 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:05.208005 [debug] [MainThread]: On master: COMMIT
[0m10:57:05.210010 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:05.211999 [debug] [MainThread]: On master: Close
[0m10:57:05.214659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:05.216749 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m10:57:05.218382 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deals' was properly closed.
[0m10:57:05.219840 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m10:57:05.221315 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m10:57:05.223123 [info ] [MainThread]: 
[0m10:57:05.224806 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m10:57:05.226965 [debug] [MainThread]: Command end result
[0m10:57:05.262460 [info ] [MainThread]: 
[0m10:57:05.265311 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:57:05.267875 [info ] [MainThread]: 
[0m10:57:05.270648 [error] [MainThread]:   Database Error in model stg_deals (models/staging/hubspot/stg_deals.sql)
  syntax error at or near ";"
  LINE 63:   select * from base;
                               ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deals.sql
[0m10:57:05.273020 [info ] [MainThread]: 
[0m10:57:05.274853 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:57:05.278942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0744867, "process_user_time": 2.390364, "process_kernel_time": 0.530755, "process_mem_max_rss": "103704", "process_in_blocks": "3296", "process_out_blocks": "56", "command_success": false}
[0m10:57:05.281502 [debug] [MainThread]: Command `dbt run` failed at 10:57:05.281273 after 2.08 seconds
[0m10:57:05.283481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf83b533a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf8037f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77bf8037e9e0>]}
[0m10:57:05.285300 [debug] [MainThread]: Flushing usage events
[0m10:59:57.330072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb4a57430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb2e79570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb2e7acb0>]}


============================== 10:59:57.333629 | e1985f91-e181-4176-8e72-68ecda6081c8 ==============================
[0m10:59:57.333629 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:59:57.335318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_deals', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:59:57.540465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1985f91-e181-4176-8e72-68ecda6081c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb2e7bb50>]}
[0m10:59:57.169425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1985f91-e181-4176-8e72-68ecda6081c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb15bf490>]}
[0m10:59:57.172216 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:59:57.191061 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:59:57.668282 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:59:57.670294 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_deals.sql
[0m10:59:57.834125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m10:59:57.842042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1985f91-e181-4176-8e72-68ecda6081c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb12480d0>]}
[0m10:59:57.890010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1985f91-e181-4176-8e72-68ecda6081c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb12d86a0>]}
[0m10:59:57.891767 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:59:57.893528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1985f91-e181-4176-8e72-68ecda6081c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb12d8880>]}
[0m10:59:57.896359 [info ] [MainThread]: 
[0m10:59:57.898743 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:57.901526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m10:59:57.914269 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m10:59:57.915895 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:59:57.917124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:57.935529 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m10:59:57.938025 [debug] [ThreadPool]: On list_warehouse: Close
[0m10:59:57.943360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m10:59:57.945106 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m10:59:57.946895 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m10:59:57.949192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m10:59:57.954788 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m10:59:57.957922 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m10:59:57.962518 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m10:59:57.966480 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m10:59:57.968617 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m10:59:57.970284 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m10:59:57.971941 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m10:59:57.973400 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m10:59:57.975160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:57.976576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:57.978276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:57.979978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:57.989866 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:59:57.991072 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:59:57.992360 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m10:59:57.993625 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:59:57.994678 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m10:59:57.995207 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:59:57.996460 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m10:59:57.998207 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m10:59:57.999924 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m10:59:58.001576 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m10:59:58.004529 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m10:59:58.009466 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:59:58.010295 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:59:58.011954 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m10:59:58.016271 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m10:59:58.017437 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:59:58.019775 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m10:59:58.023393 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m10:59:58.025622 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m10:59:58.026282 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:59:58.028030 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m10:59:58.031463 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m10:59:58.033457 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m10:59:58.040661 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m10:59:58.094872 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:58.096809 [debug] [MainThread]: On master: BEGIN
[0m10:59:58.098606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:58.108085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:58.109784 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:58.111311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:58.144814 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:59:58.147661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1985f91-e181-4176-8e72-68ecda6081c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb123d2a0>]}
[0m10:59:58.149491 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:58.151597 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:58.153230 [debug] [MainThread]: On master: BEGIN
[0m10:59:58.155776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:58.157500 [debug] [MainThread]: On master: COMMIT
[0m10:59:58.159306 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:58.160837 [debug] [MainThread]: On master: COMMIT
[0m10:59:58.163041 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:59:58.164647 [debug] [MainThread]: On master: Close
[0m10:59:58.166915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:59:58.168908 [info ] [MainThread]: 
[0m10:59:58.174486 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deals
[0m10:59:58.176171 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deals ............................ [RUN]
[0m10:59:58.178283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_deals)
[0m10:59:58.180011 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deals
[0m10:59:58.188857 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deals"
[0m10:59:58.200504 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (compile): 10:59:58.181553 => 10:59:58.200130
[0m10:59:58.202269 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deals
[0m10:59:58.236689 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deals"
[0m10:59:58.249330 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m10:59:58.251156 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: BEGIN
[0m10:59:58.252759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:58.262749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:59:58.264752 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m10:59:58.266427 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */

  create view "warehouse"."marts_staging"."stg_deals__dbt_tmp"
    
    
  as (
    with src as (
    select
      (_airbyte_data)::jsonb as j,
      _airbyte_emitted_at,
      _airbyte_extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_deals
  ),

  base as (
    select
      (j->>'id')::bigint                                         as deal_id,
      (j->>'createdAt')::timestamptz                             as created_at,
      (j->>'updatedAt')::timestamptz                             as updated_at,

      /* propriétés hubspot */
      (j->'properties'->>'dealname')                             as deal_name,
      (j->'properties'->>'pipeline')                             as pipeline_id,
      (j->'properties'->>'dealstage')                            as deal_stage_id,
      nullif(j->'properties'->>'dealtype','')                    as deal_type,
      (j->'properties'->>'deal_currency_code')                   as currency,

      /* ownership / relations */
      nullif(j->'properties'->>'hubspot_owner_id','')::bigint    as owner_id,
      nullif(j->'properties'->>'hs_primary_associated_company','')::bigint as primary_company_id,

      /* montants */
      nullif(j->'properties'->>'hs_acv','')::numeric             as hs_acv,
      nullif(j->'properties'->>'hs_tcv','')::numeric             as hs_tcv,
      nullif(j->'properties'->>'amount_in_home_currency','')::numeric as amount_in_home_currency,
      nullif(j->'properties'->>'hs_closed_amount','')::numeric   as hs_closed_amount,
      nullif(j->'properties'->>'hs_closed_amount_in_home_currency','')::numeric as hs_closed_amount_in_home_currency,

      /* états */
      coalesce((j->'properties'->>'hs_is_closed')::boolean, false)       as is_closed,
      coalesce((j->'properties'->>'hs_is_closed_won')::boolean, false)   as is_won,
      coalesce((j->'properties'->>'hs_is_closed_lost')::boolean, false)  as is_lost,

      /* probabilités / analytics */
      nullif(j->'properties'->>'hs_deal_stage_probability','')::numeric  as stage_probability,
      nullif(j->'properties'->>'hs_deal_stage_probability_shadow','')::numeric as stage_probability_shadow,
      (j->'properties'->>'hs_analytics_latest_source')                   as analytics_latest_source,
      nullif(j->'properties'->>'hs_analytics_latest_source_timestamp','')::timestamptz as analytics_latest_source_ts,
      nullif(j->'properties'->>'hs_analytics_source_data_1','')          as analytics_source_data_1,

      /* dates clés */
      nullif(j->'properties'->>'createdate','')::timestamptz             as createdate,
      nullif(j->'properties'->>'closedate','')::timestamptz              as closedate,
      nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz    as lastmodifieddate,
      nullif(j->'properties'->>'hubspot_owner_assigneddate','')::timestamptz as owner_assigned_at,

      /* aide pour ponts */
      j->'companies'                                             as companies_json,
      j->'line_items'                                            as line_items_json
    from src
  )

  select * from base
  );
[0m10:59:58.289047 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "_airbyte_emitted_at" does not exist
LINE 10:       _airbyte_emitted_at,
               ^

[0m10:59:58.291042 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: ROLLBACK
[0m10:59:58.293265 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (execute): 10:59:58.203681 => 10:59:58.292931
[0m10:59:58.295021 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: Close
[0m10:59:58.299701 [debug] [Thread-1 (]: Database Error in model stg_deals (models/staging/hubspot/stg_deals.sql)
  column "_airbyte_emitted_at" does not exist
  LINE 10:       _airbyte_emitted_at,
                 ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deals.sql
[0m10:59:58.301627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1985f91-e181-4176-8e72-68ecda6081c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb123f5b0>]}
[0m10:59:58.303739 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_deals ................... [[31mERROR[0m in 0.12s]
[0m10:59:58.306160 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deals
[0m10:59:58.309984 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:58.311877 [debug] [MainThread]: On master: BEGIN
[0m10:59:58.313398 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:58.323088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:58.324720 [debug] [MainThread]: On master: COMMIT
[0m10:59:58.325915 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:58.328102 [debug] [MainThread]: On master: COMMIT
[0m10:59:58.329940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:59:58.331377 [debug] [MainThread]: On master: Close
[0m10:59:58.332939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:58.334805 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m10:59:58.336369 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m10:59:58.337837 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m10:59:58.339261 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deals' was properly closed.
[0m10:59:58.340855 [info ] [MainThread]: 
[0m10:59:58.342583 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m10:59:58.345133 [debug] [MainThread]: Command end result
[0m10:59:58.375260 [info ] [MainThread]: 
[0m10:59:58.377710 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:59:58.380101 [info ] [MainThread]: 
[0m10:59:58.382094 [error] [MainThread]:   Database Error in model stg_deals (models/staging/hubspot/stg_deals.sql)
  column "_airbyte_emitted_at" does not exist
  LINE 10:       _airbyte_emitted_at,
                 ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deals.sql
[0m10:59:58.384093 [info ] [MainThread]: 
[0m10:59:58.386570 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:59:58.389208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0449958, "process_user_time": 2.439305, "process_kernel_time": 0.384111, "process_mem_max_rss": "105988", "process_in_blocks": "1864", "command_success": false, "process_out_blocks": "0"}
[0m10:59:58.391001 [debug] [MainThread]: Command `dbt run` failed at 10:59:58.390794 after 2.05 seconds
[0m10:59:58.392555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb4a57430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb177ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bfcb12447f0>]}
[0m10:59:58.394194 [debug] [MainThread]: Flushing usage events
[0m12:22:19.505726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f904cf400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8e8f2ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8e8f2cb0>]}


============================== 12:22:19.513655 | 213e89e6-a8e6-41bb-9054-865c4c7b58cf ==============================
[0m12:22:19.513655 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:22:19.515997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_deals', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:19.795489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '213e89e6-a8e6-41bb-9054-865c4c7b58cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8e8f3b50>]}
[0m12:22:19.892458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '213e89e6-a8e6-41bb-9054-865c4c7b58cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f90c17490>]}
[0m12:22:19.894828 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:22:19.914476 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:22:20.921391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:20.923180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:20.925921 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:22:20.935038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '213e89e6-a8e6-41bb-9054-865c4c7b58cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8cd81960>]}
[0m12:22:20.985303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '213e89e6-a8e6-41bb-9054-865c4c7b58cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8cd50670>]}
[0m12:22:20.987552 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:22:20.990003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213e89e6-a8e6-41bb-9054-865c4c7b58cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8cd50850>]}
[0m12:22:20.993532 [info ] [MainThread]: 
[0m12:22:20.996316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:22:20.999649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m12:22:21.030934 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m12:22:21.034835 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m12:22:21.038537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:21.101961 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m12:22:21.105333 [debug] [ThreadPool]: On list_warehouse: Close
[0m12:22:21.112294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m12:22:21.114831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m12:22:21.117204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m12:22:21.119903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m12:22:21.126398 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m12:22:21.131169 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m12:22:21.134612 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m12:22:21.138446 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m12:22:21.140147 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m12:22:21.141852 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m12:22:21.143443 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m12:22:21.145151 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m12:22:21.147604 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:21.150749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:21.153498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:21.156592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:21.178336 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:21.194540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:21.199636 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:21.206479 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m12:22:21.214495 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m12:22:21.220307 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m12:22:21.223252 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:21.226343 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m12:22:21.230587 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m12:22:21.235872 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:22:21.243279 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m12:22:21.269656 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:22:21.288779 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:21.290038 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:21.291411 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:21.298160 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m12:22:21.304747 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m12:22:21.305957 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:21.312564 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m12:22:21.317138 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m12:22:21.322967 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m12:22:21.331903 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m12:22:21.336600 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m12:22:21.349085 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m12:22:21.372493 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:21.376303 [debug] [MainThread]: On master: BEGIN
[0m12:22:21.379353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:21.402932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:21.405724 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:21.408686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:22:21.466831 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:21.469712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213e89e6-a8e6-41bb-9054-865c4c7b58cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8cdbe5f0>]}
[0m12:22:21.471961 [debug] [MainThread]: On master: ROLLBACK
[0m12:22:21.474687 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:21.476613 [debug] [MainThread]: On master: BEGIN
[0m12:22:21.478985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:21.480970 [debug] [MainThread]: On master: COMMIT
[0m12:22:21.482973 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:21.484610 [debug] [MainThread]: On master: COMMIT
[0m12:22:21.486707 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:22:21.488661 [debug] [MainThread]: On master: Close
[0m12:22:21.491292 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:22:21.495552 [info ] [MainThread]: 
[0m12:22:21.505584 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deals
[0m12:22:21.508458 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deals ............................ [RUN]
[0m12:22:21.513279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_deals)
[0m12:22:21.518032 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deals
[0m12:22:21.537433 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deals"
[0m12:22:21.565193 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (compile): 12:22:21.521153 => 12:22:21.564205
[0m12:22:21.567921 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deals
[0m12:22:21.632824 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deals"
[0m12:22:21.647842 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m12:22:21.650626 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: BEGIN
[0m12:22:21.652816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:21.665284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:22:21.667301 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m12:22:21.669004 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */

  create view "warehouse"."marts_staging"."stg_deals__dbt_tmp"
    
    
  as (
    with src as (
    select
      (_airbyte_data)::jsonb as j,
      _airbyte_emitted_at,
      _airbyte_extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_deals
  ),

  base as (
    select
      (j->>'id')::bigint                                         as deal_id,
      (j->>'createdAt')::timestamptz                             as created_at,
      (j->>'updatedAt')::timestamptz                             as updated_at,

      /* propriétés hubspot */
      (j->'properties'->>'dealname')                             as deal_name,
      (j->'properties'->>'pipeline')                             as pipeline_id,
      (j->'properties'->>'dealstage')                            as deal_stage_id,
      nullif(j->'properties'->>'dealtype','')                    as deal_type,
      (j->'properties'->>'deal_currency_code')                   as currency,

      /* ownership / relations */
      nullif(j->'properties'->>'hubspot_owner_id','')::bigint    as owner_id,
      nullif(j->'properties'->>'hs_primary_associated_company','')::bigint as primary_company_id,

      /* montants */
      nullif(j->'properties'->>'hs_acv','')::numeric             as hs_acv,
      nullif(j->'properties'->>'hs_tcv','')::numeric             as hs_tcv,
      nullif(j->'properties'->>'amount_in_home_currency','')::numeric as amount_in_home_currency,
      nullif(j->'properties'->>'hs_closed_amount','')::numeric   as hs_closed_amount,
      nullif(j->'properties'->>'hs_closed_amount_in_home_currency','')::numeric as hs_closed_amount_in_home_currency,

      /* états */
      coalesce((j->'properties'->>'hs_is_closed')::boolean, false)       as is_closed,
      coalesce((j->'properties'->>'hs_is_closed_won')::boolean, false)   as is_won,
      coalesce((j->'properties'->>'hs_is_closed_lost')::boolean, false)  as is_lost,

      /* probabilités / analytics */
      nullif(j->'properties'->>'hs_deal_stage_probability','')::numeric  as stage_probability,
      nullif(j->'properties'->>'hs_deal_stage_probability_shadow','')::numeric as stage_probability_shadow,
      (j->'properties'->>'hs_analytics_latest_source')                   as analytics_latest_source,
      nullif(j->'properties'->>'hs_analytics_latest_source_timestamp','')::timestamptz as analytics_latest_source_ts,
      nullif(j->'properties'->>'hs_analytics_source_data_1','')          as analytics_source_data_1,

      /* dates clés */
      nullif(j->'properties'->>'createdate','')::timestamptz             as createdate,
      nullif(j->'properties'->>'closedate','')::timestamptz              as closedate,
      nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz    as lastmodifieddate,
      nullif(j->'properties'->>'hubspot_owner_assigneddate','')::timestamptz as owner_assigned_at,

      /* aide pour ponts */
      j->'companies'                                             as companies_json,
      j->'line_items'                                            as line_items_json
    from src
  )

  select * from base
  );
[0m12:22:21.673879 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "_airbyte_emitted_at" does not exist
LINE 10:       _airbyte_emitted_at,
               ^

[0m12:22:21.675777 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: ROLLBACK
[0m12:22:21.678046 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (execute): 12:22:21.570002 => 12:22:21.677524
[0m12:22:21.680383 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: Close
[0m12:22:21.687755 [debug] [Thread-1 (]: Database Error in model stg_deals (models/staging/hubspot/stg_deals.sql)
  column "_airbyte_emitted_at" does not exist
  LINE 10:       _airbyte_emitted_at,
                 ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deals.sql
[0m12:22:21.689830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213e89e6-a8e6-41bb-9054-865c4c7b58cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8cd3fac0>]}
[0m12:22:21.691997 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_deals ................... [[31mERROR[0m in 0.18s]
[0m12:22:21.694551 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deals
[0m12:22:21.699255 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:21.700734 [debug] [MainThread]: On master: BEGIN
[0m12:22:21.702049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:21.713568 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:21.715299 [debug] [MainThread]: On master: COMMIT
[0m12:22:21.716768 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:21.718252 [debug] [MainThread]: On master: COMMIT
[0m12:22:21.720236 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:22:21.721908 [debug] [MainThread]: On master: Close
[0m12:22:21.724456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:21.728517 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m12:22:21.729873 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deals' was properly closed.
[0m12:22:21.731580 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m12:22:21.733033 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m12:22:21.736302 [info ] [MainThread]: 
[0m12:22:21.738813 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:22:21.741482 [debug] [MainThread]: Command end result
[0m12:22:21.781212 [info ] [MainThread]: 
[0m12:22:21.783744 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:22:21.785902 [info ] [MainThread]: 
[0m12:22:21.788351 [error] [MainThread]:   Database Error in model stg_deals (models/staging/hubspot/stg_deals.sql)
  column "_airbyte_emitted_at" does not exist
  LINE 10:       _airbyte_emitted_at,
                 ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deals.sql
[0m12:22:21.790577 [info ] [MainThread]: 
[0m12:22:21.792748 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:22:21.797533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3772266, "process_user_time": 2.641926, "process_kernel_time": 1.013669, "process_mem_max_rss": "102628", "process_in_blocks": "53352", "command_success": false, "process_out_blocks": "0"}
[0m12:22:21.799552 [debug] [MainThread]: Command `dbt run` failed at 12:22:21.799349 after 2.38 seconds
[0m12:22:21.801379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f904cf400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f90c17490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719f8cc23130>]}
[0m12:22:21.802958 [debug] [MainThread]: Flushing usage events
[0m12:22:55.997195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783d7cf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783bbf1c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783bbf2cb0>]}


============================== 12:22:56.001098 | 71a15cb9-5305-48d0-b560-2ae1945150ef ==============================
[0m12:22:56.001098 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:22:56.003329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_deals', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:22:56.220801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71a15cb9-5305-48d0-b560-2ae1945150ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783bbf3b50>]}
[0m12:22:56.309743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71a15cb9-5305-48d0-b560-2ae1945150ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783df1b4f0>]}
[0m12:22:56.312039 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:22:56.328117 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:22:57.161233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:57.163615 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_deals.sql
[0m12:22:57.309656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:22:57.317090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71a15cb9-5305-48d0-b560-2ae1945150ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707839fbc0d0>]}
[0m12:22:57.357143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71a15cb9-5305-48d0-b560-2ae1945150ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783a050670>]}
[0m12:22:57.358770 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:22:57.360832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71a15cb9-5305-48d0-b560-2ae1945150ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783a0508b0>]}
[0m12:22:57.363558 [info ] [MainThread]: 
[0m12:22:57.366100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:22:57.369297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m12:22:57.381921 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m12:22:57.383462 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m12:22:57.384947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:57.398450 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m12:22:57.401461 [debug] [ThreadPool]: On list_warehouse: Close
[0m12:22:57.407035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m12:22:57.408591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m12:22:57.410868 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m12:22:57.412305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m12:22:57.418898 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m12:22:57.422318 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m12:22:57.426493 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m12:22:57.429951 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m12:22:57.432275 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m12:22:57.433898 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m12:22:57.435558 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m12:22:57.437026 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m12:22:57.438545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:57.440079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:57.441510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:57.442757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:57.453028 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:57.454555 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:57.454979 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m12:22:57.455933 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:57.457132 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:22:57.457557 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m12:22:57.458931 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m12:22:57.460405 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m12:22:57.461762 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m12:22:57.463021 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m12:22:57.465634 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m12:22:57.467299 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m12:22:57.469516 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:57.473366 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m12:22:57.473797 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:57.474812 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:57.476015 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:57.476469 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m12:22:57.478286 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m12:22:57.480653 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m12:22:57.482936 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m12:22:57.486242 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m12:22:57.487408 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m12:22:57.489074 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m12:22:57.499667 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:57.501787 [debug] [MainThread]: On master: BEGIN
[0m12:22:57.503549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:57.513821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:57.515903 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:57.517708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:22:57.549571 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:22:57.552631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71a15cb9-5305-48d0-b560-2ae1945150ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707833d1df60>]}
[0m12:22:57.554515 [debug] [MainThread]: On master: ROLLBACK
[0m12:22:57.556639 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:57.558472 [debug] [MainThread]: On master: BEGIN
[0m12:22:57.560386 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:57.562007 [debug] [MainThread]: On master: COMMIT
[0m12:22:57.563429 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:57.564939 [debug] [MainThread]: On master: COMMIT
[0m12:22:57.566807 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:22:57.568334 [debug] [MainThread]: On master: Close
[0m12:22:57.570435 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:22:57.572503 [info ] [MainThread]: 
[0m12:22:57.624254 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deals
[0m12:22:57.626291 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deals ............................ [RUN]
[0m12:22:57.628346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_deals)
[0m12:22:57.630082 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deals
[0m12:22:57.638662 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deals"
[0m12:22:57.651271 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (compile): 12:22:57.631480 => 12:22:57.650855
[0m12:22:57.653199 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deals
[0m12:22:57.686252 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deals"
[0m12:22:57.698538 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m12:22:57.700426 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: BEGIN
[0m12:22:57.702200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:57.711665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:22:57.713820 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m12:22:57.715490 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */

  create view "warehouse"."marts_staging"."stg_deals__dbt_tmp"
    
    
  as (
    -- models/staging/hubspot/stg_deals.sql

with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_deals
),

base as (
    select
        -- Identifiants & métadonnées
        (j->>'id')::bigint                              as deal_id,
        (j->>'createdAt')::timestamptz                  as created_at_raw,
        (j->>'updatedAt')::timestamptz                  as updated_at_raw,
        _airbyte_extracted_at                           as extracted_at,

        -- Propriétés principales HubSpot
        (j->'properties'->>'dealname')                  as deal_name,
        (j->'properties'->>'pipeline')                  as pipeline_id,
        (j->'properties'->>'dealstage')                 as deal_stage_id,
        nullif(j->'properties'->>'dealtype','')         as deal_type,
        (j->'properties'->>'deal_currency_code')        as currency,

        -- Ownership / relations
        nullif(j->'properties'->>'hubspot_owner_id','')::bigint
                                                        as owner_id,
        nullif(j->'properties'->>'hs_primary_associated_company','')::bigint
                                                        as primary_company_id,

        -- Montants
        nullif(j->'properties'->>'hs_acv','')::numeric  as hs_acv,
        nullif(j->'properties'->>'hs_tcv','')::numeric  as hs_tcv,
        nullif(j->'properties'->>'amount_in_home_currency','')::numeric
                                                        as amount_in_home_currency,
        nullif(j->'properties'->>'hs_closed_amount','')::numeric
                                                        as hs_closed_amount,
        nullif(j->'properties'->>'hs_closed_amount_in_home_currency','')::numeric
                                                        as hs_closed_amount_in_home_currency,

        -- États du deal
        coalesce((j->'properties'->>'hs_is_closed')::boolean, false)
                                                        as is_closed,
        coalesce((j->'properties'->>'hs_is_closed_won')::boolean, false)
                                                        as is_won,
        coalesce((j->'properties'->>'hs_is_closed_lost')::boolean, false)
                                                        as is_lost,

        -- Probabilités & analytics
        nullif(j->'properties'->>'hs_deal_stage_probability','')::numeric
                                                        as stage_probability,
        nullif(j->'properties'->>'hs_deal_stage_probability_shadow','')::numeric
                                                        as stage_probability_shadow,
        (j->'properties'->>'hs_analytics_latest_source')
                                                        as analytics_latest_source,
        nullif(j->'properties'->>'hs_analytics_latest_source_timestamp','')::timestamptz
                                                        as analytics_latest_source_ts,
        nullif(j->'properties'->>'hs_analytics_source_data_1','')
                                                        as analytics_source_data_1,

        -- Dates clés métier
        nullif(j->'properties'->>'createdate','')::timestamptz
                                                        as createdate,
        nullif(j->'properties'->>'closedate','')::timestamptz
                                                        as closedate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz
                                                        as lastmodifieddate,
        nullif(j->'properties'->>'hubspot_owner_assigneddate','')::timestamptz
                                                        as owner_assigned_at,

        -- Aide pour les ponts (associations)
        j->'companies'                                   as companies_json,
        j->'line_items'                                  as line_items_json
    from src
)

select *
from base
  );
[0m12:22:57.743847 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:22:57.750876 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m12:22:57.752939 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */
alter table "warehouse"."marts_staging"."stg_deals__dbt_tmp" rename to "stg_deals"
[0m12:22:57.756053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:22:57.771087 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: COMMIT
[0m12:22:57.772847 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m12:22:57.774437 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: COMMIT
[0m12:22:57.780289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:22:57.788182 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_deals__dbt_backup"
[0m12:22:57.794569 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m12:22:57.796798 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */
drop view if exists "warehouse"."marts_staging"."stg_deals__dbt_backup" cascade
[0m12:22:57.800230 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:22:57.803265 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (execute): 12:22:57.654707 => 12:22:57.803059
[0m12:22:57.804928 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: Close
[0m12:22:57.807163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71a15cb9-5305-48d0-b560-2ae1945150ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707839fbf6a0>]}
[0m12:22:57.809075 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_deals ....................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:22:57.811279 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deals
[0m12:22:57.814934 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:57.816646 [debug] [MainThread]: On master: BEGIN
[0m12:22:57.818206 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:57.827611 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:22:57.829113 [debug] [MainThread]: On master: COMMIT
[0m12:22:57.830505 [debug] [MainThread]: Using postgres connection "master"
[0m12:22:57.832044 [debug] [MainThread]: On master: COMMIT
[0m12:22:57.834614 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:22:57.836429 [debug] [MainThread]: On master: Close
[0m12:22:57.838910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:57.840604 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m12:22:57.842775 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m12:22:57.844464 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m12:22:57.845936 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deals' was properly closed.
[0m12:22:57.847444 [info ] [MainThread]: 
[0m12:22:57.849362 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m12:22:57.851530 [debug] [MainThread]: Command end result
[0m12:22:57.882289 [info ] [MainThread]: 
[0m12:22:57.884735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:57.886567 [info ] [MainThread]: 
[0m12:22:57.888324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:22:57.891316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9570143, "process_user_time": 2.532549, "process_kernel_time": 0.342868, "process_mem_max_rss": "106160", "process_in_blocks": "936", "process_out_blocks": "0"}
[0m12:22:57.893273 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:57.893082 after 1.96 seconds
[0m12:22:57.894698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783d7cf3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70783a3e5990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707839fb8880>]}
[0m12:22:57.896112 [debug] [MainThread]: Flushing usage events
[0m12:23:56.580626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74e994b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74ea089570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74ea08acb0>]}


============================== 12:23:56.584601 | 9bbbad69-868b-41a1-a978-830cad87f013 ==============================
[0m12:23:56.584601 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:23:56.586804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_engagements_meetings.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:23:56.814989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bbbad69-868b-41a1-a978-830cad87f013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74ea08bb50>]}
[0m12:23:56.933790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bbbad69-868b-41a1-a978-830cad87f013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74e646f490>]}
[0m12:23:56.936062 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:23:56.953706 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:23:57.923613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:23:57.925411 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:23:57.928165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:23:57.936893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bbbad69-868b-41a1-a978-830cad87f013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74e61b9990>]}
[0m12:23:57.982311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bbbad69-868b-41a1-a978-830cad87f013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74e61886a0>]}
[0m12:23:57.984223 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:23:57.987023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bbbad69-868b-41a1-a978-830cad87f013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74e6188880>]}
[0m12:23:57.989533 [warn ] [MainThread]: The selection criterion 'stg_engagements_meetings.sql' does not match any nodes
[0m12:23:57.992415 [info ] [MainThread]: 
[0m12:23:57.994663 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:23:57.997102 [debug] [MainThread]: Command end result
[0m12:23:58.029928 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5116428, "process_user_time": 2.186311, "process_kernel_time": 0.403261, "process_mem_max_rss": "98264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:23:58.032327 [debug] [MainThread]: Command `dbt run` succeeded at 12:23:58.032061 after 1.51 seconds
[0m12:23:58.034430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74e994b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74e662ac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d74e61885e0>]}
[0m12:23:58.037019 [debug] [MainThread]: Flushing usage events
[0m12:38:10.468795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b853b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b8c7ecb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b8c7d0f0>]}


============================== 12:38:10.472760 | e2a2ffd5-0b4d-414b-880f-7bc93efaf338 ==============================
[0m12:38:10.472760 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:38:10.474768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_contacts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:10.690322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2a2ffd5-0b4d-414b-880f-7bc93efaf338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b51691e0>]}
[0m12:38:10.782796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2a2ffd5-0b4d-414b-880f-7bc93efaf338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b5111180>]}
[0m12:38:10.785066 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:38:10.801468 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:38:11.686557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:38:11.688484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:38:11.691052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:38:11.698389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2a2ffd5-0b4d-414b-880f-7bc93efaf338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b4da9900>]}
[0m12:38:11.795165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2a2ffd5-0b4d-414b-880f-7bc93efaf338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b4d78550>]}
[0m12:38:11.800105 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:38:11.803554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a2ffd5-0b4d-414b-880f-7bc93efaf338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b4d788b0>]}
[0m12:38:11.806554 [warn ] [MainThread]: The selection criterion 'stg_contacts' does not match any nodes
[0m12:38:11.810751 [info ] [MainThread]: 
[0m12:38:11.813587 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:38:11.817550 [debug] [MainThread]: Command end result
[0m12:38:11.893195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4847968, "process_user_time": 2.094163, "process_kernel_time": 0.406866, "process_mem_max_rss": "98280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:38:11.899346 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:11.898816 after 1.49 seconds
[0m12:38:11.904015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b853b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b505cb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71a4b505cbe0>]}
[0m12:38:11.909388 [debug] [MainThread]: Flushing usage events
[0m12:39:27.716481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad91cff400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad90132ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad90132cb0>]}


============================== 12:39:27.720369 | 4318d0ad-645c-4374-b221-b118ef86b004 ==============================
[0m12:39:27.720369 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:39:27.722169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_contacts', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:27.924864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4318d0ad-645c-4374-b221-b118ef86b004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad90133b50>]}
[0m12:39:28.013691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4318d0ad-645c-4374-b221-b118ef86b004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad92453490>]}
[0m12:39:28.015662 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:39:28.032542 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:39:28.877847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:28.879708 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:28.882524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:39:28.889577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4318d0ad-645c-4374-b221-b118ef86b004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad8e5ad960>]}
[0m12:39:28.932758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4318d0ad-645c-4374-b221-b118ef86b004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad8e57c670>]}
[0m12:39:28.934743 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:39:28.936918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4318d0ad-645c-4374-b221-b118ef86b004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad8e57c850>]}
[0m12:39:28.939089 [warn ] [MainThread]: The selection criterion 'stg_contacts' does not match any nodes
[0m12:39:28.941615 [info ] [MainThread]: 
[0m12:39:28.943506 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:39:28.945686 [debug] [MainThread]: Command end result
[0m12:39:28.973366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3147972, "process_user_time": 2.038602, "process_kernel_time": 0.300511, "process_mem_max_rss": "98292", "process_in_blocks": "416", "process_out_blocks": "0"}
[0m12:39:28.975713 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:28.975487 after 1.32 seconds
[0m12:39:28.977324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad91cff400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad8e82caf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ad8e57c6a0>]}
[0m12:39:28.979146 [debug] [MainThread]: Flushing usage events
[0m12:40:31.481280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a6b583340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a699b8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a699b9360>]}


============================== 12:40:31.486447 | 96dbfbfa-62ae-43ec-9bdc-0b875b9641dd ==============================
[0m12:40:31.486447 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:40:31.489062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_contacts', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:40:31.708405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96dbfbfa-62ae-43ec-9bdc-0b875b9641dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a699b9630>]}
[0m12:40:31.994970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96dbfbfa-62ae-43ec-9bdc-0b875b9641dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a6bcd7e20>]}
[0m12:40:31.999479 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:40:32.042476 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:40:33.263422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:33.265967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:33.270555 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:40:33.280446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96dbfbfa-62ae-43ec-9bdc-0b875b9641dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a67e318a0>]}
[0m12:40:33.348881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96dbfbfa-62ae-43ec-9bdc-0b875b9641dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a67e005b0>]}
[0m12:40:33.351747 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:40:33.358804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96dbfbfa-62ae-43ec-9bdc-0b875b9641dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a67e00790>]}
[0m12:40:33.363427 [warn ] [MainThread]: The selection criterion 'stg_contacts' does not match any nodes
[0m12:40:33.366950 [info ] [MainThread]: 
[0m12:40:33.369325 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:40:33.372872 [debug] [MainThread]: Command end result
[0m12:40:33.412217 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0005288, "process_user_time": 2.439618, "process_kernel_time": 0.433798, "process_mem_max_rss": "98068", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:40:33.414900 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:33.414615 after 2.00 seconds
[0m12:40:33.417314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a6b583340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a680f0fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0a67e007c0>]}
[0m12:40:33.419911 [debug] [MainThread]: Flushing usage events
[0m12:41:07.434766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79da45f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d8883460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d8882290>]}


============================== 12:41:07.439148 | 46642a5a-c1f3-4e95-b766-23abc3102521 ==============================
[0m12:41:07.439148 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:41:07.442066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type model', 'send_anonymous_usage_stats': 'True'}
[0m12:41:07.857381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46642a5a-c1f3-4e95-b766-23abc3102521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d71826b0>]}
[0m12:41:07.962353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46642a5a-c1f3-4e95-b766-23abc3102521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d88c4b80>]}
[0m12:41:07.964160 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:41:07.981440 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:41:08.852076 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:08.853929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:08.856797 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:41:08.864492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46642a5a-c1f3-4e95-b766-23abc3102521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d6d11b40>]}
[0m12:41:08.908054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46642a5a-c1f3-4e95-b766-23abc3102521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d6dc0850>]}
[0m12:41:08.910386 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:41:08.912736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46642a5a-c1f3-4e95-b766-23abc3102521', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d6dc0a30>]}
[0m12:41:08.917068 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.5452114, "process_user_time": 2.144514, "process_kernel_time": 0.289147, "process_mem_max_rss": "97880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:41:08.919193 [debug] [MainThread]: Command `dbt ls` succeeded at 12:41:08.918994 after 1.55 seconds
[0m12:41:08.920600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79da45f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d6fc4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e79d6dc09d0>]}
[0m12:41:08.921841 [debug] [MainThread]: Flushing usage events
[0m12:41:36.281186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc868bb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc84cef0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc84cee140>]}


============================== 12:41:36.284656 | 98f0ebfe-f4ff-4276-8ed1-cf3d15532551 ==============================
[0m12:41:36.284656 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:41:36.286451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls -s stg_contacts', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:36.486286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98f0ebfe-f4ff-4276-8ed1-cf3d15532551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc833f26b0>]}
[0m12:41:36.570467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98f0ebfe-f4ff-4276-8ed1-cf3d15532551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc84d30b80>]}
[0m12:41:36.572505 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:41:36.589394 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:41:37.479663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:41:37.481572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:41:37.484570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:41:37.492077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98f0ebfe-f4ff-4276-8ed1-cf3d15532551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc8317db40>]}
[0m12:41:37.533138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98f0ebfe-f4ff-4276-8ed1-cf3d15532551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc83148850>]}
[0m12:41:37.534977 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:41:37.537046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98f0ebfe-f4ff-4276-8ed1-cf3d15532551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc83148a30>]}
[0m12:41:37.540238 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.3154036, "process_user_time": 1.996281, "process_kernel_time": 0.292041, "process_mem_max_rss": "97852", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:41:37.542214 [debug] [MainThread]: Command `dbt ls` succeeded at 12:41:37.542021 after 1.32 seconds
[0m12:41:37.543879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc868bb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc83430880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79cc831489d0>]}
[0m12:41:37.545607 [debug] [MainThread]: Flushing usage events
[0m12:42:05.789296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e4844cb3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e4829030d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e482902500>]}


============================== 12:42:05.793214 | dab9bb14-d313-478b-b2dd-3eaa31f2bd62 ==============================
[0m12:42:05.793214 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:42:05.795058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls -s hubspot_dbt.staging.hubspot.stg_contacts', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:42:05.993802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dab9bb14-d313-478b-b2dd-3eaa31f2bd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e482902740>]}
[0m12:42:06.078482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dab9bb14-d313-478b-b2dd-3eaa31f2bd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e484c1f4c0>]}
[0m12:42:06.081161 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:42:06.099771 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:42:06.958339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:06.960011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:06.962677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:42:06.970437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab9bb14-d313-478b-b2dd-3eaa31f2bd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e480d7dae0>]}
[0m12:42:07.011742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab9bb14-d313-478b-b2dd-3eaa31f2bd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e480d48820>]}
[0m12:42:07.013817 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:42:07.016501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab9bb14-d313-478b-b2dd-3eaa31f2bd62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e480d48a60>]}
[0m12:42:07.019376 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.285511, "process_user_time": 2.06606, "process_kernel_time": 0.27122, "process_mem_max_rss": "98004", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:42:07.021284 [debug] [MainThread]: Command `dbt ls` succeeded at 12:42:07.021061 after 1.29 seconds
[0m12:42:07.023066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e4844cb3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e48106db40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e484c1f4c0>]}
[0m12:42:07.024430 [debug] [MainThread]: Flushing usage events
[0m12:42:19.466926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb59087b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb58ecadc00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb58ecaecb0>]}


============================== 12:42:19.470633 | 64c2081d-49b4-470d-bf90-1348f740e89c ==============================
[0m12:42:19.470633 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:42:19.472761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s hubspot_dbt.staging.hubspot.stg_contacts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:42:19.682377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64c2081d-49b4-470d-bf90-1348f740e89c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb58ecafb50>]}
[0m12:42:19.769707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64c2081d-49b4-470d-bf90-1348f740e89c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb590fcf4f0>]}
[0m12:42:19.771670 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:42:19.789106 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:42:20.682055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:20.684084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:20.687062 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:42:20.694788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64c2081d-49b4-470d-bf90-1348f740e89c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb58d12d930>]}
[0m12:42:20.750086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64c2081d-49b4-470d-bf90-1348f740e89c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb58d0f8670>]}
[0m12:42:20.752007 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:42:20.754154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64c2081d-49b4-470d-bf90-1348f740e89c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb58d0f88b0>]}
[0m12:42:20.756260 [warn ] [MainThread]: The selection criterion 'hubspot_dbt.staging.hubspot.stg_contacts' does not match any nodes
[0m12:42:20.759034 [info ] [MainThread]: 
[0m12:42:20.762039 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:42:20.764569 [debug] [MainThread]: Command end result
[0m12:42:20.794229 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3880651, "process_user_time": 2.046642, "process_kernel_time": 0.284367, "process_mem_max_rss": "98260", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:42:20.796276 [debug] [MainThread]: Command `dbt run` succeeded at 12:42:20.796053 after 1.39 seconds
[0m12:42:20.797913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb59087b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb58d3ea110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bb58d29eb60>]}
[0m12:42:20.799576 [debug] [MainThread]: Flushing usage events
[0m12:53:08.470663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32fd6d73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32fbb09c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32fbb0acb0>]}


============================== 12:53:08.475135 | 93b1cb85-fb38-424c-87b9-53136471327e ==============================
[0m12:53:08.475135 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:53:08.477081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_contacts', 'send_anonymous_usage_stats': 'True'}
[0m12:53:08.713897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93b1cb85-fb38-424c-87b9-53136471327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32fbb0bb50>]}
[0m12:53:08.809143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93b1cb85-fb38-424c-87b9-53136471327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32fde2f4f0>]}
[0m12:53:08.811368 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:53:08.828722 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:53:09.754587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:09.756355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:09.759211 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:53:09.766511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93b1cb85-fb38-424c-87b9-53136471327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32f9f85930>]}
[0m12:53:09.811287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93b1cb85-fb38-424c-87b9-53136471327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32f9f54670>]}
[0m12:53:09.813117 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:53:09.815258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93b1cb85-fb38-424c-87b9-53136471327e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32f9f548b0>]}
[0m12:53:09.817505 [warn ] [MainThread]: The selection criterion 'stg_contacts' does not match any nodes
[0m12:53:09.820254 [info ] [MainThread]: 
[0m12:53:09.822228 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:53:09.824718 [debug] [MainThread]: Command end result
[0m12:53:09.853087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4560807, "process_user_time": 2.352769, "process_kernel_time": 0.760728, "process_mem_max_rss": "98456", "process_in_blocks": "1280", "process_out_blocks": "0"}
[0m12:53:09.855468 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:09.855261 after 1.46 seconds
[0m12:53:09.856986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32fd6d73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32fa246110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e32fa0f6b60>]}
[0m12:53:09.858342 [debug] [MainThread]: Flushing usage events
[0m12:53:28.055713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c69ee0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c683597b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c68359750>]}


============================== 12:53:28.066801 | 2654e3bc-8991-40b5-b36c-f05ca0b8faf1 ==============================
[0m12:53:28.066801 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:53:28.068499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_contacts', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:53:28.331255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2654e3bc-8991-40b5-b36c-f05ca0b8faf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c6839f520>]}
[0m12:53:28.434977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2654e3bc-8991-40b5-b36c-f05ca0b8faf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c686522f0>]}
[0m12:53:28.437191 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:53:28.456253 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:53:29.455582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:29.458064 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:29.460865 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.hubspot_dbt
[0m12:53:29.468501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2654e3bc-8991-40b5-b36c-f05ca0b8faf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c66755bd0>]}
[0m12:53:29.545423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2654e3bc-8991-40b5-b36c-f05ca0b8faf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c66724040>]}
[0m12:53:29.547735 [info ] [MainThread]: Found 48 models, 18 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:53:29.550124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2654e3bc-8991-40b5-b36c-f05ca0b8faf1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c66724ac0>]}
[0m12:53:29.552335 [warn ] [MainThread]: The selection criterion 'stg_contacts' does not match any nodes
[0m12:53:29.554988 [info ] [MainThread]: 
[0m12:53:29.557048 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:53:29.559251 [debug] [MainThread]: Command end result
[0m12:53:29.591880 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6045815, "process_user_time": 2.353984, "process_kernel_time": 1.305977, "process_mem_max_rss": "97256", "process_in_blocks": "8056", "process_out_blocks": "608"}
[0m12:53:29.594006 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:29.593806 after 1.61 seconds
[0m12:53:29.595546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c69ee0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c669dac20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708c686522f0>]}
[0m12:53:29.597405 [debug] [MainThread]: Flushing usage events
[0m12:58:10.217084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a7b9672b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a7a0cd6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a7a0cd480>]}


============================== 12:58:10.224172 | c9ea9cca-704f-4495-aade-2dedbf59cf47 ==============================
[0m12:58:10.224172 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:58:10.227143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ls --resource-type model', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:10.437041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9ea9cca-704f-4495-aade-2dedbf59cf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a7a0cc940>]}
[0m12:58:10.526004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9ea9cca-704f-4495-aade-2dedbf59cf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a7bfe2a70>]}
[0m12:58:10.528632 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:58:10.545699 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:58:10.554245 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:58:10.555858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9ea9cca-704f-4495-aade-2dedbf59cf47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a78511d80>]}
[0m12:58:12.768708 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m12:58:12.773574 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m12:58:13.269691 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_deal_pipeline' (models/staging/hubspot/stg_deal_pipeline.sql) depends on a source named 'hubspot_raw.raw_hubspot_raw__stream_deal_pipeline' which was not found
[0m12:58:13.272411 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 3.1189218, "process_user_time": 3.702578, "process_kernel_time": 0.408726, "process_mem_max_rss": "100304", "process_in_blocks": "3568", "process_out_blocks": "608", "command_success": false}
[0m12:58:13.274263 [debug] [MainThread]: Command `dbt ls` failed at 12:58:13.274068 after 3.12 seconds
[0m12:58:13.275838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a7b9672b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a785138b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x719a78510760>]}
[0m12:58:13.277503 [debug] [MainThread]: Flushing usage events
[0m13:48:28.177660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427db3dc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427d9b4e6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427d9b4d360>]}


============================== 13:48:28.184660 | 4a0c868e-a01d-4015-9f98-987e0a5ff27b ==============================
[0m13:48:28.184660 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:48:28.186723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls --resource-type model', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:28.389512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a0c868e-a01d-4015-9f98-987e0a5ff27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427dbbe4fa0>]}
[0m13:48:28.501337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a0c868e-a01d-4015-9f98-987e0a5ff27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427dba65090>]}
[0m13:48:28.503455 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:48:28.522227 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:48:28.529592 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:48:28.532684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a0c868e-a01d-4015-9f98-987e0a5ff27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427d80943a0>]}
[0m13:48:30.488995 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:48:30.492765 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:48:30.715214 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_deal_pipeline' (models/staging/hubspot/stg_deal_pipeline.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_deal_pipeline' which was not found
[0m13:48:30.718022 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 2.5959134, "process_user_time": 3.833188, "process_kernel_time": 0.470031, "process_mem_max_rss": "100872", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m13:48:30.720082 [debug] [MainThread]: Command `dbt ls` failed at 13:48:30.719880 after 2.60 seconds
[0m13:48:30.721464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427db3dc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427d7d118a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7427d7d71360>]}
[0m13:48:30.722840 [debug] [MainThread]: Flushing usage events
[0m13:49:45.513526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a7424880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a5b966b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a5b95360>]}


============================== 13:49:45.521658 | bfb3f60b-b24a-4e72-a3d6-4b55f1dae9e9 ==============================
[0m13:49:45.521658 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:49:45.523862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type model', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:49:45.741913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfb3f60b-b24a-4e72-a3d6-4b55f1dae9e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a7c2cfa0>]}
[0m13:49:45.828308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfb3f60b-b24a-4e72-a3d6-4b55f1dae9e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a7aad090>]}
[0m13:49:45.830616 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:49:45.846851 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:49:45.852310 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:49:45.854086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bfb3f60b-b24a-4e72-a3d6-4b55f1dae9e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a40d9030>]}
[0m13:49:48.023905 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:49:48.027909 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:49:48.226390 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_deal_pipeline' (models/staging/hubspot/stg_deal_pipeline.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_deal_pipeline' which was not found
[0m13:49:48.229291 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 2.935405, "process_user_time": 3.626043, "process_kernel_time": 0.471068, "process_mem_max_rss": "101096", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m13:49:48.231079 [debug] [MainThread]: Command `dbt ls` failed at 13:49:48.230843 after 2.94 seconds
[0m13:49:48.232473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a7424880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a3d558a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c95a3db9360>]}
[0m13:49:48.234161 [debug] [MainThread]: Flushing usage events
[0m13:50:42.570457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd69650a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd67f6e680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd67f6d3c0>]}


============================== 13:50:42.576889 | 33282b92-fa68-4aae-9d9c-20c08b24cd74 ==============================
[0m13:50:42.576889 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:50:42.578597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type source', 'send_anonymous_usage_stats': 'True'}
[0m13:50:42.776367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33282b92-fa68-4aae-9d9c-20c08b24cd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd67abb700>]}
[0m13:50:42.864303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33282b92-fa68-4aae-9d9c-20c08b24cd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd69b89060>]}
[0m13:50:42.866563 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:50:42.885569 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:50:42.893775 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:50:42.895863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33282b92-fa68-4aae-9d9c-20c08b24cd74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd662615a0>]}
[0m13:50:45.046142 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:50:45.051076 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:50:45.244474 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_deal_pipeline' (models/staging/hubspot/stg_deal_pipeline.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_deal_pipeline' which was not found
[0m13:50:45.247606 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 2.7401834, "process_user_time": 3.41725, "process_kernel_time": 0.513389, "process_mem_max_rss": "100776", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m13:50:45.249836 [debug] [MainThread]: Command `dbt ls` failed at 13:50:45.249603 after 2.74 seconds
[0m13:50:45.251727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd69650a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd662b4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd65fa09d0>]}
[0m13:50:45.253775 [debug] [MainThread]: Flushing usage events
[0m13:52:00.275198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9009bc4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e900833a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90083393c0>]}


============================== 13:52:00.282712 | f3dff673-2dd5-4d44-8c91-89ae1739bfe4 ==============================
[0m13:52:00.282712 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:52:00.284624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --resource-type source', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:52:00.490091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3dff673-2dd5-4d44-8c91-89ae1739bfe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e900807f700>]}
[0m13:52:00.579114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3dff673-2dd5-4d44-8c91-89ae1739bfe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e900a251060>]}
[0m13:52:00.581799 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:52:00.599374 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:52:00.607356 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:52:00.609112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f3dff673-2dd5-4d44-8c91-89ae1739bfe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90068255a0>]}
[0m13:52:02.498366 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:52:02.502420 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:52:02.686070 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_deal_splits' (models/staging/hubspot/stg_deal_splits.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_deal_splits' which was not found
[0m13:52:02.688750 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 2.4701703, "process_user_time": 3.332514, "process_kernel_time": 0.360819, "process_mem_max_rss": "100768", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m13:52:02.690605 [debug] [MainThread]: Command `dbt ls` failed at 13:52:02.690391 after 2.47 seconds
[0m13:52:02.692402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e9009bc4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90064a3700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e90064a32b0>]}
[0m13:52:02.693962 [debug] [MainThread]: Flushing usage events
[0m13:52:31.837359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2f206c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2f07d66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2f07d5360>]}


============================== 13:52:31.844575 | 5582f1b8-ec7a-4ba7-9f6e-c427340754a8 ==============================
[0m13:52:31.844575 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:52:31.846593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls --resource-type source', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:32.043686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5582f1b8-ec7a-4ba7-9f6e-c427340754a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2f2878fa0>]}
[0m13:52:32.131883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5582f1b8-ec7a-4ba7-9f6e-c427340754a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2f26e9090>]}
[0m13:52:32.134467 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:52:32.151091 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:52:32.158113 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:52:32.160428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5582f1b8-ec7a-4ba7-9f6e-c427340754a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2eed15030>]}
[0m13:52:34.104534 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:52:34.108762 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:52:34.289487 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_deal_splits' (models/staging/hubspot/stg_deal_splits.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_deal_splits' which was not found
[0m13:52:34.292245 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 2.5134711, "process_user_time": 3.209021, "process_kernel_time": 0.447027, "process_mem_max_rss": "101280", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m13:52:34.294043 [debug] [MainThread]: Command `dbt ls` failed at 13:52:34.293836 after 2.52 seconds
[0m13:52:34.295865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2f206c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2eeb5b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd2eea009a0>]}
[0m13:52:34.302104 [debug] [MainThread]: Flushing usage events
[0m13:53:16.074074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6144d38a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b61434ae6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b61434ad360>]}


============================== 13:53:16.080819 | b70b46ed-c328-4ee0-b313-5195865486fd ==============================
[0m13:53:16.080819 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:53:16.083067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ls --resource-type source', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:53:16.291122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b70b46ed-c328-4ee0-b313-5195865486fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6145550fd0>]}
[0m13:53:16.382943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b70b46ed-c328-4ee0-b313-5195865486fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b61453c5090>]}
[0m13:53:16.385742 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:53:16.402461 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:53:16.409240 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:53:16.410558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b70b46ed-c328-4ee0-b313-5195865486fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b61419ed030>]}
[0m13:53:18.533071 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:53:18.536913 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:53:18.718017 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_deal_splits' (models/staging/hubspot/stg_deal_splits.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_deal_splits' which was not found
[0m13:53:18.720938 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 2.8613768, "process_user_time": 3.330018, "process_kernel_time": 0.45959, "process_mem_max_rss": "100564", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m13:53:18.722900 [debug] [MainThread]: Command `dbt ls` failed at 13:53:18.722678 after 2.86 seconds
[0m13:53:18.724625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6144d38a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6141833250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b61416d89a0>]}
[0m13:53:18.726398 [debug] [MainThread]: Flushing usage events
[0m13:54:13.306954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7982b0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e796a226b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e796a21360>]}


============================== 13:54:13.313462 | e4f33145-5af2-4b59-9bbe-db7e26170865 ==============================
[0m13:54:13.313462 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:54:13.315460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --resource-type source', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:13.527994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4f33145-5af2-4b59-9bbe-db7e26170865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e798ab8fa0>]}
[0m13:54:13.613929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4f33145-5af2-4b59-9bbe-db7e26170865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e798939090>]}
[0m13:54:13.616618 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:54:13.633718 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:54:13.642196 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:54:13.644520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4f33145-5af2-4b59-9bbe-db7e26170865', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e794f65030>]}
[0m13:54:15.500303 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:54:15.504546 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:54:15.721416 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_owner' (models/staging/hubspot/stg_owner.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_owner' which was not found
[0m13:54:15.724234 [debug] [MainThread]: Resource report: {"command_name": "list", "command_wall_clock_time": 2.4762938, "process_user_time": 3.437326, "process_kernel_time": 0.349763, "process_mem_max_rss": "100708", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m13:54:15.726086 [debug] [MainThread]: Command `dbt ls` failed at 13:54:15.725890 after 2.48 seconds
[0m13:54:15.727435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e7982b0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e794dde260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e794c880a0>]}
[0m13:54:15.729075 [debug] [MainThread]: Flushing usage events
[0m13:55:09.431527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd0c60a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edcf08d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edcf08d750>]}


============================== 13:55:09.439066 | c49bad2c-d8e5-4acc-82a7-301514b5d25c ==============================
[0m13:55:09.439066 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:55:09.441289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_deals', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:09.647969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c49bad2c-d8e5-4acc-82a7-301514b5d25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edcf0cf520>]}
[0m13:55:09.734064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c49bad2c-d8e5-4acc-82a7-301514b5d25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edcf57e2f0>]}
[0m13:55:09.736282 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:55:09.753119 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:55:09.760418 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:55:09.762130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c49bad2c-d8e5-4acc-82a7-301514b5d25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edcd904f40>]}
[0m13:55:11.690501 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:55:11.694980 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:55:11.881414 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_owner' (models/staging/hubspot/stg_owner.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_owner' which was not found
[0m13:55:11.884230 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.5158944, "process_user_time": 3.495098, "process_kernel_time": 0.494216, "process_mem_max_rss": "100824", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m13:55:11.886346 [debug] [MainThread]: Command `dbt run` failed at 13:55:11.886137 after 2.52 seconds
[0m13:55:11.888069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edd0c60a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edcd502a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70edcd501390>]}
[0m13:55:11.889659 [debug] [MainThread]: Flushing usage events
[0m13:56:26.461759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9ba8c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb99ef5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb99ef5720>]}


============================== 13:56:26.469755 | ca1eb381-e42c-4813-a526-200f09e0a171 ==============================
[0m13:56:26.469755 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:56:26.471658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_deals', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:56:26.689865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca1eb381-e42c-4813-a526-200f09e0a171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb99f3b4f0>]}
[0m13:56:26.806840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca1eb381-e42c-4813-a526-200f09e0a171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9c108ca0>]}
[0m13:56:26.809289 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:56:26.862211 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:56:26.893777 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:56:26.902432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca1eb381-e42c-4813-a526-200f09e0a171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb986709d0>]}
[0m13:56:29.495542 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_deal_companies' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:56:29.501239 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_line_items' in the 'models' section of file 'models/staging/hubspot/stg_hubspot__schema.yml'
[0m13:56:29.747602 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.hubspot_dbt.not_null_stg_deal_companies_deal_id.bc404d4c11' (models/staging/hubspot/stg_hubspot__schema.yml) depends on a node named 'stg_deal_companies' in package '' which was not found
[0m13:56:29.749979 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.hubspot_dbt.not_null_stg_deal_companies_company_id.a626497024' (models/staging/hubspot/stg_hubspot__schema.yml) depends on a node named 'stg_deal_companies' in package '' which was not found
[0m13:56:29.752197 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.hubspot_dbt.not_null_stg_line_items_line_item_id.bd740440eb' (models/staging/hubspot/stg_hubspot__schema.yml) depends on a node named 'stg_line_items' in package '' which was not found
[0m13:56:29.754211 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.hubspot_dbt.unique_stg_line_items_line_item_id.f1ed561d83' (models/staging/hubspot/stg_hubspot__schema.yml) depends on a node named 'stg_line_items' in package '' which was not found
[0m13:56:29.840266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca1eb381-e42c-4813-a526-200f09e0a171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9601a650>]}
[0m13:56:29.932533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca1eb381-e42c-4813-a526-200f09e0a171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb98634d30>]}
[0m13:56:29.934977 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:56:29.937304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1eb381-e42c-4813-a526-200f09e0a171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb986360e0>]}
[0m13:56:29.941745 [info ] [MainThread]: 
[0m13:56:29.944548 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:29.948752 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m13:56:29.964058 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m13:56:29.965887 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:56:29.967331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:29.998485 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m13:56:30.001538 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:56:30.009248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m13:56:30.011510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m13:56:30.014238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m13:56:30.020964 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m13:56:30.021479 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:56:30.026023 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:56:30.029619 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:56:30.033753 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:56:30.035958 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m13:56:30.037739 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m13:56:30.039634 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m13:56:30.041467 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m13:56:30.043103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:30.045058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:30.047222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:30.049030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:30.065114 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:56:30.066948 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:56:30.067932 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:56:30.068533 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:56:30.069099 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:56:30.070410 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:56:30.072321 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:56:30.074258 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m13:56:30.075978 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:56:30.077792 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m13:56:30.079570 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m13:56:30.083007 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m13:56:30.091363 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:56:30.094711 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m13:56:30.095485 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:56:30.096531 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:56:30.098666 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m13:56:30.101085 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m13:56:30.102639 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m13:56:30.104471 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m13:56:30.108451 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m13:56:30.112461 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m13:56:30.115092 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m13:56:30.118801 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m13:56:30.131388 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:30.133368 [debug] [MainThread]: On master: BEGIN
[0m13:56:30.135186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:30.145492 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:56:30.147508 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:30.149408 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:30.194551 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:56:30.197500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca1eb381-e42c-4813-a526-200f09e0a171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb95f0cb80>]}
[0m13:56:30.199955 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:30.201997 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:30.203757 [debug] [MainThread]: On master: BEGIN
[0m13:56:30.205921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:56:30.207562 [debug] [MainThread]: On master: COMMIT
[0m13:56:30.209323 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:30.211075 [debug] [MainThread]: On master: COMMIT
[0m13:56:30.213132 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:56:30.214931 [debug] [MainThread]: On master: Close
[0m13:56:30.217221 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:30.220028 [info ] [MainThread]: 
[0m13:56:30.235934 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deals
[0m13:56:30.238077 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deals ............................ [RUN]
[0m13:56:30.240623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_deals)
[0m13:56:30.243950 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deals
[0m13:56:30.257119 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deals"
[0m13:56:30.288113 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (compile): 13:56:30.246605 => 13:56:30.287676
[0m13:56:30.289694 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deals
[0m13:56:30.325522 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deals"
[0m13:56:30.356736 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m13:56:30.358194 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: BEGIN
[0m13:56:30.359522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:30.368778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:56:30.370410 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m13:56:30.371963 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */

  create view "warehouse"."marts_staging"."stg_deals__dbt_tmp"
    
    
  as (
    -- models/staging/hubspot/stg_deals.sql

with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_deals
),

base as (
    select
        -- Identifiants & métadonnées
        (j->>'id')::bigint                              as deal_id,
        (j->>'createdAt')::timestamptz                  as created_at_raw,
        (j->>'updatedAt')::timestamptz                  as updated_at_raw,
        _airbyte_extracted_at                           as extracted_at,

        -- Propriétés principales HubSpot
        (j->'properties'->>'dealname')                  as deal_name,
        (j->'properties'->>'pipeline')                  as pipeline_id,
        (j->'properties'->>'dealstage')                 as deal_stage_id,
        nullif(j->'properties'->>'dealtype','')         as deal_type,
        (j->'properties'->>'deal_currency_code')        as currency,

        -- Ownership / relations
        nullif(j->'properties'->>'hubspot_owner_id','')::bigint
                                                        as owner_id,
        nullif(j->'properties'->>'hs_primary_associated_company','')::bigint
                                                        as primary_company_id,

        -- Montants
        nullif(j->'properties'->>'hs_acv','')::numeric  as hs_acv,
        nullif(j->'properties'->>'hs_tcv','')::numeric  as hs_tcv,
        nullif(j->'properties'->>'amount_in_home_currency','')::numeric
                                                        as amount_in_home_currency,
        nullif(j->'properties'->>'hs_closed_amount','')::numeric
                                                        as hs_closed_amount,
        nullif(j->'properties'->>'hs_closed_amount_in_home_currency','')::numeric
                                                        as hs_closed_amount_in_home_currency,

        -- États du deal
        coalesce((j->'properties'->>'hs_is_closed')::boolean, false)
                                                        as is_closed,
        coalesce((j->'properties'->>'hs_is_closed_won')::boolean, false)
                                                        as is_won,
        coalesce((j->'properties'->>'hs_is_closed_lost')::boolean, false)
                                                        as is_lost,

        -- Probabilités & analytics
        nullif(j->'properties'->>'hs_deal_stage_probability','')::numeric
                                                        as stage_probability,
        nullif(j->'properties'->>'hs_deal_stage_probability_shadow','')::numeric
                                                        as stage_probability_shadow,
        (j->'properties'->>'hs_analytics_latest_source')
                                                        as analytics_latest_source,
        nullif(j->'properties'->>'hs_analytics_latest_source_timestamp','')::timestamptz
                                                        as analytics_latest_source_ts,
        nullif(j->'properties'->>'hs_analytics_source_data_1','')
                                                        as analytics_source_data_1,

        -- Dates clés métier
        nullif(j->'properties'->>'createdate','')::timestamptz
                                                        as createdate,
        nullif(j->'properties'->>'closedate','')::timestamptz
                                                        as closedate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz
                                                        as lastmodifieddate,
        nullif(j->'properties'->>'hubspot_owner_assigneddate','')::timestamptz
                                                        as owner_assigned_at,

        -- Aide pour les ponts (associations)
        j->'companies'                                   as companies_json,
        j->'line_items'                                  as line_items_json
    from src
)

select *
from base
  );
[0m13:56:30.398560 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:56:30.406862 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m13:56:30.409218 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */
alter table "warehouse"."marts_staging"."stg_deals" rename to "stg_deals__dbt_backup"
[0m13:56:30.412799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:56:30.417626 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m13:56:30.419509 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */
alter table "warehouse"."marts_staging"."stg_deals__dbt_tmp" rename to "stg_deals"
[0m13:56:30.422029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:56:30.438631 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: COMMIT
[0m13:56:30.440466 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m13:56:30.442311 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: COMMIT
[0m13:56:30.447188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:56:30.455267 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_deals__dbt_backup"
[0m13:56:30.461073 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deals"
[0m13:56:30.462758 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deals"} */
drop view if exists "warehouse"."marts_staging"."stg_deals__dbt_backup" cascade
[0m13:56:30.477196 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:56:30.480215 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deals (execute): 13:56:30.291364 => 13:56:30.480024
[0m13:56:30.481926 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deals: Close
[0m13:56:30.484245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca1eb381-e42c-4813-a526-200f09e0a171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb95f55600>]}
[0m13:56:30.486666 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_deals ....................... [[32mCREATE VIEW[0m in 0.24s]
[0m13:56:30.489279 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deals
[0m13:56:30.493360 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:30.495048 [debug] [MainThread]: On master: BEGIN
[0m13:56:30.496817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:30.506401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:56:30.508447 [debug] [MainThread]: On master: COMMIT
[0m13:56:30.510078 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:30.511248 [debug] [MainThread]: On master: COMMIT
[0m13:56:30.512747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:56:30.513951 [debug] [MainThread]: On master: Close
[0m13:56:30.516013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:30.517736 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m13:56:30.519362 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m13:56:30.520817 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deals' was properly closed.
[0m13:56:30.522378 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m13:56:30.523855 [info ] [MainThread]: 
[0m13:56:30.525493 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m13:56:30.527673 [debug] [MainThread]: Command end result
[0m13:56:30.567625 [info ] [MainThread]: 
[0m13:56:30.570231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:30.572689 [info ] [MainThread]: 
[0m13:56:30.574964 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:56:30.578316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.185787, "process_user_time": 3.976111, "process_kernel_time": 0.816953, "process_mem_max_rss": "110600", "process_in_blocks": "744", "process_out_blocks": "664"}
[0m13:56:30.580852 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:30.580527 after 4.19 seconds
[0m13:56:30.582699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb9ba8c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb986709d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75eb98634d30>]}
[0m13:56:30.584447 [debug] [MainThread]: Flushing usage events
[0m13:56:41.745997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a9642c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a948a9900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a948a98a0>]}


============================== 13:56:41.754739 | dcbb1adb-e364-424e-b9ec-ef89b441d1c1 ==============================
[0m13:56:41.754739 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:56:41.756788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_contacts', 'send_anonymous_usage_stats': 'True'}
[0m13:56:42.011253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcbb1adb-e364-424e-b9ec-ef89b441d1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a948eb550>]}
[0m13:56:42.138975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcbb1adb-e364-424e-b9ec-ef89b441d1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a96ab4d60>]}
[0m13:56:42.142243 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:56:42.162558 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:56:43.228836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:43.230909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:43.241818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcbb1adb-e364-424e-b9ec-ef89b441d1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a92cfda20>]}
[0m13:56:43.296522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcbb1adb-e364-424e-b9ec-ef89b441d1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a92ed4670>]}
[0m13:56:43.298772 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:56:43.301295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcbb1adb-e364-424e-b9ec-ef89b441d1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a92ed4850>]}
[0m13:56:43.305471 [info ] [MainThread]: 
[0m13:56:43.308028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:43.311577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m13:56:43.324654 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m13:56:43.326855 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:56:43.328625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:43.342912 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m13:56:43.345973 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:56:43.352550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m13:56:43.354625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m13:56:43.356523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m13:56:43.358017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m13:56:43.364229 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:56:43.367998 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:56:43.372219 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:56:43.376156 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:56:43.378230 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m13:56:43.379990 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m13:56:43.381637 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m13:56:43.383438 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m13:56:43.385154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:43.386954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:43.388611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:43.390362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:43.402130 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:56:43.402749 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:56:43.404517 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:56:43.405126 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:56:43.406354 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:56:43.407614 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:56:43.408627 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m13:56:43.410427 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:56:43.412060 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m13:56:43.413972 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:56:43.417579 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m13:56:43.420888 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m13:56:43.421460 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m13:56:43.424611 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:56:43.427044 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m13:56:43.427801 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:56:43.428489 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:56:43.430342 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m13:56:43.432796 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m13:56:43.434999 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m13:56:43.438024 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m13:56:43.440851 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m13:56:43.445198 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m13:56:43.447015 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m13:56:43.458338 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:43.460472 [debug] [MainThread]: On master: BEGIN
[0m13:56:43.462359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:43.473090 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:56:43.475314 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:43.476970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:43.510999 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:56:43.513983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcbb1adb-e364-424e-b9ec-ef89b441d1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a92b63f10>]}
[0m13:56:43.515985 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:43.518000 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:43.519528 [debug] [MainThread]: On master: BEGIN
[0m13:56:43.521632 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:56:43.523371 [debug] [MainThread]: On master: COMMIT
[0m13:56:43.524981 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:43.526498 [debug] [MainThread]: On master: COMMIT
[0m13:56:43.528425 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:56:43.530136 [debug] [MainThread]: On master: Close
[0m13:56:43.532493 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:43.534486 [info ] [MainThread]: 
[0m13:56:43.544878 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_contacts
[0m13:56:43.546875 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_contacts ......................... [RUN]
[0m13:56:43.550069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_contacts)
[0m13:56:43.552451 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_contacts
[0m13:56:43.561137 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_contacts"
[0m13:56:43.574670 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_contacts (compile): 13:56:43.553854 => 13:56:43.574188
[0m13:56:43.576237 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_contacts
[0m13:56:43.613116 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_contacts"
[0m13:56:43.627649 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:56:43.629422 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: BEGIN
[0m13:56:43.630939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:43.640169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:56:43.641972 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:56:43.643760 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_contacts"} */

  create view "warehouse"."marts_staging"."stg_contacts__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_contacts
),

base as (
    select
        -- Identifiant hubspot du contact
        (j->>'id')::bigint                                   as contact_id,

        -- Timestamps bruts au niveau racine
        nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

        -- Propriétés "classiques"
        nullif(j->'properties'->>'email','')                as email,
        nullif(j->'properties'->>'firstname','')            as first_name,
        nullif(j->'properties'->>'lastname','')             as last_name,
        nullif(j->'properties'->>'country','')              as country,

        -- Funnel / marketing
        nullif(j->'properties'->>'lifecyclestage','')       as lifecycle_stage,      -- lead, mql, sql, opportunity…
        nullif(j->'properties'->>'hs_lead_status','')       as lead_status,          -- Nouveau, À contacter, etc.
        nullif(j->'properties'->>'hs_marketable_status','') as marketable_status,

        -- Ownership (pour rattacher au commercial)
        nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

        -- Dates importantes pour les KPIs
        nullif(j->'properties'->>'createdate','')::timestamptz              as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz     as lastmodifieddate,
        nullif(j->'properties'->>'hs_lifecyclestage_lead_date','')::timestamptz as lifecyclestage_lead_date,
        nullif(j->'properties'->>'hs_lifecyclestage_opportunity_date','')::timestamptz as lifecyclestage_opportunity_date,
        nullif(j->'properties'->>'hs_lifecyclestage_customer_date','')::timestamptz   as lifecyclestage_customer_date,

        -- Analytics HubSpot (pour conversion visite → lead)
        nullif(j->'properties'->>'hs_analytics_source','')                   as analytics_source,
        nullif(j->'properties'->>'hs_analytics_first_url','')               as analytics_first_url,
        nullif(j->'properties'->>'hs_analytics_first_referrer','')          as analytics_first_referrer,
        nullif(j->'properties'->>'hs_analytics_num_page_views','')::int     as num_page_views,
        nullif(j->'properties'->>'hs_analytics_num_visits','')::int         as num_visits,
        nullif(j->'properties'->>'hs_analytics_first_timestamp','')::timestamptz as first_analytics_ts,
        nullif(j->'properties'->>'hs_analytics_last_timestamp','')::timestamptz  as last_analytics_ts,
        nullif(j->'properties'->>'hs_analytics_first_touch_converting_campaign','') as first_touch_campaign,
        nullif(j->'properties'->>'hs_analytics_last_touch_converting_campaign','')  as last_touch_campaign,

        -- Liste de companies associées (souvent un array d’ids)
        j->'companies'                                      as companies_json,

        -- Colonne technique Airbyte
        extracted_at
    from src
)

select
    contact_id,

    -- on priorise les dates 'properties', sinon on fallback sur les dates racine
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,

    email,
    first_name,
    last_name,
    country,

    lifecycle_stage,
    lead_status,
    marketable_status,
    owner_id,

    lifecyclestage_lead_date,
    lifecyclestage_opportunity_date,
    lifecyclestage_customer_date,

    analytics_source,
    analytics_first_url,
    analytics_first_referrer,
    num_page_views,
    num_visits,
    first_analytics_ts,
    last_analytics_ts,
    first_touch_campaign,
    last_touch_campaign,

    companies_json,
    extracted_at
from base;
  );
[0m13:56:43.646690 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 96: from base;
                  ^

[0m13:56:43.649067 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: ROLLBACK
[0m13:56:43.651077 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_contacts (execute): 13:56:43.577504 => 13:56:43.650775
[0m13:56:43.652780 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: Close
[0m13:56:43.662408 [debug] [Thread-1 (]: Database Error in model stg_contacts (models/staging/hubspot/stg_contacts.sql)
  syntax error at or near ";"
  LINE 96: from base;
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_contacts.sql
[0m13:56:43.664533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcbb1adb-e364-424e-b9ec-ef89b441d1c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a92c07e50>]}
[0m13:56:43.666361 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_contacts ................ [[31mERROR[0m in 0.12s]
[0m13:56:43.668648 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_contacts
[0m13:56:43.672816 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:43.674552 [debug] [MainThread]: On master: BEGIN
[0m13:56:43.676344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:43.686744 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:56:43.688284 [debug] [MainThread]: On master: COMMIT
[0m13:56:43.689437 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:43.690348 [debug] [MainThread]: On master: COMMIT
[0m13:56:43.692105 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:56:43.693259 [debug] [MainThread]: On master: Close
[0m13:56:43.694667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:43.695970 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m13:56:43.697182 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m13:56:43.698847 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m13:56:43.699940 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_contacts' was properly closed.
[0m13:56:43.701294 [info ] [MainThread]: 
[0m13:56:43.703327 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m13:56:43.705631 [debug] [MainThread]: Command end result
[0m13:56:43.794705 [info ] [MainThread]: 
[0m13:56:43.797104 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:56:43.799186 [info ] [MainThread]: 
[0m13:56:43.801295 [error] [MainThread]:   Database Error in model stg_contacts (models/staging/hubspot/stg_contacts.sql)
  syntax error at or near ";"
  LINE 96: from base;
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_contacts.sql
[0m13:56:43.803363 [info ] [MainThread]: 
[0m13:56:43.805562 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:56:43.808428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1255212, "process_user_time": 2.552218, "process_kernel_time": 0.533238, "process_mem_max_rss": "105280", "process_in_blocks": "9384", "process_out_blocks": "664", "command_success": false}
[0m13:56:43.810882 [debug] [MainThread]: Command `dbt run` failed at 13:56:43.810614 after 2.13 seconds
[0m13:56:43.813169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a9642c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a92e1a860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715a947d0df0>]}
[0m13:56:43.814998 [debug] [MainThread]: Flushing usage events
[0m13:57:50.783367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78676672c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786764b956f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786764b95690>]}


============================== 13:57:50.790038 | 7926dfd0-d169-421d-8eb3-43e4a7dddf16 ==============================
[0m13:57:50.790038 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:57:50.791862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_contacts', 'send_anonymous_usage_stats': 'True'}
[0m13:57:51.009392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7926dfd0-d169-421d-8eb3-43e4a7dddf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786764bdb490>]}
[0m13:57:51.096876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7926dfd0-d169-421d-8eb3-43e4a7dddf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786766da9030>]}
[0m13:57:51.099374 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:57:51.115480 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:57:51.950831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:51.953135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:51.962286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7926dfd0-d169-421d-8eb3-43e4a7dddf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786763001960>]}
[0m13:57:52.014835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7926dfd0-d169-421d-8eb3-43e4a7dddf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7867631cc5b0>]}
[0m13:57:52.016291 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:57:52.018182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7926dfd0-d169-421d-8eb3-43e4a7dddf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7867631cc790>]}
[0m13:57:52.021272 [info ] [MainThread]: 
[0m13:57:52.023653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:52.026557 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m13:57:52.039322 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m13:57:52.040835 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:57:52.042527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:52.055122 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m13:57:52.058186 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:57:52.063458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m13:57:52.065372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m13:57:52.066671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m13:57:52.067944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m13:57:52.073739 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:57:52.076779 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:57:52.080634 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:57:52.084632 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:57:52.086603 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m13:57:52.088194 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m13:57:52.089709 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m13:57:52.091327 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m13:57:52.092777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:52.094404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:52.096087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:52.097802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:52.107328 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:57:52.108992 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:57:52.109635 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:57:52.110860 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:57:52.111391 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m13:57:52.112814 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:57:52.114220 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:57:52.116712 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m13:57:52.118459 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m13:57:52.119981 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:57:52.123818 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m13:57:52.125602 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m13:57:52.126154 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:57:52.127314 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m13:57:52.130348 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m13:57:52.132742 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m13:57:52.133969 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:57:52.136432 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m13:57:52.137930 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m13:57:52.139294 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:57:52.144171 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m13:57:52.148727 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:57:52.151324 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m13:57:52.152811 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m13:57:52.161382 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:52.162644 [debug] [MainThread]: On master: BEGIN
[0m13:57:52.163877 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:52.172988 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:52.175010 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:52.176257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:52.208788 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:57:52.212120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7926dfd0-d169-421d-8eb3-43e4a7dddf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786762e55d20>]}
[0m13:57:52.213959 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:52.215798 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:52.217411 [debug] [MainThread]: On master: BEGIN
[0m13:57:52.219229 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:52.220922 [debug] [MainThread]: On master: COMMIT
[0m13:57:52.222338 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:52.223846 [debug] [MainThread]: On master: COMMIT
[0m13:57:52.225645 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:52.227338 [debug] [MainThread]: On master: Close
[0m13:57:52.229306 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:52.231438 [info ] [MainThread]: 
[0m13:57:52.241298 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_contacts
[0m13:57:52.243451 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_contacts ......................... [RUN]
[0m13:57:52.245603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_contacts)
[0m13:57:52.247032 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_contacts
[0m13:57:52.255140 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_contacts"
[0m13:57:52.267624 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_contacts (compile): 13:57:52.248035 => 13:57:52.267261
[0m13:57:52.269282 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_contacts
[0m13:57:52.303196 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_contacts"
[0m13:57:52.314229 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:57:52.315378 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: BEGIN
[0m13:57:52.316528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:57:52.324178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:57:52.325976 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:57:52.327727 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_contacts"} */

  create view "warehouse"."marts_staging"."stg_contacts__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_contacts
),

base as (
    select
        -- Identifiant hubspot du contact
        (j->>'id')::bigint                                   as contact_id,

        -- Timestamps bruts au niveau racine
        nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

        -- Propriétés "classiques"
        nullif(j->'properties'->>'email','')                as email,
        nullif(j->'properties'->>'firstname','')            as first_name,
        nullif(j->'properties'->>'lastname','')             as last_name,
        nullif(j->'properties'->>'country','')              as country,

        -- Funnel / marketing
        nullif(j->'properties'->>'lifecyclestage','')       as lifecycle_stage,      -- lead, mql, sql, opportunity…
        nullif(j->'properties'->>'hs_lead_status','')       as lead_status,          -- Nouveau, À contacter, etc.
        nullif(j->'properties'->>'hs_marketable_status','') as marketable_status,

        -- Ownership (pour rattacher au commercial)
        nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

        -- Dates importantes pour les KPIs
        nullif(j->'properties'->>'createdate','')::timestamptz              as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz     as lastmodifieddate,
        nullif(j->'properties'->>'hs_lifecyclestage_lead_date','')::timestamptz as lifecyclestage_lead_date,
        nullif(j->'properties'->>'hs_lifecyclestage_opportunity_date','')::timestamptz as lifecyclestage_opportunity_date,
        nullif(j->'properties'->>'hs_lifecyclestage_customer_date','')::timestamptz   as lifecyclestage_customer_date,

        -- Analytics HubSpot (pour conversion visite → lead)
        nullif(j->'properties'->>'hs_analytics_source','')                   as analytics_source,
        nullif(j->'properties'->>'hs_analytics_first_url','')               as analytics_first_url,
        nullif(j->'properties'->>'hs_analytics_first_referrer','')          as analytics_first_referrer,
        nullif(j->'properties'->>'hs_analytics_num_page_views','')::int     as num_page_views,
        nullif(j->'properties'->>'hs_analytics_num_visits','')::int         as num_visits,
        nullif(j->'properties'->>'hs_analytics_first_timestamp','')::timestamptz as first_analytics_ts,
        nullif(j->'properties'->>'hs_analytics_last_timestamp','')::timestamptz  as last_analytics_ts,
        nullif(j->'properties'->>'hs_analytics_first_touch_converting_campaign','') as first_touch_campaign,
        nullif(j->'properties'->>'hs_analytics_last_touch_converting_campaign','')  as last_touch_campaign,

        -- Liste de companies associées (souvent un array d’ids)
        j->'companies'                                      as companies_json,

        -- Colonne technique Airbyte
        extracted_at
    from src
)

select
    contact_id,

    -- on priorise les dates 'properties', sinon on fallback sur les dates racine
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,

    email,
    first_name,
    last_name,
    country,

    lifecycle_stage,
    lead_status,
    marketable_status,
    owner_id,

    lifecyclestage_lead_date,
    lifecyclestage_opportunity_date,
    lifecyclestage_customer_date,

    analytics_source,
    analytics_first_url,
    analytics_first_referrer,
    num_page_views,
    num_visits,
    first_analytics_ts,
    last_analytics_ts,
    first_touch_campaign,
    last_touch_campaign,

    companies_json,
    extracted_at
from base;
  );
[0m13:57:52.329826 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 96: from base;
                  ^

[0m13:57:52.331256 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: ROLLBACK
[0m13:57:52.332879 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_contacts (execute): 13:57:52.270720 => 13:57:52.332600
[0m13:57:52.334465 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: Close
[0m13:57:52.337518 [debug] [Thread-1 (]: Database Error in model stg_contacts (models/staging/hubspot/stg_contacts.sql)
  syntax error at or near ";"
  LINE 96: from base;
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_contacts.sql
[0m13:57:52.339849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7926dfd0-d169-421d-8eb3-43e4a7dddf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786762f0fd00>]}
[0m13:57:52.341582 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_contacts ................ [[31mERROR[0m in 0.09s]
[0m13:57:52.343730 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_contacts
[0m13:57:52.347583 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:52.349109 [debug] [MainThread]: On master: BEGIN
[0m13:57:52.350586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:52.360533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:57:52.362558 [debug] [MainThread]: On master: COMMIT
[0m13:57:52.363963 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:52.364961 [debug] [MainThread]: On master: COMMIT
[0m13:57:52.366493 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:57:52.367743 [debug] [MainThread]: On master: Close
[0m13:57:52.369785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:52.371275 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m13:57:52.372534 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m13:57:52.373828 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m13:57:52.374839 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_contacts' was properly closed.
[0m13:57:52.376542 [info ] [MainThread]: 
[0m13:57:52.378207 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:57:52.380075 [debug] [MainThread]: Command end result
[0m13:57:52.455556 [info ] [MainThread]: 
[0m13:57:52.457480 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:57:52.459629 [info ] [MainThread]: 
[0m13:57:52.461673 [error] [MainThread]:   Database Error in model stg_contacts (models/staging/hubspot/stg_contacts.sql)
  syntax error at or near ";"
  LINE 96: from base;
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_contacts.sql
[0m13:57:52.463773 [info ] [MainThread]: 
[0m13:57:52.465984 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:57:52.468744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7484751, "process_user_time": 2.446807, "process_kernel_time": 0.486946, "process_mem_max_rss": "105800", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m13:57:52.470496 [debug] [MainThread]: Command `dbt run` failed at 13:57:52.470306 after 1.75 seconds
[0m13:57:52.471663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78676672c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786763384c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x786763286800>]}
[0m13:57:52.472964 [debug] [MainThread]: Flushing usage events
[0m13:58:03.857715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51d960580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51bdc9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51bdc9630>]}


============================== 13:58:03.864914 | 3ad85931-d120-422c-9798-31ade9da97c6 ==============================
[0m13:58:03.864914 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:58:03.866849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_contacts', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:04.070334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ad85931-d120-422c-9798-31ade9da97c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51be0f460>]}
[0m13:58:04.168888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ad85931-d120-422c-9798-31ade9da97c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51dfdd030>]}
[0m13:58:04.171454 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:58:04.188074 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:58:05.036715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:05.038571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:05.049371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ad85931-d120-422c-9798-31ade9da97c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51a231930>]}
[0m13:58:05.097824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ad85931-d120-422c-9798-31ade9da97c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51a400580>]}
[0m13:58:05.099391 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:58:05.101468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ad85931-d120-422c-9798-31ade9da97c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51a400760>]}
[0m13:58:05.104942 [info ] [MainThread]: 
[0m13:58:05.107813 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:05.111171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m13:58:05.124704 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m13:58:05.126972 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:58:05.128209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:05.140546 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m13:58:05.143029 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:58:05.148270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m13:58:05.150055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m13:58:05.151441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m13:58:05.157939 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:58:05.159155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m13:58:05.162221 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:58:05.166330 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:58:05.168417 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m13:58:05.171990 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:58:05.174121 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m13:58:05.175604 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m13:58:05.176955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:05.178641 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m13:58:05.180299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:05.181842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:05.184269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:05.191273 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:05.193158 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:58:05.194663 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:05.195765 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m13:58:05.196443 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:05.197810 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:58:05.198411 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:05.200421 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:58:05.202084 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m13:58:05.203492 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:58:05.204002 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:58:05.205466 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m13:58:05.208816 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m13:58:05.211724 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m13:58:05.212232 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:58:05.215545 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m13:58:05.217774 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m13:58:05.218340 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:58:05.218757 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m13:58:05.220999 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m13:58:05.222768 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m13:58:05.225282 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m13:58:05.228063 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m13:58:05.229673 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m13:58:05.239026 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:05.240599 [debug] [MainThread]: On master: BEGIN
[0m13:58:05.241978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:05.251090 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:05.252668 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:05.254004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:05.286914 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:58:05.289775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ad85931-d120-422c-9798-31ade9da97c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51a08b4f0>]}
[0m13:58:05.291658 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:05.293729 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:05.295147 [debug] [MainThread]: On master: BEGIN
[0m13:58:05.296860 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:05.298301 [debug] [MainThread]: On master: COMMIT
[0m13:58:05.299643 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:05.300922 [debug] [MainThread]: On master: COMMIT
[0m13:58:05.302415 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:58:05.303833 [debug] [MainThread]: On master: Close
[0m13:58:05.305515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:58:05.307476 [info ] [MainThread]: 
[0m13:58:05.317149 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_contacts
[0m13:58:05.319174 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_contacts ......................... [RUN]
[0m13:58:05.321652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_contacts)
[0m13:58:05.323562 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_contacts
[0m13:58:05.332437 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_contacts"
[0m13:58:05.344754 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_contacts (compile): 13:58:05.325152 => 13:58:05.344384
[0m13:58:05.345981 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_contacts
[0m13:58:05.378630 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_contacts"
[0m13:58:05.392772 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:58:05.394194 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: BEGIN
[0m13:58:05.395439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:05.405788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:58:05.407501 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:58:05.409234 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_contacts"} */

  create view "warehouse"."marts_staging"."stg_contacts__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_contacts
),

base as (
    select
        -- Identifiant hubspot du contact
        (j->>'id')::bigint                                   as contact_id,

        -- Timestamps bruts au niveau racine
        nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

        -- Propriétés "classiques"
        nullif(j->'properties'->>'email','')                as email,
        nullif(j->'properties'->>'firstname','')            as first_name,
        nullif(j->'properties'->>'lastname','')             as last_name,
        nullif(j->'properties'->>'country','')              as country,

        -- Funnel / marketing
        nullif(j->'properties'->>'lifecyclestage','')       as lifecycle_stage,      -- lead, mql, sql, opportunity…
        nullif(j->'properties'->>'hs_lead_status','')       as lead_status,          -- Nouveau, À contacter, etc.
        nullif(j->'properties'->>'hs_marketable_status','') as marketable_status,

        -- Ownership (pour rattacher au commercial)
        nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

        -- Dates importantes pour les KPIs
        nullif(j->'properties'->>'createdate','')::timestamptz              as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz     as lastmodifieddate,
        nullif(j->'properties'->>'hs_lifecyclestage_lead_date','')::timestamptz as lifecyclestage_lead_date,
        nullif(j->'properties'->>'hs_lifecyclestage_opportunity_date','')::timestamptz as lifecyclestage_opportunity_date,
        nullif(j->'properties'->>'hs_lifecyclestage_customer_date','')::timestamptz   as lifecyclestage_customer_date,

        -- Analytics HubSpot (pour conversion visite → lead)
        nullif(j->'properties'->>'hs_analytics_source','')                   as analytics_source,
        nullif(j->'properties'->>'hs_analytics_first_url','')               as analytics_first_url,
        nullif(j->'properties'->>'hs_analytics_first_referrer','')          as analytics_first_referrer,
        nullif(j->'properties'->>'hs_analytics_num_page_views','')::int     as num_page_views,
        nullif(j->'properties'->>'hs_analytics_num_visits','')::int         as num_visits,
        nullif(j->'properties'->>'hs_analytics_first_timestamp','')::timestamptz as first_analytics_ts,
        nullif(j->'properties'->>'hs_analytics_last_timestamp','')::timestamptz  as last_analytics_ts,
        nullif(j->'properties'->>'hs_analytics_first_touch_converting_campaign','') as first_touch_campaign,
        nullif(j->'properties'->>'hs_analytics_last_touch_converting_campaign','')  as last_touch_campaign,

        -- Liste de companies associées (souvent un array d’ids)
        j->'companies'                                      as companies_json,

        -- Colonne technique Airbyte
        extracted_at
    from src
)

select
    contact_id,

    -- on priorise les dates 'properties', sinon on fallback sur les dates racine
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,

    email,
    first_name,
    last_name,
    country,

    lifecycle_stage,
    lead_status,
    marketable_status,
    owner_id,

    lifecyclestage_lead_date,
    lifecyclestage_opportunity_date,
    lifecyclestage_customer_date,

    analytics_source,
    analytics_first_url,
    analytics_first_referrer,
    num_page_views,
    num_visits,
    first_analytics_ts,
    last_analytics_ts,
    first_touch_campaign,
    last_touch_campaign,

    companies_json,
    extracted_at
from base;
  );
[0m13:58:05.412364 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 96: from base;
                  ^

[0m13:58:05.414071 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: ROLLBACK
[0m13:58:05.416075 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_contacts (execute): 13:58:05.346852 => 13:58:05.415747
[0m13:58:05.417627 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: Close
[0m13:58:05.421579 [debug] [Thread-1 (]: Database Error in model stg_contacts (models/staging/hubspot/stg_contacts.sql)
  syntax error at or near ";"
  LINE 96: from base;
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_contacts.sql
[0m13:58:05.423687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ad85931-d120-422c-9798-31ade9da97c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51a143cd0>]}
[0m13:58:05.425409 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_contacts ................ [[31mERROR[0m in 0.10s]
[0m13:58:05.427598 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_contacts
[0m13:58:05.431172 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:05.432827 [debug] [MainThread]: On master: BEGIN
[0m13:58:05.434550 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:05.444620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:05.446738 [debug] [MainThread]: On master: COMMIT
[0m13:58:05.448381 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:05.450250 [debug] [MainThread]: On master: COMMIT
[0m13:58:05.452656 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:58:05.454734 [debug] [MainThread]: On master: Close
[0m13:58:05.457026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:05.458821 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m13:58:05.460676 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m13:58:05.462596 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m13:58:05.464178 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_contacts' was properly closed.
[0m13:58:05.466017 [info ] [MainThread]: 
[0m13:58:05.468246 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m13:58:05.471098 [debug] [MainThread]: Command end result
[0m13:58:05.581282 [info ] [MainThread]: 
[0m13:58:05.583960 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:05.586377 [info ] [MainThread]: 
[0m13:58:05.588516 [error] [MainThread]:   Database Error in model stg_contacts (models/staging/hubspot/stg_contacts.sql)
  syntax error at or near ";"
  LINE 96: from base;
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_contacts.sql
[0m13:58:05.591214 [info ] [MainThread]: 
[0m13:58:05.594025 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:58:05.598000 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7958604, "process_user_time": 2.482842, "process_kernel_time": 0.412472, "process_mem_max_rss": "104828", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m13:58:05.600413 [debug] [MainThread]: Command `dbt run` failed at 13:58:05.600096 after 1.80 seconds
[0m13:58:05.602574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51d960580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51dfdd030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e51c0c8dc0>]}
[0m13:58:05.604474 [debug] [MainThread]: Flushing usage events
[0m13:58:18.693104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41bfaca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41a3d57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41a3d5750>]}


============================== 13:58:18.699592 | e857442e-1740-4ca3-ae13-96fb1bb90be7 ==============================
[0m13:58:18.699592 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:58:18.701546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_contacts', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:18.904408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e857442e-1740-4ca3-ae13-96fb1bb90be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41a41b520>]}
[0m13:58:18.991180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e857442e-1740-4ca3-ae13-96fb1bb90be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41a8ca2f0>]}
[0m13:58:18.993365 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:58:19.009683 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:58:19.902226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:58:19.904772 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_contacts.sql
[0m13:58:20.268827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e857442e-1740-4ca3-ae13-96fb1bb90be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41a41b790>]}
[0m13:58:20.313588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e857442e-1740-4ca3-ae13-96fb1bb90be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41880f8e0>]}
[0m13:58:20.315634 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m13:58:20.317827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e857442e-1740-4ca3-ae13-96fb1bb90be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41880fa60>]}
[0m13:58:20.321385 [info ] [MainThread]: 
[0m13:58:20.323944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:20.326641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m13:58:20.339121 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m13:58:20.340724 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:58:20.341837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:20.368358 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m13:58:20.371217 [debug] [ThreadPool]: On list_warehouse: Close
[0m13:58:20.377268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_marts)
[0m13:58:20.379078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m13:58:20.381076 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m13:58:20.382565 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m13:58:20.389170 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:58:20.391866 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:58:20.395167 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:58:20.398647 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:58:20.400608 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m13:58:20.402214 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m13:58:20.404906 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m13:58:20.406658 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m13:58:20.408215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:20.409721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:20.410863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:20.412116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:20.421170 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:20.422848 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m13:58:20.423291 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:20.424468 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:20.425074 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m13:58:20.425646 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:20.427322 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m13:58:20.428575 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m13:58:20.431303 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m13:58:20.433021 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m13:58:20.434469 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:58:20.437177 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m13:58:20.438448 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m13:58:20.441917 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m13:58:20.445687 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:58:20.446637 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m13:58:20.447392 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m13:58:20.448124 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:58:20.449551 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m13:58:20.453216 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m13:58:20.455845 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m13:58:20.457827 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m13:58:20.459094 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m13:58:20.460804 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m13:58:20.471404 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.472956 [debug] [MainThread]: On master: BEGIN
[0m13:58:20.474295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:20.484081 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:20.485662 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.486813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:20.541277 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m13:58:20.543818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e857442e-1740-4ca3-ae13-96fb1bb90be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca418c52200>]}
[0m13:58:20.545603 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:20.547498 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.549215 [debug] [MainThread]: On master: BEGIN
[0m13:58:20.551487 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:20.553092 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.554552 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.555997 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.557853 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:58:20.559437 [debug] [MainThread]: On master: Close
[0m13:58:20.561397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:58:20.563425 [info ] [MainThread]: 
[0m13:58:20.575097 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_contacts
[0m13:58:20.576899 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_contacts ......................... [RUN]
[0m13:58:20.579454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_contacts)
[0m13:58:20.581416 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_contacts
[0m13:58:20.592451 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_contacts"
[0m13:58:20.604784 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_contacts (compile): 13:58:20.582787 => 13:58:20.604432
[0m13:58:20.606166 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_contacts
[0m13:58:20.638578 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_contacts"
[0m13:58:20.650365 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:58:20.651928 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: BEGIN
[0m13:58:20.653381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:20.662194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:58:20.664031 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:58:20.665665 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_contacts"} */

  create view "warehouse"."marts_staging"."stg_contacts__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_contacts
),

base as (
    select
        -- Identifiant hubspot du contact
        (j->>'id')::bigint                                   as contact_id,

        -- Timestamps bruts au niveau racine
        nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

        -- Propriétés "classiques"
        nullif(j->'properties'->>'email','')                as email,
        nullif(j->'properties'->>'firstname','')            as first_name,
        nullif(j->'properties'->>'lastname','')             as last_name,
        nullif(j->'properties'->>'country','')              as country,

        -- Funnel / marketing
        nullif(j->'properties'->>'lifecyclestage','')       as lifecycle_stage,      -- lead, mql, sql, opportunity…
        nullif(j->'properties'->>'hs_lead_status','')       as lead_status,          -- Nouveau, À contacter, etc.
        nullif(j->'properties'->>'hs_marketable_status','') as marketable_status,

        -- Ownership (pour rattacher au commercial)
        nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

        -- Dates importantes pour les KPIs
        nullif(j->'properties'->>'createdate','')::timestamptz              as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz     as lastmodifieddate,
        nullif(j->'properties'->>'hs_lifecyclestage_lead_date','')::timestamptz as lifecyclestage_lead_date,
        nullif(j->'properties'->>'hs_lifecyclestage_opportunity_date','')::timestamptz as lifecyclestage_opportunity_date,
        nullif(j->'properties'->>'hs_lifecyclestage_customer_date','')::timestamptz   as lifecyclestage_customer_date,

        -- Analytics HubSpot (pour conversion visite → lead)
        nullif(j->'properties'->>'hs_analytics_source','')                   as analytics_source,
        nullif(j->'properties'->>'hs_analytics_first_url','')               as analytics_first_url,
        nullif(j->'properties'->>'hs_analytics_first_referrer','')          as analytics_first_referrer,
        nullif(j->'properties'->>'hs_analytics_num_page_views','')::int     as num_page_views,
        nullif(j->'properties'->>'hs_analytics_num_visits','')::int         as num_visits,
        nullif(j->'properties'->>'hs_analytics_first_timestamp','')::timestamptz as first_analytics_ts,
        nullif(j->'properties'->>'hs_analytics_last_timestamp','')::timestamptz  as last_analytics_ts,
        nullif(j->'properties'->>'hs_analytics_first_touch_converting_campaign','') as first_touch_campaign,
        nullif(j->'properties'->>'hs_analytics_last_touch_converting_campaign','')  as last_touch_campaign,

        -- Liste de companies associées (souvent un array d’ids)
        j->'companies'                                      as companies_json,

        -- Colonne technique Airbyte
        extracted_at
    from src
)

select
    contact_id,

    -- on priorise les dates 'properties', sinon on fallback sur les dates racine
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,

    email,
    first_name,
    last_name,
    country,

    lifecycle_stage,
    lead_status,
    marketable_status,
    owner_id,

    lifecyclestage_lead_date,
    lifecyclestage_opportunity_date,
    lifecyclestage_customer_date,

    analytics_source,
    analytics_first_url,
    analytics_first_referrer,
    num_page_views,
    num_visits,
    first_analytics_ts,
    last_analytics_ts,
    first_touch_campaign,
    last_touch_campaign,

    companies_json,
    extracted_at
from base
  );
[0m13:58:20.687352 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:58:20.695013 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:58:20.697034 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_contacts"} */
alter table "warehouse"."marts_staging"."stg_contacts__dbt_tmp" rename to "stg_contacts"
[0m13:58:20.699901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:58:20.717901 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: COMMIT
[0m13:58:20.719583 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:58:20.721213 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: COMMIT
[0m13:58:20.726387 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:58:20.733944 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_contacts__dbt_backup"
[0m13:58:20.740664 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_contacts"
[0m13:58:20.742380 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_contacts"} */
drop view if exists "warehouse"."marts_staging"."stg_contacts__dbt_backup" cascade
[0m13:58:20.744910 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:58:20.747725 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_contacts (execute): 13:58:20.608170 => 13:58:20.747538
[0m13:58:20.749557 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_contacts: Close
[0m13:58:20.752753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e857442e-1740-4ca3-ae13-96fb1bb90be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca4124f5090>]}
[0m13:58:20.754811 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_contacts .................... [[32mCREATE VIEW[0m in 0.17s]
[0m13:58:20.757119 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_contacts
[0m13:58:20.760895 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.762204 [debug] [MainThread]: On master: BEGIN
[0m13:58:20.763362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:20.772891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:20.774932 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.776644 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.777973 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.779539 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:58:20.781421 [debug] [MainThread]: On master: Close
[0m13:58:20.783326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:20.784563 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m13:58:20.785935 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m13:58:20.787509 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m13:58:20.788578 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_contacts' was properly closed.
[0m13:58:20.789740 [info ] [MainThread]: 
[0m13:58:20.791368 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m13:58:20.793663 [debug] [MainThread]: Command end result
[0m13:58:20.826334 [info ] [MainThread]: 
[0m13:58:20.828652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:20.830788 [info ] [MainThread]: 
[0m13:58:20.832487 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:58:20.837391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.202815, "process_user_time": 3.045051, "process_kernel_time": 0.4901, "process_mem_max_rss": "108560", "process_in_blocks": "664", "process_out_blocks": "664"}
[0m13:58:20.839669 [debug] [MainThread]: Command `dbt run` succeeded at 13:58:20.839471 after 2.21 seconds
[0m13:58:20.840981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41bfaca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca418b17d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca41880ec20>]}
[0m13:58:20.842559 [debug] [MainThread]: Flushing usage events
[0m14:29:35.707170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d16e44880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d152c1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d152c1720>]}


============================== 14:29:35.718089 | d3483544-9592-4017-9442-3ab7bb7f65c6 ==============================
[0m14:29:35.718089 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:29:35.720702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_deal_line_items', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:29:36.083677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3483544-9592-4017-9442-3ab7bb7f65c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d153034f0>]}
[0m14:29:36.254473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3483544-9592-4017-9442-3ab7bb7f65c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d174ccca0>]}
[0m14:29:36.257107 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m14:29:36.280645 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:29:37.464121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:37.465752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:37.476955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3483544-9592-4017-9442-3ab7bb7f65c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d137199c0>]}
[0m14:29:37.569553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3483544-9592-4017-9442-3ab7bb7f65c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d13904610>]}
[0m14:29:37.571888 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m14:29:37.574079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3483544-9592-4017-9442-3ab7bb7f65c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d139047f0>]}
[0m14:29:37.577970 [info ] [MainThread]: 
[0m14:29:37.580560 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:29:37.586334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:29:37.610109 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:29:37.613145 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:29:37.615123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:37.697569 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m14:29:37.700808 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:29:37.707604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m14:29:37.711660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m14:29:37.713793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m14:29:37.715997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m14:29:37.730954 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:29:37.734352 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:29:37.738680 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:29:37.743068 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:29:37.746423 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m14:29:37.748540 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m14:29:37.750696 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m14:29:37.752433 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m14:29:37.754344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:37.756199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:37.758108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:37.760077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:37.777429 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:29:37.778014 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:29:37.779339 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:29:37.782291 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:29:37.784067 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m14:29:37.786069 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m14:29:37.787525 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:29:37.791614 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:29:37.793432 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m14:29:37.796002 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:29:37.797712 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:29:37.799773 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m14:29:37.814299 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:29:37.817230 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m14:29:37.817784 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:29:37.818351 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:29:37.818897 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:29:37.820047 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m14:29:37.822679 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m14:29:37.825504 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m14:29:37.829705 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m14:29:37.835180 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m14:29:37.836195 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m14:29:37.837837 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m14:29:37.849593 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:37.851202 [debug] [MainThread]: On master: BEGIN
[0m14:29:37.852573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:37.865899 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:29:37.867612 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:37.869530 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:29:37.939920 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m14:29:37.942519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3483544-9592-4017-9442-3ab7bb7f65c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d1356e7d0>]}
[0m14:29:37.944404 [debug] [MainThread]: On master: ROLLBACK
[0m14:29:37.946622 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:37.948250 [debug] [MainThread]: On master: BEGIN
[0m14:29:37.950520 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:29:37.952497 [debug] [MainThread]: On master: COMMIT
[0m14:29:37.954202 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:37.955659 [debug] [MainThread]: On master: COMMIT
[0m14:29:37.957829 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:29:37.959722 [debug] [MainThread]: On master: Close
[0m14:29:37.961915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:37.963748 [info ] [MainThread]: 
[0m14:29:37.974594 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deal_line_items
[0m14:29:37.976450 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deal_line_items .................. [RUN]
[0m14:29:37.978892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_deal_line_items)
[0m14:29:37.980824 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deal_line_items
[0m14:29:37.989896 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deal_line_items"
[0m14:29:38.008515 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_line_items (compile): 14:29:37.982760 => 14:29:38.008032
[0m14:29:38.010393 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deal_line_items
[0m14:29:38.046090 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deal_line_items"
[0m14:29:38.062944 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m14:29:38.064755 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: BEGIN
[0m14:29:38.066473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:38.075789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:29:38.077500 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m14:29:38.079023 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_line_items"} */

  create view "warehouse"."marts_staging"."stg_deal_line_items__dbt_tmp"
    
    
  as (
    with src as (
  select
    (_airbyte_data)::jsonb as j
  from warehouse.airbyte_internal.raw_hubspot_raw__stream_deals
),
bridge as (
  select
    (j->>'id')::bigint as deal_id,
    nullif(x.value::text,'"') as line_item_id_text
  from src
  left join lateral jsonb_array_elements_text(j->'line_items') as x(value) on true
)
select
  deal_id,
  nullif(replace(line_item_id_text,'"',''),'')::bigint as line_item_id
from bridge
where line_item_id_text is not null and line_item_id_text <> '';
  );
[0m14:29:38.082648 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 23: ...e line_item_id_text is not null and line_item_id_text <> '';
                                                                       ^

[0m14:29:38.084142 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: ROLLBACK
[0m14:29:38.086126 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_line_items (execute): 14:29:38.011946 => 14:29:38.085832
[0m14:29:38.087481 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: Close
[0m14:29:38.097325 [debug] [Thread-1 (]: Database Error in model stg_deal_line_items (models/staging/hubspot/stg_deal_line_items.sql)
  syntax error at or near ";"
  LINE 23: ...e line_item_id_text is not null and line_item_id_text <> '';
                                                                         ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deal_line_items.sql
[0m14:29:38.098963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3483544-9592-4017-9442-3ab7bb7f65c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d13623f10>]}
[0m14:29:38.100546 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_deal_line_items ......... [[31mERROR[0m in 0.12s]
[0m14:29:38.102792 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deal_line_items
[0m14:29:38.107045 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:38.110137 [debug] [MainThread]: On master: BEGIN
[0m14:29:38.112957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:38.128773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:29:38.133978 [debug] [MainThread]: On master: COMMIT
[0m14:29:38.139232 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:38.143075 [debug] [MainThread]: On master: COMMIT
[0m14:29:38.147820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:29:38.153154 [debug] [MainThread]: On master: Close
[0m14:29:38.157759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:38.161535 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m14:29:38.165180 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m14:29:38.168960 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deal_line_items' was properly closed.
[0m14:29:38.173219 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m14:29:38.176595 [info ] [MainThread]: 
[0m14:29:38.181369 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m14:29:38.186257 [debug] [MainThread]: Command end result
[0m14:29:38.383239 [info ] [MainThread]: 
[0m14:29:38.385983 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:29:38.389098 [info ] [MainThread]: 
[0m14:29:38.392418 [error] [MainThread]:   Database Error in model stg_deal_line_items (models/staging/hubspot/stg_deal_line_items.sql)
  syntax error at or near ";"
  LINE 23: ...e line_item_id_text is not null and line_item_id_text <> '';
                                                                         ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deal_line_items.sql
[0m14:29:38.397573 [info ] [MainThread]: 
[0m14:29:38.401459 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:29:38.409735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.9320471, "process_user_time": 3.287011, "process_kernel_time": 1.490763, "process_mem_max_rss": "105096", "process_in_blocks": "39992", "process_out_blocks": "664", "command_success": false}
[0m14:29:38.413597 [debug] [MainThread]: Command `dbt run` failed at 14:29:38.412984 after 2.94 seconds
[0m14:29:38.416914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d16e44880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d174ccca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x714d139ab1c0>]}
[0m14:29:38.419988 [debug] [MainThread]: Flushing usage events
[0m14:29:57.227049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e3f64580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e23e1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e23e1630>]}


============================== 14:29:57.234853 | fcdc8eb6-9be8-4286-936e-76b28e3838a9 ==============================
[0m14:29:57.234853 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:29:57.237074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_deal_line_items', 'send_anonymous_usage_stats': 'True'}
[0m14:29:57.456960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcdc8eb6-9be8-4286-936e-76b28e3838a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e2423460>]}
[0m14:29:57.551633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcdc8eb6-9be8-4286-936e-76b28e3838a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e45ed030>]}
[0m14:29:57.554634 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m14:29:57.571704 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:29:59.122806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:29:59.125878 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_deal_line_items.sql
[0m14:29:59.516101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcdc8eb6-9be8-4286-936e-76b28e3838a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e23e0100>]}
[0m14:29:59.570161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcdc8eb6-9be8-4286-936e-76b28e3838a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e0807910>]}
[0m14:29:59.572364 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m14:29:59.574811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcdc8eb6-9be8-4286-936e-76b28e3838a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e24234f0>]}
[0m14:29:59.579045 [info ] [MainThread]: 
[0m14:29:59.582392 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:29:59.586216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:29:59.609655 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:29:59.611525 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:29:59.613173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:59.633388 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m14:29:59.636328 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:29:59.642006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m14:29:59.643464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m14:29:59.645764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m14:29:59.647459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m14:29:59.654729 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:29:59.657789 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:29:59.661508 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:29:59.665759 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:29:59.667911 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m14:29:59.670078 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m14:29:59.671993 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m14:29:59.673848 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m14:29:59.675478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:59.677294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:59.679325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:59.681295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:59.691677 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:29:59.693819 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:29:59.695930 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m14:29:59.703124 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:29:59.705094 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:29:59.707184 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m14:29:59.718773 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:29:59.720604 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:29:59.723079 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m14:29:59.728906 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:29:59.731019 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:29:59.733531 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:29:59.736589 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m14:29:59.737900 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:29:59.738791 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m14:29:59.739292 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:29:59.740979 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m14:29:59.743201 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m14:29:59.747896 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m14:29:59.751891 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m14:29:59.753561 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m14:29:59.760984 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m14:29:59.763449 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m14:29:59.765535 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m14:29:59.774535 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:59.775973 [debug] [MainThread]: On master: BEGIN
[0m14:29:59.777409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:59.786500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:29:59.788211 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:59.790087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:29:59.823044 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m14:29:59.826106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcdc8eb6-9be8-4286-936e-76b28e3838a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e0a5f190>]}
[0m14:29:59.828434 [debug] [MainThread]: On master: ROLLBACK
[0m14:29:59.830580 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:59.832394 [debug] [MainThread]: On master: BEGIN
[0m14:29:59.834992 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:29:59.836873 [debug] [MainThread]: On master: COMMIT
[0m14:29:59.838563 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:59.840424 [debug] [MainThread]: On master: COMMIT
[0m14:29:59.842736 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:29:59.844632 [debug] [MainThread]: On master: Close
[0m14:29:59.847408 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:59.849789 [info ] [MainThread]: 
[0m14:29:59.860583 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deal_line_items
[0m14:29:59.862477 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deal_line_items .................. [RUN]
[0m14:29:59.864749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_deal_line_items)
[0m14:29:59.866405 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deal_line_items
[0m14:29:59.881994 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deal_line_items"
[0m14:29:59.896255 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_line_items (compile): 14:29:59.868108 => 14:29:59.895897
[0m14:29:59.898192 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deal_line_items
[0m14:29:59.934160 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deal_line_items"
[0m14:29:59.947865 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m14:29:59.949332 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: BEGIN
[0m14:29:59.950652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:59.959098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:29:59.961186 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m14:29:59.963190 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_line_items"} */

  create view "warehouse"."marts_staging"."stg_deal_line_items__dbt_tmp"
    
    
  as (
    with src as (
  select
    (_airbyte_data)::jsonb as j
  from warehouse.airbyte_internal.raw_hubspot_raw__stream_deals
),
bridge as (
  select
    (j->>'id')::bigint as deal_id,
    nullif(x.value::text,'"') as line_item_id_text
  from src
  left join lateral jsonb_array_elements_text(j->'line_items') as x(value) on true
)
select
  deal_id,
  nullif(replace(line_item_id_text,'"',''),'')::bigint as line_item_id
from bridge
where line_item_id_text is not null and line_item_id_text <> ''
  );
[0m14:29:59.998902 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:30:00.006692 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m14:30:00.008559 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_line_items"} */
alter table "warehouse"."marts_staging"."stg_deal_line_items__dbt_tmp" rename to "stg_deal_line_items"
[0m14:30:00.011639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:30:00.027114 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: COMMIT
[0m14:30:00.029700 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m14:30:00.031531 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: COMMIT
[0m14:30:00.037080 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:30:00.045046 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_deal_line_items__dbt_backup"
[0m14:30:00.051299 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m14:30:00.053511 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_line_items"} */
drop view if exists "warehouse"."marts_staging"."stg_deal_line_items__dbt_backup" cascade
[0m14:30:00.056311 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:30:00.059549 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_line_items (execute): 14:29:59.899631 => 14:30:00.059222
[0m14:30:00.061888 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: Close
[0m14:30:00.064471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcdc8eb6-9be8-4286-936e-76b28e3838a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0da412dd0>]}
[0m14:30:00.066813 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_deal_line_items ............. [[32mCREATE VIEW[0m in 0.20s]
[0m14:30:00.069347 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deal_line_items
[0m14:30:00.073130 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:00.075335 [debug] [MainThread]: On master: BEGIN
[0m14:30:00.077106 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:00.086210 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:30:00.087830 [debug] [MainThread]: On master: COMMIT
[0m14:30:00.089256 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:00.090693 [debug] [MainThread]: On master: COMMIT
[0m14:30:00.092242 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:30:00.093667 [debug] [MainThread]: On master: Close
[0m14:30:00.096040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:00.097768 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m14:30:00.099266 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m14:30:00.100666 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deal_line_items' was properly closed.
[0m14:30:00.102740 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m14:30:00.104162 [info ] [MainThread]: 
[0m14:30:00.105927 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m14:30:00.108213 [debug] [MainThread]: Command end result
[0m14:30:00.142806 [info ] [MainThread]: 
[0m14:30:00.145161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:00.147414 [info ] [MainThread]: 
[0m14:30:00.149735 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:30:00.153130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9931958, "process_user_time": 2.94642, "process_kernel_time": 0.827419, "process_mem_max_rss": "109268", "process_in_blocks": "320", "process_out_blocks": "664"}
[0m14:30:00.155321 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:00.155104 after 3.00 seconds
[0m14:30:00.157194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e3f64580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e0b1d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bd0e0807f10>]}
[0m14:30:00.159415 [debug] [MainThread]: Flushing usage events
[0m14:56:15.593688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2701f44880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27003c1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27003c1720>]}


============================== 14:56:15.605567 | 78963f92-ce0f-407c-835e-95f8d56bc821 ==============================
[0m14:56:15.605567 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:56:15.607941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_companies', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:56:15.852451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78963f92-ce0f-407c-835e-95f8d56bc821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27004034f0>]}
[0m14:56:15.981018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78963f92-ce0f-407c-835e-95f8d56bc821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27025ccca0>]}
[0m14:56:15.983775 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m14:56:16.006142 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:56:17.190113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:17.193391 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_companies.sql
[0m14:56:17.669907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78963f92-ce0f-407c-835e-95f8d56bc821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2700403550>]}
[0m14:56:17.749785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78963f92-ce0f-407c-835e-95f8d56bc821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c26fe7e7820>]}
[0m14:56:17.751857 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m14:56:17.754172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78963f92-ce0f-407c-835e-95f8d56bc821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c26fe7e79a0>]}
[0m14:56:17.757791 [info ] [MainThread]: 
[0m14:56:17.760513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:17.765045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:56:17.781850 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:56:17.783907 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:56:17.785919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:17.810714 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m14:56:17.814068 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:56:17.820126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_marts)
[0m14:56:17.822480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m14:56:17.825774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m14:56:17.832439 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:56:17.833393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m14:56:17.838433 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:56:17.842623 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:56:17.844826 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m14:56:17.848359 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:56:17.850283 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m14:56:17.852247 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m14:56:17.854448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:17.856510 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m14:56:17.858253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:17.860435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:17.863920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:17.877970 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:17.879869 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:56:17.881179 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:17.882116 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m14:56:17.884331 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:56:17.887461 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m14:56:17.889634 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:17.890126 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:17.897925 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:56:17.900250 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:56:17.901040 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m14:56:17.903349 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m14:56:17.904219 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:56:17.905723 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m14:56:17.909148 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m14:56:17.913119 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m14:56:17.916960 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m14:56:17.919110 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m14:56:17.924708 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:56:17.934155 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m14:56:17.935492 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:56:17.937111 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m14:56:17.939826 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m14:56:17.944287 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m14:56:17.953968 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:17.955776 [debug] [MainThread]: On master: BEGIN
[0m14:56:17.957152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:17.966191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:17.967848 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:17.969266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:56:18.002865 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m14:56:18.005683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78963f92-ce0f-407c-835e-95f8d56bc821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c26fc437910>]}
[0m14:56:18.007468 [debug] [MainThread]: On master: ROLLBACK
[0m14:56:18.009307 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:18.010858 [debug] [MainThread]: On master: BEGIN
[0m14:56:18.012765 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:18.014167 [debug] [MainThread]: On master: COMMIT
[0m14:56:18.015493 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:18.017372 [debug] [MainThread]: On master: COMMIT
[0m14:56:18.019511 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:56:18.021252 [debug] [MainThread]: On master: Close
[0m14:56:18.023421 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:56:18.026102 [info ] [MainThread]: 
[0m14:56:18.037184 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_companies
[0m14:56:18.039104 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_companies ........................ [RUN]
[0m14:56:18.041745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_companies)
[0m14:56:18.043529 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_companies
[0m14:56:18.054519 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_companies"
[0m14:56:18.070429 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_companies (compile): 14:56:18.045225 => 14:56:18.070062
[0m14:56:18.072019 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_companies
[0m14:56:18.106194 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_companies"
[0m14:56:18.119344 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_companies"
[0m14:56:18.121163 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_companies: BEGIN
[0m14:56:18.122893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:18.132025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:18.133715 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_companies"
[0m14:56:18.135373 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_companies: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_companies"} */

  create view "warehouse"."marts_staging"."stg_companies__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_companies
)

select
    (j->>'id')::bigint                                   as company_id,

    -- dates racine
    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    -- propriétés
    (j->'properties'->>'name')                          as name,
    nullif(j->'properties'->>'domain','')               as domain,
    nullif(j->'properties'->>'country','')              as country,
    nullif(j->'properties'->>'industry','')             as industry,

    -- dates hubspot
    nullif(j->'properties'->>'createdate','')::timestamptz          as createdate,
    nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz as lastmodifieddate,

    extracted_at
from src
  );
[0m14:56:18.148767 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:56:18.157935 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_companies"
[0m14:56:18.160011 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_companies: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_companies"} */
alter table "warehouse"."marts_staging"."stg_companies__dbt_tmp" rename to "stg_companies"
[0m14:56:18.163898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:56:18.179988 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_companies: COMMIT
[0m14:56:18.182580 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_companies"
[0m14:56:18.185336 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_companies: COMMIT
[0m14:56:18.192026 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:56:18.201933 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_companies__dbt_backup"
[0m14:56:18.207888 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_companies"
[0m14:56:18.209754 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_companies: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_companies"} */
drop view if exists "warehouse"."marts_staging"."stg_companies__dbt_backup" cascade
[0m14:56:18.212224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:56:18.215392 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_companies (execute): 14:56:18.074059 => 14:56:18.215172
[0m14:56:18.217239 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_companies: Close
[0m14:56:18.219772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78963f92-ce0f-407c-835e-95f8d56bc821', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c26fc4aa3b0>]}
[0m14:56:18.222130 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_companies ................... [[32mCREATE VIEW[0m in 0.18s]
[0m14:56:18.224636 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_companies
[0m14:56:18.228830 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:18.230458 [debug] [MainThread]: On master: BEGIN
[0m14:56:18.232276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:18.241723 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:18.243393 [debug] [MainThread]: On master: COMMIT
[0m14:56:18.245090 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:18.247173 [debug] [MainThread]: On master: COMMIT
[0m14:56:18.249059 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:56:18.250417 [debug] [MainThread]: On master: Close
[0m14:56:18.252158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:18.253821 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m14:56:18.255960 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m14:56:18.257943 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_companies' was properly closed.
[0m14:56:18.259511 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m14:56:18.261694 [info ] [MainThread]: 
[0m14:56:18.264178 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m14:56:18.266711 [debug] [MainThread]: Command end result
[0m14:56:18.306827 [info ] [MainThread]: 
[0m14:56:18.308907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:56:18.311204 [info ] [MainThread]: 
[0m14:56:18.313236 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:56:18.316090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.804528, "process_user_time": 3.055143, "process_kernel_time": 1.277968, "process_mem_max_rss": "109184", "process_in_blocks": "1504", "process_out_blocks": "664"}
[0m14:56:18.318330 [debug] [MainThread]: Command `dbt run` succeeded at 14:56:18.318115 after 2.81 seconds
[0m14:56:18.320973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2701f44880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c26fe632290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c27004034f0>]}
[0m14:56:18.322836 [debug] [MainThread]: Flushing usage events
[0m14:56:55.022362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307dded4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307dc34d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307dc34d630>]}


============================== 14:56:55.029035 | 50eabec4-04fa-49f5-a072-2f040cb1dcd9 ==============================
[0m14:56:55.029035 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:56:55.031295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_deal_pipeline', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:56:55.250416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50eabec4-04fa-49f5-a072-2f040cb1dcd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307dc393460>]}
[0m14:56:55.341373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50eabec4-04fa-49f5-a072-2f040cb1dcd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307de561030>]}
[0m14:56:55.343634 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m14:56:55.365669 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:56:56.623809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:56.627908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:56.638557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50eabec4-04fa-49f5-a072-2f040cb1dcd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307da7b5930>]}
[0m14:56:56.731816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50eabec4-04fa-49f5-a072-2f040cb1dcd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307da990580>]}
[0m14:56:56.733672 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m14:56:56.735722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50eabec4-04fa-49f5-a072-2f040cb1dcd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307da990760>]}
[0m14:56:56.739180 [info ] [MainThread]: 
[0m14:56:56.741490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:56.746574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:56:56.767690 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:56:56.769680 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:56:56.772268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:56.798021 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m14:56:56.800704 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:56:56.806417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m14:56:56.808056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m14:56:56.811421 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m14:56:56.820561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m14:56:56.821454 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:56:56.824384 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:56:56.830771 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:56:56.836173 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:56:56.839000 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m14:56:56.840601 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m14:56:56.842701 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m14:56:56.844262 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m14:56:56.846196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:56.847740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:56.849557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:56.851098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:56.862902 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:56.866835 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:56:56.867410 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:56.871414 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m14:56:56.872984 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:56.875962 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:56.876410 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:56:56.879414 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:56:56.881445 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:56:56.882996 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:56:56.883751 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m14:56:56.885499 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m14:56:56.887131 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m14:56:56.890176 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m14:56:56.897250 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:56:56.899913 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m14:56:56.902538 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m14:56:56.903766 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:56:56.907021 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:56:56.908320 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m14:56:56.910948 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m14:56:56.913513 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m14:56:56.919534 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m14:56:56.921202 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m14:56:56.931427 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:56.932954 [debug] [MainThread]: On master: BEGIN
[0m14:56:56.934318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:56.968717 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:56.970373 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:56.971814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:56:57.025388 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m14:56:57.028080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50eabec4-04fa-49f5-a072-2f040cb1dcd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307da782b60>]}
[0m14:56:57.030112 [debug] [MainThread]: On master: ROLLBACK
[0m14:56:57.032185 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:57.033755 [debug] [MainThread]: On master: BEGIN
[0m14:56:57.036181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:57.038146 [debug] [MainThread]: On master: COMMIT
[0m14:56:57.039717 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:57.041335 [debug] [MainThread]: On master: COMMIT
[0m14:56:57.043270 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:56:57.045017 [debug] [MainThread]: On master: Close
[0m14:56:57.046999 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:56:57.049097 [info ] [MainThread]: 
[0m14:56:57.061800 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deal_pipeline
[0m14:56:57.063439 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deal_pipeline .................... [RUN]
[0m14:56:57.065317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_deal_pipeline)
[0m14:56:57.066988 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deal_pipeline
[0m14:56:57.076488 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deal_pipeline"
[0m14:56:57.087704 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_pipeline (compile): 14:56:57.068629 => 14:56:57.087334
[0m14:56:57.089141 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deal_pipeline
[0m14:56:57.127342 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deal_pipeline"
[0m14:56:57.144284 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:56:57.146456 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: BEGIN
[0m14:56:57.148508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:56:57.158433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:56:57.159968 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:56:57.161578 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_pipeline"} */

  create view "warehouse"."marts_staging"."stg_deal_pipeline__dbt_tmp"
    
    
  as (
    

select
  (_airbyte_data->>'id')::text            as pipeline_id,
  (_airbyte_data->>'label')::text         as pipeline_label,
  (_airbyte_data->>'archived')::boolean   as archived
from warehouse.airbyte_internal.raw_hubspot_raw__stream_deal_pipeline;
  );
[0m14:56:57.163827 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 13: ...ouse.airbyte_internal.raw_hubspot_raw__stream_deal_pipeline;
                                                                       ^

[0m14:56:57.165548 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: ROLLBACK
[0m14:56:57.167428 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_pipeline (execute): 14:56:57.091005 => 14:56:57.167146
[0m14:56:57.168882 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: Close
[0m14:56:57.182127 [debug] [Thread-1 (]: Database Error in model stg_deal_pipeline (models/staging/hubspot/stg_deal_pipeline.sql)
  syntax error at or near ";"
  LINE 13: ...ouse.airbyte_internal.raw_hubspot_raw__stream_deal_pipeline;
                                                                         ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deal_pipeline.sql
[0m14:56:57.183844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50eabec4-04fa-49f5-a072-2f040cb1dcd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307da4c1a50>]}
[0m14:56:57.186088 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_deal_pipeline ........... [[31mERROR[0m in 0.12s]
[0m14:56:57.188349 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deal_pipeline
[0m14:56:57.193566 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:57.195475 [debug] [MainThread]: On master: BEGIN
[0m14:56:57.197245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:57.211729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:57.213766 [debug] [MainThread]: On master: COMMIT
[0m14:56:57.215368 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:57.217025 [debug] [MainThread]: On master: COMMIT
[0m14:56:57.218907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:56:57.220599 [debug] [MainThread]: On master: Close
[0m14:56:57.222481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:57.223933 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m14:56:57.225219 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m14:56:57.226696 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m14:56:57.228158 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deal_pipeline' was properly closed.
[0m14:56:57.229892 [info ] [MainThread]: 
[0m14:56:57.232240 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m14:56:57.234680 [debug] [MainThread]: Command end result
[0m14:56:57.338648 [info ] [MainThread]: 
[0m14:56:57.341092 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:57.343994 [info ] [MainThread]: 
[0m14:56:57.347238 [error] [MainThread]:   Database Error in model stg_deal_pipeline (models/staging/hubspot/stg_deal_pipeline.sql)
  syntax error at or near ";"
  LINE 13: ...ouse.airbyte_internal.raw_hubspot_raw__stream_deal_pipeline;
                                                                         ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deal_pipeline.sql
[0m14:56:57.350826 [info ] [MainThread]: 
[0m14:56:57.354406 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:56:57.361449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3974233, "process_user_time": 2.619206, "process_kernel_time": 0.569041, "process_mem_max_rss": "104468", "process_in_blocks": "3960", "process_out_blocks": "664", "command_success": false}
[0m14:56:57.364421 [debug] [MainThread]: Command `dbt run` failed at 14:56:57.364147 after 2.40 seconds
[0m14:56:57.366503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307dded4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307de561030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7307da9906a0>]}
[0m14:56:57.369406 [debug] [MainThread]: Flushing usage events
[0m14:57:11.649969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5e668880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5cae9720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5cae96c0>]}


============================== 14:57:11.657158 | e0f04d7e-b045-44d7-962d-601a40642003 ==============================
[0m14:57:11.657158 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:57:11.659163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_deal_pipeline', 'send_anonymous_usage_stats': 'True'}
[0m14:57:11.888950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0f04d7e-b045-44d7-962d-601a40642003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5cb2b4c0>]}
[0m14:57:12.006821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0f04d7e-b045-44d7-962d-601a40642003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5ecf2170>]}
[0m14:57:12.009237 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m14:57:12.026197 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:57:13.097782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:57:13.100586 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_deal_pipeline.sql
[0m14:57:13.292810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0f04d7e-b045-44d7-962d-601a40642003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc58c780d0>]}
[0m14:57:13.407365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0f04d7e-b045-44d7-962d-601a40642003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5b160490>]}
[0m14:57:13.409322 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m14:57:13.411626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0f04d7e-b045-44d7-962d-601a40642003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5b160490>]}
[0m14:57:13.414992 [info ] [MainThread]: 
[0m14:57:13.417683 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:57:13.421285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:57:13.433317 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:57:13.434945 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:57:13.436512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:13.452145 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m14:57:13.455349 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:57:13.462543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m14:57:13.464220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m14:57:13.465581 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m14:57:13.467776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m14:57:13.474589 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:57:13.477994 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:57:13.481671 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:57:13.486069 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:57:13.488301 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m14:57:13.490177 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m14:57:13.492119 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m14:57:13.493745 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m14:57:13.495340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:57:13.497239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:13.499223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:13.501257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:57:13.514112 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:57:13.515705 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:57:13.516377 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:57:13.517864 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:57:13.518422 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:57:13.519390 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m14:57:13.520607 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:57:13.521414 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m14:57:13.522786 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:57:13.525968 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:57:13.528364 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m14:57:13.529880 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:57:13.530431 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m14:57:13.530940 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:57:13.534538 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m14:57:13.536658 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:57:13.539022 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m14:57:13.541033 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m14:57:13.541587 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:57:13.543063 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m14:57:13.545150 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m14:57:13.549425 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m14:57:13.551651 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m14:57:13.555075 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m14:57:13.564655 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:13.566421 [debug] [MainThread]: On master: BEGIN
[0m14:57:13.567930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:57:13.577367 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:13.579374 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:13.580904 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:57:13.615161 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m14:57:13.617855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0f04d7e-b045-44d7-962d-601a40642003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5cb2b670>]}
[0m14:57:13.619889 [debug] [MainThread]: On master: ROLLBACK
[0m14:57:13.621974 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:13.623575 [debug] [MainThread]: On master: BEGIN
[0m14:57:13.625643 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:13.627193 [debug] [MainThread]: On master: COMMIT
[0m14:57:13.629068 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:13.630687 [debug] [MainThread]: On master: COMMIT
[0m14:57:13.632755 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:57:13.634394 [debug] [MainThread]: On master: Close
[0m14:57:13.636615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:57:13.638677 [info ] [MainThread]: 
[0m14:57:13.649508 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deal_pipeline
[0m14:57:13.651126 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deal_pipeline .................... [RUN]
[0m14:57:13.653615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_deal_pipeline)
[0m14:57:13.655589 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deal_pipeline
[0m14:57:13.665249 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deal_pipeline"
[0m14:57:13.678369 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_pipeline (compile): 14:57:13.657256 => 14:57:13.677974
[0m14:57:13.680376 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deal_pipeline
[0m14:57:13.714584 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deal_pipeline"
[0m14:57:13.727700 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:57:13.729243 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: BEGIN
[0m14:57:13.730635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:57:13.742478 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:57:13.744301 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:57:13.746454 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_pipeline"} */

  create view "warehouse"."marts_staging"."stg_deal_pipeline__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_deal_pipeline
),

pipelines as (
    select
        (j->>'id')         as pipeline_id,
        (j->>'label')      as pipeline_label,
        extracted_at,
        j->'stages'        as stages_json
    from src
),

stages as (
    select
        p.pipeline_id,
        p.pipeline_label,
        (s->>'id')          as stage_id,
        (s->>'label')       as stage_label,
        coalesce((s->'metadata'->>'isClosed')::boolean, false) as is_closed_stage,
        (s->'metadata'->>'probability')::numeric                as stage_probability,
        (s->>'displayOrder')::int                               as display_order,
        p.extracted_at
    from pipelines p
    left join lateral jsonb_array_elements(p.stages_json) as s on true
)

select *
from stages
  );
[0m14:57:13.749562 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airbyte_internal.raw_hubspot_raw__stream_deal_pipeline" does not exist
LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                  ^

[0m14:57:13.751462 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: ROLLBACK
[0m14:57:13.754192 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_pipeline (execute): 14:57:13.681738 => 14:57:13.753840
[0m14:57:13.756064 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: Close
[0m14:57:13.760123 [debug] [Thread-1 (]: Database Error in model stg_deal_pipeline (models/staging/hubspot/stg_deal_pipeline.sql)
  relation "airbyte_internal.raw_hubspot_raw__stream_deal_pipeline" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deal_pipeline.sql
[0m14:57:13.762566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0f04d7e-b045-44d7-962d-601a40642003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc58a53a90>]}
[0m14:57:13.764668 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_deal_pipeline ........... [[31mERROR[0m in 0.11s]
[0m14:57:13.767228 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deal_pipeline
[0m14:57:13.771480 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:13.773196 [debug] [MainThread]: On master: BEGIN
[0m14:57:13.774688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:57:13.783409 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:57:13.785393 [debug] [MainThread]: On master: COMMIT
[0m14:57:13.787090 [debug] [MainThread]: Using postgres connection "master"
[0m14:57:13.789114 [debug] [MainThread]: On master: COMMIT
[0m14:57:13.791496 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:57:13.793139 [debug] [MainThread]: On master: Close
[0m14:57:13.795260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:57:13.796946 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m14:57:13.798361 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m14:57:13.799879 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m14:57:13.801356 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deal_pipeline' was properly closed.
[0m14:57:13.803120 [info ] [MainThread]: 
[0m14:57:13.805198 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m14:57:13.807557 [debug] [MainThread]: Command end result
[0m14:57:13.842764 [info ] [MainThread]: 
[0m14:57:13.845132 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:57:13.847088 [info ] [MainThread]: 
[0m14:57:13.848919 [error] [MainThread]:   Database Error in model stg_deal_pipeline (models/staging/hubspot/stg_deal_pipeline.sql)
  relation "airbyte_internal.raw_hubspot_raw__stream_deal_pipeline" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deal_pipeline.sql
[0m14:57:13.851034 [info ] [MainThread]: 
[0m14:57:13.853369 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:57:13.856397 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2690375, "process_user_time": 3.010115, "process_kernel_time": 0.672044, "process_mem_max_rss": "107988", "process_in_blocks": "2184", "process_out_blocks": "664", "command_success": false}
[0m14:57:13.858418 [debug] [MainThread]: Command `dbt run` failed at 14:57:13.858189 after 2.27 seconds
[0m14:57:13.860306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5e668880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc5ad8dea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75dc58c60940>]}
[0m14:57:13.862088 [debug] [MainThread]: Flushing usage events
[0m14:58:05.749606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9262bcc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c924a317b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c924a30a60>]}


============================== 14:58:05.757553 | 45001ed7-1b22-474d-88e5-706a8d770541 ==============================
[0m14:58:05.757553 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:58:05.760099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_deal_pipeline', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:58:05.968340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45001ed7-1b22-474d-88e5-706a8d770541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c92477b430>]}
[0m14:58:06.061215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45001ed7-1b22-474d-88e5-706a8d770541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c926949060>]}
[0m14:58:06.064031 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m14:58:06.081465 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:58:07.127847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:07.129948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:07.139661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45001ed7-1b22-474d-88e5-706a8d770541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c922b9d900>]}
[0m14:58:07.192631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45001ed7-1b22-474d-88e5-706a8d770541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c922d64550>]}
[0m14:58:07.194625 [info ] [MainThread]: Found 47 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m14:58:07.196588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45001ed7-1b22-474d-88e5-706a8d770541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c922d64730>]}
[0m14:58:07.199832 [info ] [MainThread]: 
[0m14:58:07.202444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:07.206319 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:58:07.218947 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:58:07.220751 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:58:07.222380 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:07.235843 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m14:58:07.238608 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:58:07.244333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m14:58:07.246151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m14:58:07.247936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m14:58:07.254746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m14:58:07.255460 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:58:07.259087 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:58:07.263067 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:58:07.266872 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:58:07.268731 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m14:58:07.270736 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m14:58:07.272404 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m14:58:07.273899 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m14:58:07.275453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:07.277350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:07.279076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:07.280378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:07.290325 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:58:07.292259 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:58:07.294019 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m14:58:07.296803 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:58:07.298306 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:58:07.298821 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:58:07.299814 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:58:07.300461 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:58:07.301645 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:58:07.303305 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:58:07.305213 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m14:58:07.307736 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m14:58:07.309780 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m14:58:07.311686 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m14:58:07.315036 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m14:58:07.317735 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:58:07.321622 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:58:07.322523 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:58:07.323734 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m14:58:07.326300 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m14:58:07.328875 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m14:58:07.331625 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m14:58:07.333519 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m14:58:07.335270 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m14:58:07.346530 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.348556 [debug] [MainThread]: On master: BEGIN
[0m14:58:07.350347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:07.360136 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:58:07.361822 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.363226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:07.396694 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m14:58:07.399152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45001ed7-1b22-474d-88e5-706a8d770541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9229edc30>]}
[0m14:58:07.401055 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:07.402996 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.404559 [debug] [MainThread]: On master: BEGIN
[0m14:58:07.406723 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:58:07.408474 [debug] [MainThread]: On master: COMMIT
[0m14:58:07.410030 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.411565 [debug] [MainThread]: On master: COMMIT
[0m14:58:07.413586 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:58:07.415085 [debug] [MainThread]: On master: Close
[0m14:58:07.416759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:07.418609 [info ] [MainThread]: 
[0m14:58:07.430313 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deal_pipeline
[0m14:58:07.432450 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deal_pipeline .................... [RUN]
[0m14:58:07.435241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_deal_pipeline)
[0m14:58:07.437636 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deal_pipeline
[0m14:58:07.445923 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:07.460886 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_pipeline (compile): 14:58:07.439055 => 14:58:07.460380
[0m14:58:07.463242 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deal_pipeline
[0m14:58:07.497857 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:07.511206 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:07.513185 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: BEGIN
[0m14:58:07.514670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:07.523593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:58:07.525909 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:07.527727 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_pipeline"} */

  create view "warehouse"."marts_staging"."stg_deal_pipeline__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_deal_pipeline
),

pipelines as (
    select
        (j->>'id')         as pipeline_id,
        (j->>'label')      as pipeline_label,
        extracted_at,
        j->'stages'        as stages_json
    from src
),

stages as (
    select
        p.pipeline_id,
        p.pipeline_label,
        (s->>'id')          as stage_id,
        (s->>'label')       as stage_label,
        coalesce((s->'metadata'->>'isClosed')::boolean, false) as is_closed_stage,
        (s->'metadata'->>'probability')::numeric                as stage_probability,
        (s->>'displayOrder')::int                               as display_order,
        p.extracted_at
    from pipelines p
    left join lateral jsonb_array_elements(p.stages_json) as s on true
)

select *
from stages
  );
[0m14:58:07.530370 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airbyte_internal.raw_hubspot_raw__stream_deal_pipeline" does not exist
LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                  ^

[0m14:58:07.532630 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: ROLLBACK
[0m14:58:07.534680 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_pipeline (execute): 14:58:07.465058 => 14:58:07.534386
[0m14:58:07.536228 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: Close
[0m14:58:07.540024 [debug] [Thread-1 (]: Database Error in model stg_deal_pipeline (models/staging/hubspot/stg_deal_pipeline.sql)
  relation "airbyte_internal.raw_hubspot_raw__stream_deal_pipeline" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deal_pipeline.sql
[0m14:58:07.542102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45001ed7-1b22-474d-88e5-706a8d770541', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9228a9a50>]}
[0m14:58:07.543770 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_deal_pipeline ........... [[31mERROR[0m in 0.11s]
[0m14:58:07.546077 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deal_pipeline
[0m14:58:07.549846 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.551377 [debug] [MainThread]: On master: BEGIN
[0m14:58:07.553250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:07.562038 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:58:07.563430 [debug] [MainThread]: On master: COMMIT
[0m14:58:07.564561 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:07.565875 [debug] [MainThread]: On master: COMMIT
[0m14:58:07.567653 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:58:07.569455 [debug] [MainThread]: On master: Close
[0m14:58:07.571259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:07.572672 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m14:58:07.574680 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m14:58:07.576371 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m14:58:07.577693 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deal_pipeline' was properly closed.
[0m14:58:07.579048 [info ] [MainThread]: 
[0m14:58:07.580936 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m14:58:07.583228 [debug] [MainThread]: Command end result
[0m14:58:07.664938 [info ] [MainThread]: 
[0m14:58:07.667406 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:58:07.669444 [info ] [MainThread]: 
[0m14:58:07.671441 [error] [MainThread]:   Database Error in model stg_deal_pipeline (models/staging/hubspot/stg_deal_pipeline.sql)
  relation "airbyte_internal.raw_hubspot_raw__stream_deal_pipeline" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_deal_pipeline.sql
[0m14:58:07.673590 [info ] [MainThread]: 
[0m14:58:07.675890 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:58:07.678664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9938943, "process_user_time": 2.582939, "process_kernel_time": 0.439995, "process_mem_max_rss": "105816", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m14:58:07.681057 [debug] [MainThread]: Command `dbt run` failed at 14:58:07.680717 after 2.00 seconds
[0m14:58:07.682621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c9262bcc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c926949060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71c922e26530>]}
[0m14:58:07.683915 [debug] [MainThread]: Flushing usage events
[0m14:58:27.606151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6387b08880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6385f71780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6385f71720>]}


============================== 14:58:27.612836 | a9fccca5-7f8f-48d9-8ec4-eaf3d0da5676 ==============================
[0m14:58:27.612836 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:58:27.614798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_deal_pipeline', 'send_anonymous_usage_stats': 'True'}
[0m14:58:27.815312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9fccca5-7f8f-48d9-8ec4-eaf3d0da5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6385fb74f0>]}
[0m14:58:27.902267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9fccca5-7f8f-48d9-8ec4-eaf3d0da5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6388184ca0>]}
[0m14:58:27.904433 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m14:58:27.921944 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:58:28.998529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:58:29.002357 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/sources/src_hubspot.yml
[0m14:58:29.004267 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_deal_pipeline.sql
[0m14:58:29.635882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9fccca5-7f8f-48d9-8ec4-eaf3d0da5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d638212c640>]}
[0m14:58:29.690908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9fccca5-7f8f-48d9-8ec4-eaf3d0da5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63845a4640>]}
[0m14:58:29.693341 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m14:58:29.695987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9fccca5-7f8f-48d9-8ec4-eaf3d0da5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63845a4850>]}
[0m14:58:29.701254 [info ] [MainThread]: 
[0m14:58:29.704372 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:29.708026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m14:58:29.726790 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m14:58:29.729216 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:58:29.731459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:29.746657 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m14:58:29.749660 [debug] [ThreadPool]: On list_warehouse: Close
[0m14:58:29.755725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m14:58:29.757746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m14:58:29.760202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m14:58:29.767822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m14:58:29.776685 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:58:29.783676 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:58:29.791695 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:58:29.799560 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:58:29.803715 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m14:58:29.807154 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m14:58:29.810271 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m14:58:29.813977 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m14:58:29.817737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:29.820884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:29.824255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:29.827800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:29.853852 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:58:29.857397 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m14:58:29.858909 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:58:29.860916 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:58:29.862795 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m14:58:29.864029 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:58:29.866243 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m14:58:29.869116 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m14:58:29.873775 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m14:58:29.876692 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m14:58:29.877725 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:58:29.879418 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m14:58:29.881436 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m14:58:29.885861 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m14:58:29.887894 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:58:29.891755 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m14:58:29.892505 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:58:29.894500 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m14:58:29.895133 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:58:29.899305 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m14:58:29.901559 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m14:58:29.903748 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m14:58:29.905749 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m14:58:29.909017 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m14:58:29.920356 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:29.922284 [debug] [MainThread]: On master: BEGIN
[0m14:58:29.924143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:29.933410 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:58:29.935212 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:29.937062 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:29.973750 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m14:58:29.976403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9fccca5-7f8f-48d9-8ec4-eaf3d0da5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63820ef5e0>]}
[0m14:58:29.978884 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:29.981608 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:29.984135 [debug] [MainThread]: On master: BEGIN
[0m14:58:29.986759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:58:29.989161 [debug] [MainThread]: On master: COMMIT
[0m14:58:29.991248 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:29.993720 [debug] [MainThread]: On master: COMMIT
[0m14:58:29.996226 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:58:29.999458 [debug] [MainThread]: On master: Close
[0m14:58:30.002718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:30.006130 [info ] [MainThread]: 
[0m14:58:30.021935 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deal_pipeline
[0m14:58:30.024551 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deal_pipeline .................... [RUN]
[0m14:58:30.027869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_deal_pipeline)
[0m14:58:30.030765 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deal_pipeline
[0m14:58:30.045066 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:30.066769 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_pipeline (compile): 14:58:30.033673 => 14:58:30.065986
[0m14:58:30.069416 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deal_pipeline
[0m14:58:30.108721 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:30.119950 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:30.121540 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: BEGIN
[0m14:58:30.123186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:30.132090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:58:30.133753 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:30.135458 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_pipeline"} */

  create view "warehouse"."marts_staging"."stg_deal_pipeline__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_deal_pipelines
),

pipelines as (
    select
        (j->>'id')         as pipeline_id,
        (j->>'label')      as pipeline_label,
        extracted_at,
        j->'stages'        as stages_json
    from src
),

stages as (
    select
        p.pipeline_id,
        p.pipeline_label,
        (s->>'id')          as stage_id,
        (s->>'label')       as stage_label,
        coalesce((s->'metadata'->>'isClosed')::boolean, false) as is_closed_stage,
        (s->'metadata'->>'probability')::numeric                as stage_probability,
        (s->>'displayOrder')::int                               as display_order,
        p.extracted_at
    from pipelines p
    left join lateral jsonb_array_elements(p.stages_json) as s on true
)

select *
from stages
  );
[0m14:58:30.143819 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:58:30.151156 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:30.153138 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_pipeline"} */
alter table "warehouse"."marts_staging"."stg_deal_pipeline__dbt_tmp" rename to "stg_deal_pipeline"
[0m14:58:30.155630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:58:30.170796 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: COMMIT
[0m14:58:30.172758 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:30.174528 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: COMMIT
[0m14:58:30.180562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:58:30.188313 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_deal_pipeline__dbt_backup"
[0m14:58:30.194099 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_pipeline"
[0m14:58:30.196082 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_pipeline"} */
drop view if exists "warehouse"."marts_staging"."stg_deal_pipeline__dbt_backup" cascade
[0m14:58:30.198583 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:58:30.201659 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_pipeline (execute): 14:58:30.071464 => 14:58:30.201447
[0m14:58:30.203552 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_pipeline: Close
[0m14:58:30.205745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9fccca5-7f8f-48d9-8ec4-eaf3d0da5676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d638219b400>]}
[0m14:58:30.208020 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_deal_pipeline ............... [[32mCREATE VIEW[0m in 0.18s]
[0m14:58:30.210721 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deal_pipeline
[0m14:58:30.214803 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:30.216516 [debug] [MainThread]: On master: BEGIN
[0m14:58:30.218057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:30.227764 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:58:30.229943 [debug] [MainThread]: On master: COMMIT
[0m14:58:30.231755 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:30.233836 [debug] [MainThread]: On master: COMMIT
[0m14:58:30.236246 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:58:30.238014 [debug] [MainThread]: On master: Close
[0m14:58:30.240654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:30.242076 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m14:58:30.243519 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m14:58:30.244988 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m14:58:30.246702 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deal_pipeline' was properly closed.
[0m14:58:30.248267 [info ] [MainThread]: 
[0m14:58:30.250807 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m14:58:30.253510 [debug] [MainThread]: Command end result
[0m14:58:30.283879 [info ] [MainThread]: 
[0m14:58:30.286099 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:30.288624 [info ] [MainThread]: 
[0m14:58:30.290709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:58:30.293350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8703895, "process_user_time": 3.306071, "process_kernel_time": 0.504315, "process_mem_max_rss": "110772", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m14:58:30.295252 [debug] [MainThread]: Command `dbt run` succeeded at 14:58:30.295032 after 2.87 seconds
[0m14:58:30.296762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6387b08880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6385f735e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d63821b2050>]}
[0m14:58:30.298091 [debug] [MainThread]: Flushing usage events
[0m15:02:08.770897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b5d34370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b44a57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b44a4a60>]}


============================== 15:02:08.779768 | 010b41df-a51e-419b-8d32-756323323504 ==============================
[0m15:02:08.779768 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:02:08.781849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_products', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:02:09.117422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '010b41df-a51e-419b-8d32-756323323504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b41f3430>]}
[0m15:02:09.234584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '010b41df-a51e-419b-8d32-756323323504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b63bd060>]}
[0m15:02:09.237756 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:02:09.266329 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:02:11.230296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:11.234696 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_products.sql
[0m15:02:11.807314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '010b41df-a51e-419b-8d32-756323323504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b2546c80>]}
[0m15:02:11.885730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '010b41df-a51e-419b-8d32-756323323504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b25d75e0>]}
[0m15:02:11.888006 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:02:11.890436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010b41df-a51e-419b-8d32-756323323504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b25d76d0>]}
[0m15:02:11.895032 [info ] [MainThread]: 
[0m15:02:11.898253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:02:11.902500 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:02:11.928839 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:02:11.947215 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:02:11.949662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:11.993577 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:02:11.998158 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:02:12.004729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m15:02:12.006772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:02:12.008845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:02:12.016239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:02:12.019053 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:02:12.023154 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:02:12.027927 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:02:12.031977 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:02:12.033987 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:02:12.035730 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:02:12.037635 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:02:12.039360 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:02:12.041413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:12.043137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:12.044987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:12.047037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:12.064871 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:02:12.068295 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:02:12.068945 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:02:12.069530 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:02:12.070043 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:02:12.071247 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:02:12.072705 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:02:12.074543 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:02:12.076085 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:02:12.077593 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:02:12.079267 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:02:12.082429 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:02:12.090244 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:02:12.093602 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:02:12.094766 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m15:02:12.095598 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:02:12.096430 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:02:12.098236 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:02:12.100726 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:02:12.103690 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:02:12.107362 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:02:12.111245 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:02:12.112863 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:02:12.114680 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:02:12.128823 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:12.130541 [debug] [MainThread]: On master: BEGIN
[0m15:02:12.132253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:12.143979 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:02:12.145961 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:12.147788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:02:12.199297 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m15:02:12.202654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '010b41df-a51e-419b-8d32-756323323504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b032e2c0>]}
[0m15:02:12.204529 [debug] [MainThread]: On master: ROLLBACK
[0m15:02:12.206481 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:12.208199 [debug] [MainThread]: On master: BEGIN
[0m15:02:12.210456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:02:12.211897 [debug] [MainThread]: On master: COMMIT
[0m15:02:12.213491 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:12.215087 [debug] [MainThread]: On master: COMMIT
[0m15:02:12.217606 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:02:12.219546 [debug] [MainThread]: On master: Close
[0m15:02:12.222100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:02:12.224544 [info ] [MainThread]: 
[0m15:02:12.237594 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_products
[0m15:02:12.239538 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_products ......................... [RUN]
[0m15:02:12.242673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_products)
[0m15:02:12.245254 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_products
[0m15:02:12.256727 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_products"
[0m15:02:12.272326 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_products (compile): 15:02:12.247308 => 15:02:12.271891
[0m15:02:12.274356 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_products
[0m15:02:12.312876 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_products"
[0m15:02:12.328794 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_products"
[0m15:02:12.330778 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_products: BEGIN
[0m15:02:12.332885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:12.350607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:02:12.352879 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_products"
[0m15:02:12.355553 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_products"} */

  create view "warehouse"."marts_staging"."stg_products__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_products
)

select
    (j->>'id')::bigint                               as product_id,

    nullif(j->>'createdAt','')::timestamptz         as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz         as updated_at_raw,

    (j->'properties'->>'name')                      as name,
    nullif(j->'properties'->>'hs_status','')        as status,
    nullif(j->'properties'->>'price','')::numeric   as price,
    nullif(j->'properties'->>'hs_price_eur','')::numeric as price_eur,

    nullif(j->'properties'->>'createdate','')::timestamptz          as createdate,
    nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz as lastmodifieddate,

    extracted_at
from src
  );
[0m15:02:12.370456 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:02:12.378552 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_products"
[0m15:02:12.380263 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_products"} */
alter table "warehouse"."marts_staging"."stg_products__dbt_tmp" rename to "stg_products"
[0m15:02:12.382566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:02:12.397982 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_products: COMMIT
[0m15:02:12.400628 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_products"
[0m15:02:12.403002 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_products: COMMIT
[0m15:02:12.407343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:02:12.417270 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_products__dbt_backup"
[0m15:02:12.424208 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_products"
[0m15:02:12.426339 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_products"} */
drop view if exists "warehouse"."marts_staging"."stg_products__dbt_backup" cascade
[0m15:02:12.431871 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:02:12.435927 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_products (execute): 15:02:12.275673 => 15:02:12.435604
[0m15:02:12.438156 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_products: Close
[0m15:02:12.441460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '010b41df-a51e-419b-8d32-756323323504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b02a21d0>]}
[0m15:02:12.444481 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_products .................... [[32mCREATE VIEW[0m in 0.20s]
[0m15:02:12.447250 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_products
[0m15:02:12.451306 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:12.453036 [debug] [MainThread]: On master: BEGIN
[0m15:02:12.454820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:12.470331 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:02:12.472600 [debug] [MainThread]: On master: COMMIT
[0m15:02:12.474810 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:12.476293 [debug] [MainThread]: On master: COMMIT
[0m15:02:12.478160 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:02:12.479811 [debug] [MainThread]: On master: Close
[0m15:02:12.482094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:12.483611 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:02:12.485188 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_products' was properly closed.
[0m15:02:12.486922 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:02:12.489251 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:02:12.492015 [info ] [MainThread]: 
[0m15:02:12.495038 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m15:02:12.498441 [debug] [MainThread]: Command end result
[0m15:02:12.549216 [info ] [MainThread]: 
[0m15:02:12.552285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:12.554810 [info ] [MainThread]: 
[0m15:02:12.557709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:02:12.563055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8829308, "process_user_time": 3.661049, "process_kernel_time": 1.27711, "process_mem_max_rss": "108852", "process_in_blocks": "82288", "process_out_blocks": "664"}
[0m15:02:12.566023 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:12.565628 after 3.89 seconds
[0m15:02:12.568558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b5d34370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b28eae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a20b41f3430>]}
[0m15:02:12.571489 [debug] [MainThread]: Flushing usage events
[0m15:02:41.476367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37bed4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a34d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a34d720>]}


============================== 15:02:41.486930 | e728b2ac-716e-4d54-8aed-3f6dfa818a92 ==============================
[0m15:02:41.486930 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:02:41.490222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_line_items', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:02:41.825621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e728b2ac-716e-4d54-8aed-3f6dfa818a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a3934f0>]}
[0m15:02:41.964178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e728b2ac-716e-4d54-8aed-3f6dfa818a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37c560ca0>]}
[0m15:02:41.966831 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:02:41.992202 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:02:43.770674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:43.773128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:43.790707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e728b2ac-716e-4d54-8aed-3f6dfa818a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3787ad810>]}
[0m15:02:43.879148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e728b2ac-716e-4d54-8aed-3f6dfa818a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37897c430>]}
[0m15:02:43.883193 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:02:43.886657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e728b2ac-716e-4d54-8aed-3f6dfa818a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37897c640>]}
[0m15:02:43.893082 [warn ] [MainThread]: The selection criterion 'stg_line_items' does not match any nodes
[0m15:02:43.898710 [info ] [MainThread]: 
[0m15:02:43.902715 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:02:43.906469 [debug] [MainThread]: Command end result
[0m15:02:43.969519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5953166, "process_user_time": 3.589993, "process_kernel_time": 1.207469, "process_mem_max_rss": "99132", "process_in_blocks": "34672", "process_out_blocks": "608"}
[0m15:02:43.972432 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:43.972116 after 2.60 seconds
[0m15:02:43.974587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37bed4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc378a3b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37c560ca0>]}
[0m15:02:43.976780 [debug] [MainThread]: Flushing usage events
[0m15:03:24.952246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a09594610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a079fd6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a079fd690>]}


============================== 15:03:24.963105 | 33e2bea4-0585-457a-9b0f-8dcdf400f782 ==============================
[0m15:03:24.963105 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:03:24.966316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_deal_line_items', 'send_anonymous_usage_stats': 'True'}
[0m15:03:25.239734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e2bea4-0585-457a-9b0f-8dcdf400f782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a07a43490>]}
[0m15:03:25.340190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33e2bea4-0585-457a-9b0f-8dcdf400f782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a09c11030>]}
[0m15:03:25.342694 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:03:25.359890 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:03:26.297726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:26.299825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:26.308964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e2bea4-0585-457a-9b0f-8dcdf400f782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a05e617b0>]}
[0m15:03:26.356558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e2bea4-0585-457a-9b0f-8dcdf400f782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a060303d0>]}
[0m15:03:26.359355 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:03:26.362141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e2bea4-0585-457a-9b0f-8dcdf400f782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a060305e0>]}
[0m15:03:26.365739 [info ] [MainThread]: 
[0m15:03:26.368233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:03:26.371221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:03:26.383413 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:03:26.384920 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:03:26.386525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:26.415520 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:03:26.417958 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:03:26.423614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m15:03:26.425185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:03:26.426539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:03:26.428310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:03:26.434499 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:03:26.437552 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:03:26.441581 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:03:26.445532 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:03:26.447637 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:03:26.449077 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:03:26.450844 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:03:26.452285 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:03:26.453664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:26.455000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:26.456606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:26.458131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:26.467825 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:03:26.469077 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:03:26.470268 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:03:26.471678 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:03:26.472143 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:03:26.473074 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:03:26.473841 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:03:26.475392 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:03:26.476515 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:03:26.477898 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:03:26.480143 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:03:26.482310 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:03:26.484514 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:03:26.486981 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:03:26.488285 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:03:26.488787 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:03:26.489736 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:03:26.491013 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:03:26.493020 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:03:26.494955 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:03:26.497618 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:03:26.499390 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:03:26.502427 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:03:26.503903 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:03:26.515562 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:26.518430 [debug] [MainThread]: On master: BEGIN
[0m15:03:26.520497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:26.529003 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:03:26.531052 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:26.532444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:03:26.567919 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m15:03:26.570788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e2bea4-0585-457a-9b0f-8dcdf400f782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a05cbbf40>]}
[0m15:03:26.572646 [debug] [MainThread]: On master: ROLLBACK
[0m15:03:26.574332 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:26.575850 [debug] [MainThread]: On master: BEGIN
[0m15:03:26.577835 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:03:26.579464 [debug] [MainThread]: On master: COMMIT
[0m15:03:26.580731 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:26.581965 [debug] [MainThread]: On master: COMMIT
[0m15:03:26.583712 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:03:26.585224 [debug] [MainThread]: On master: Close
[0m15:03:26.587147 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:03:26.589175 [info ] [MainThread]: 
[0m15:03:26.600842 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_deal_line_items
[0m15:03:26.602885 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_deal_line_items .................. [RUN]
[0m15:03:26.605257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_deal_line_items)
[0m15:03:26.607040 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_deal_line_items
[0m15:03:26.615970 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_deal_line_items"
[0m15:03:26.629504 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_line_items (compile): 15:03:26.609096 => 15:03:26.629158
[0m15:03:26.631043 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_deal_line_items
[0m15:03:26.664134 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_deal_line_items"
[0m15:03:26.677523 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m15:03:26.678783 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: BEGIN
[0m15:03:26.679846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:26.688279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:03:26.690132 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m15:03:26.691873 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_line_items"} */

  create view "warehouse"."marts_staging"."stg_deal_line_items__dbt_tmp"
    
    
  as (
    with src as (
  select
    (_airbyte_data)::jsonb as j
  from warehouse.airbyte_internal.raw_hubspot_raw__stream_deals
),
bridge as (
  select
    (j->>'id')::bigint as deal_id,
    nullif(x.value::text,'"') as line_item_id_text
  from src
  left join lateral jsonb_array_elements_text(j->'line_items') as x(value) on true
)
select
  deal_id,
  nullif(replace(line_item_id_text,'"',''),'')::bigint as line_item_id
from bridge
where line_item_id_text is not null and line_item_id_text <> ''
  );
[0m15:03:26.703977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:03:26.712262 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m15:03:26.714110 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_line_items"} */
alter table "warehouse"."marts_staging"."stg_deal_line_items" rename to "stg_deal_line_items__dbt_backup"
[0m15:03:26.717124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:03:26.766580 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m15:03:26.768088 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_line_items"} */
alter table "warehouse"."marts_staging"."stg_deal_line_items__dbt_tmp" rename to "stg_deal_line_items"
[0m15:03:26.770158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:03:26.787196 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: COMMIT
[0m15:03:26.788810 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m15:03:26.790220 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: COMMIT
[0m15:03:26.794448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:03:26.802110 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_deal_line_items__dbt_backup"
[0m15:03:26.808119 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_deal_line_items"
[0m15:03:26.810202 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_deal_line_items"} */
drop view if exists "warehouse"."marts_staging"."stg_deal_line_items__dbt_backup" cascade
[0m15:03:26.818684 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:03:26.821794 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_deal_line_items (execute): 15:03:26.632481 => 15:03:26.821580
[0m15:03:26.823645 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_deal_line_items: Close
[0m15:03:26.825933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e2bea4-0585-457a-9b0f-8dcdf400f782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a05ca2a40>]}
[0m15:03:26.828349 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_deal_line_items ............. [[32mCREATE VIEW[0m in 0.22s]
[0m15:03:26.830707 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_deal_line_items
[0m15:03:26.834160 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:26.835748 [debug] [MainThread]: On master: BEGIN
[0m15:03:26.837148 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:03:26.847031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:03:26.848866 [debug] [MainThread]: On master: COMMIT
[0m15:03:26.850597 [debug] [MainThread]: Using postgres connection "master"
[0m15:03:26.851772 [debug] [MainThread]: On master: COMMIT
[0m15:03:26.853164 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:03:26.854448 [debug] [MainThread]: On master: Close
[0m15:03:26.856522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:26.857841 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:03:26.859329 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:03:26.860721 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:03:26.862466 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_deal_line_items' was properly closed.
[0m15:03:26.863914 [info ] [MainThread]: 
[0m15:03:26.865875 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m15:03:26.868324 [debug] [MainThread]: Command end result
[0m15:03:26.902579 [info ] [MainThread]: 
[0m15:03:26.904633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:26.906601 [info ] [MainThread]: 
[0m15:03:26.908545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:03:26.911374 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0485353, "process_user_time": 2.773685, "process_kernel_time": 0.612473, "process_mem_max_rss": "104640", "process_in_blocks": "45040", "process_out_blocks": "664"}
[0m15:03:26.913606 [debug] [MainThread]: Command `dbt run` succeeded at 15:03:26.913339 after 2.05 seconds
[0m15:03:26.915263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a09594610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a06030610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799a060303d0>]}
[0m15:03:26.917071 [debug] [MainThread]: Flushing usage events
[0m15:04:31.547921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03454fc9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0343975900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03439758a0>]}


============================== 15:04:31.554589 | 62c409f0-cf00-452b-ba82-c7703c31d8c4 ==============================
[0m15:04:31.554589 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:04:31.556424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_engagemnts_meetings', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:04:31.776287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62c409f0-cf00-452b-ba82-c7703c31d8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03439bb550>]}
[0m15:04:31.863481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62c409f0-cf00-452b-ba82-c7703c31d8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0345b88d60>]}
[0m15:04:31.865967 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:04:31.882381 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:04:32.853584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:04:32.856127 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_engagements_meetings.sql
[0m15:04:33.181981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62c409f0-cf00-452b-ba82-c7703c31d8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0341c12800>]}
[0m15:04:33.226790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62c409f0-cf00-452b-ba82-c7703c31d8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0341dab610>]}
[0m15:04:33.228753 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:04:33.230861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62c409f0-cf00-452b-ba82-c7703c31d8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0341dab880>]}
[0m15:04:33.233284 [warn ] [MainThread]: The selection criterion 'stg_engagemnts_meetings' does not match any nodes
[0m15:04:33.235985 [info ] [MainThread]: 
[0m15:04:33.237934 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:04:33.239933 [debug] [MainThread]: Command end result
[0m15:04:33.271498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7771128, "process_user_time": 2.923761, "process_kernel_time": 0.46533, "process_mem_max_rss": "103760", "process_in_blocks": "480", "process_out_blocks": "608"}
[0m15:04:33.273365 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:33.273115 after 1.78 seconds
[0m15:04:33.275591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d03454fc9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0341bf78e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0341daaaa0>]}
[0m15:04:33.277274 [debug] [MainThread]: Flushing usage events
[0m15:04:50.389474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da37978880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da35df9780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da35df9720>]}


============================== 15:04:50.396223 | a2da09dc-8a31-4295-baad-bda250913a9d ==============================
[0m15:04:50.396223 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:04:50.398530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_engagements_meetings', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:04:50.606628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2da09dc-8a31-4295-baad-bda250913a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da35e3b4f0>]}
[0m15:04:50.699123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2da09dc-8a31-4295-baad-bda250913a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da38008ca0>]}
[0m15:04:50.701152 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:04:50.716583 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:04:51.620437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:51.622373 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:51.631871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2da09dc-8a31-4295-baad-bda250913a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da34255810>]}
[0m15:04:51.683604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2da09dc-8a31-4295-baad-bda250913a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da34428430>]}
[0m15:04:51.686182 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:04:51.688432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2da09dc-8a31-4295-baad-bda250913a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da34428640>]}
[0m15:04:51.691448 [info ] [MainThread]: 
[0m15:04:51.693984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:04:51.696869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:04:51.709168 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:04:51.710873 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:04:51.712413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:51.726035 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:04:51.728760 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:04:51.734089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m15:04:51.735637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:04:51.737043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:04:51.738545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:04:51.744412 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:04:51.747741 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:04:51.752039 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:04:51.755941 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:04:51.758013 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:04:51.759566 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:04:51.760853 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:04:51.762209 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:04:51.763766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:51.765273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:51.766497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:51.767620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:51.777327 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:04:51.779085 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:04:51.779677 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:04:51.780814 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:04:51.781646 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:04:51.783094 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:04:51.784580 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:04:51.785203 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:04:51.786753 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:04:51.789033 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:04:51.790951 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:04:51.792239 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:04:51.794438 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:04:51.796837 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:04:51.798052 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:04:51.801551 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:04:51.802181 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m15:04:51.803770 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:04:51.804450 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:04:51.805133 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:04:51.807242 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:04:51.810888 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:04:51.814590 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:04:51.816058 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:04:51.825445 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:51.827121 [debug] [MainThread]: On master: BEGIN
[0m15:04:51.828489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:51.836971 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:04:51.838947 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:51.840508 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:04:51.875675 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m15:04:51.878475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2da09dc-8a31-4295-baad-bda250913a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da340adb10>]}
[0m15:04:51.880221 [debug] [MainThread]: On master: ROLLBACK
[0m15:04:51.881891 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:51.883510 [debug] [MainThread]: On master: BEGIN
[0m15:04:51.885725 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:04:51.887175 [debug] [MainThread]: On master: COMMIT
[0m15:04:51.888293 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:51.889369 [debug] [MainThread]: On master: COMMIT
[0m15:04:51.891091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:04:51.892320 [debug] [MainThread]: On master: Close
[0m15:04:51.893998 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:51.895839 [info ] [MainThread]: 
[0m15:04:51.904672 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagements_meetings
[0m15:04:51.906383 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagements_meetings ............. [RUN]
[0m15:04:51.908347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_engagements_meetings)
[0m15:04:51.910048 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagements_meetings
[0m15:04:51.918412 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagements_meetings"
[0m15:04:51.933295 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagements_meetings (compile): 15:04:51.911451 => 15:04:51.932425
[0m15:04:51.935686 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagements_meetings
[0m15:04:51.971268 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagements_meetings"
[0m15:04:51.982900 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_meetings"
[0m15:04:51.984205 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_meetings: BEGIN
[0m15:04:51.985523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:51.996514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:04:51.998880 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_meetings"
[0m15:04:52.000679 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_meetings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_meetings"} */

  create view "warehouse"."marts_staging"."stg_engagements_meetings__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_engagements_meetings
)

select
    (j->>'id')::bigint                                   as meeting_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    nullif(j->'properties'->>'hs_timestamp','')::timestamptz       as meeting_timestamp,
    nullif(j->'properties'->>'hs_meeting_start_time','')::timestamptz as start_time,
    nullif(j->'properties'->>'hs_meeting_end_time','')::timestamptz   as end_time,

    (j->'properties'->>'hs_meeting_title')              as title,
    (j->'properties'->>'hs_meeting_body')               as body,

    nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

    -- associations
    j->'contacts'   as contacts_json,
    j->'companies'  as companies_json,
    j->'deals'      as deals_json,
    j->'tickets'    as tickets_json,

    extracted_at
from src
  );
[0m15:04:52.010637 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:04:52.019172 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_meetings"
[0m15:04:52.020897 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_meetings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_meetings"} */
alter table "warehouse"."marts_staging"."stg_engagements_meetings__dbt_tmp" rename to "stg_engagements_meetings"
[0m15:04:52.023364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:04:52.036927 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_meetings: COMMIT
[0m15:04:52.039026 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_meetings"
[0m15:04:52.040271 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_meetings: COMMIT
[0m15:04:52.044436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:04:52.095381 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_engagements_meetings__dbt_backup"
[0m15:04:52.100927 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_meetings"
[0m15:04:52.102778 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_meetings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_meetings"} */
drop view if exists "warehouse"."marts_staging"."stg_engagements_meetings__dbt_backup" cascade
[0m15:04:52.104714 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:04:52.107219 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagements_meetings (execute): 15:04:51.938024 => 15:04:52.107025
[0m15:04:52.109063 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_meetings: Close
[0m15:04:52.110897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2da09dc-8a31-4295-baad-bda250913a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da34428490>]}
[0m15:04:52.113154 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_engagements_meetings ........ [[32mCREATE VIEW[0m in 0.20s]
[0m15:04:52.115360 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagements_meetings
[0m15:04:52.118655 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:52.119865 [debug] [MainThread]: On master: BEGIN
[0m15:04:52.120764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:52.129031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:04:52.130522 [debug] [MainThread]: On master: COMMIT
[0m15:04:52.131942 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:52.133461 [debug] [MainThread]: On master: COMMIT
[0m15:04:52.135352 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:04:52.136795 [debug] [MainThread]: On master: Close
[0m15:04:52.138734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:52.139856 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:04:52.140789 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:04:52.142005 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:04:52.143397 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagements_meetings' was properly closed.
[0m15:04:52.144436 [info ] [MainThread]: 
[0m15:04:52.145713 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:04:52.147657 [debug] [MainThread]: Command end result
[0m15:04:52.176433 [info ] [MainThread]: 
[0m15:04:52.178619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:52.180596 [info ] [MainThread]: 
[0m15:04:52.182417 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:04:52.185002 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8703165, "process_user_time": 2.710579, "process_kernel_time": 0.462583, "process_mem_max_rss": "104592", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:04:52.186780 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:52.186582 after 1.87 seconds
[0m15:04:52.188339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da37978880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da35dfb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79da34428670>]}
[0m15:04:52.189891 [debug] [MainThread]: Flushing usage events
[0m15:05:24.860095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d185d8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d16a516f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d16a51690>]}


============================== 15:05:24.867081 | 9bd3296e-4a73-4905-9dc2-0099cd99d8ad ==============================
[0m15:05:24.867081 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:05:24.869013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_meeting_contacts', 'send_anonymous_usage_stats': 'True'}
[0m15:05:25.071654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bd3296e-4a73-4905-9dc2-0099cd99d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d16a97490>]}
[0m15:05:25.158406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bd3296e-4a73-4905-9dc2-0099cd99d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d18c61030>]}
[0m15:05:25.160582 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:05:25.177488 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:05:26.040509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:05:26.042248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:05:26.051488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bd3296e-4a73-4905-9dc2-0099cd99d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d14ea57b0>]}
[0m15:05:26.103393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bd3296e-4a73-4905-9dc2-0099cd99d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d150803d0>]}
[0m15:05:26.105595 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:05:26.107753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd3296e-4a73-4905-9dc2-0099cd99d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d150805e0>]}
[0m15:05:26.111481 [info ] [MainThread]: 
[0m15:05:26.113812 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:26.116920 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:05:26.129700 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:05:26.131326 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:05:26.132601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:26.158660 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:05:26.161206 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:05:26.166012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:05:26.167266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:05:26.168672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:05:26.169856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:05:26.176209 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:05:26.179069 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:05:26.183281 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:05:26.187063 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:05:26.190418 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:05:26.192193 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:05:26.193685 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:05:26.195199 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:05:26.197112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:26.198704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:26.200366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:26.201731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:26.211861 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:26.213690 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:05:26.214839 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:26.215922 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:26.217088 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:26.217906 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:05:26.219332 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:05:26.220998 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:05:26.222366 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:05:26.224825 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:05:26.226277 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:05:26.227660 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:05:26.228527 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:05:26.233113 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:05:26.233841 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:26.234800 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:26.238809 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:26.241096 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:05:26.242899 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:05:26.245304 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:05:26.248107 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:05:26.253030 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:05:26.254663 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:05:26.255681 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:05:26.265867 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:26.267536 [debug] [MainThread]: On master: BEGIN
[0m15:05:26.269306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:26.277943 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:26.279704 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:26.281337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:26.316581 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:05:26.319382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bd3296e-4a73-4905-9dc2-0099cd99d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d14cfbc10>]}
[0m15:05:26.321228 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:26.323062 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:26.324637 [debug] [MainThread]: On master: BEGIN
[0m15:05:26.326718 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:26.328300 [debug] [MainThread]: On master: COMMIT
[0m15:05:26.329788 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:26.331182 [debug] [MainThread]: On master: COMMIT
[0m15:05:26.333252 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:26.334719 [debug] [MainThread]: On master: Close
[0m15:05:26.336615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:26.338401 [info ] [MainThread]: 
[0m15:05:26.347421 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_meeting_contacts
[0m15:05:26.349342 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_meeting_contacts ................. [RUN]
[0m15:05:26.351522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_meeting_contacts)
[0m15:05:26.353439 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_meeting_contacts
[0m15:05:26.362140 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:26.374536 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_meeting_contacts (compile): 15:05:26.354736 => 15:05:26.374146
[0m15:05:26.376738 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_meeting_contacts
[0m15:05:26.410392 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:26.422654 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:26.424251 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: BEGIN
[0m15:05:26.425800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:26.435949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:26.437789 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:26.439248 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_meeting_contacts"} */

  create view "warehouse"."marts_staging"."stg_meeting_contacts__dbt_tmp"
    
    
  as (
    with src as (
  select (_airbyte_data)::jsonb as j
  from warehouse.airbyte_internal.raw_hubspot_raw__stream_engagements_meetings
),
bridge as (
  select
    (j->'properties'->>'hs_object_id')::bigint as meeting_id,
    x.value::text as contact_id_text
  from src
  left join lateral jsonb_array_elements_text(j->'contacts') as x(value) on true
)
select
  meeting_id,
  nullif(replace(contact_id_text,'"',''),'')::bigint as contact_id
from bridge
where contact_id_text is not null and contact_id_text <> '';
  );
[0m15:05:26.456451 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: where contact_id_text is not null and contact_id_text <> '';
                                                                    ^

[0m15:05:26.459301 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: ROLLBACK
[0m15:05:26.461452 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_meeting_contacts (execute): 15:05:26.378191 => 15:05:26.461133
[0m15:05:26.463360 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: Close
[0m15:05:26.474244 [debug] [Thread-1 (]: Database Error in model stg_meeting_contacts (models/staging/hubspot/stg_meeting_contacts.sql)
  syntax error at or near ";"
  LINE 22: where contact_id_text is not null and contact_id_text <> '';
                                                                      ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_meeting_contacts.sql
[0m15:05:26.476203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bd3296e-4a73-4905-9dc2-0099cd99d8ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d14db5a50>]}
[0m15:05:26.478054 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_meeting_contacts ........ [[31mERROR[0m in 0.12s]
[0m15:05:26.480345 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_meeting_contacts
[0m15:05:26.483682 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:26.485133 [debug] [MainThread]: On master: BEGIN
[0m15:05:26.486444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:26.495589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:26.497076 [debug] [MainThread]: On master: COMMIT
[0m15:05:26.498271 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:26.499429 [debug] [MainThread]: On master: COMMIT
[0m15:05:26.501798 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:26.503146 [debug] [MainThread]: On master: Close
[0m15:05:26.504827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:26.506208 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:05:26.508139 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:05:26.509480 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:05:26.510735 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_meeting_contacts' was properly closed.
[0m15:05:26.512234 [info ] [MainThread]: 
[0m15:05:26.514087 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m15:05:26.516411 [debug] [MainThread]: Command end result
[0m15:05:26.592815 [info ] [MainThread]: 
[0m15:05:26.595105 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:05:26.597166 [info ] [MainThread]: 
[0m15:05:26.599322 [error] [MainThread]:   Database Error in model stg_meeting_contacts (models/staging/hubspot/stg_meeting_contacts.sql)
  syntax error at or near ";"
  LINE 22: where contact_id_text is not null and contact_id_text <> '';
                                                                      ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_meeting_contacts.sql
[0m15:05:26.601752 [info ] [MainThread]: 
[0m15:05:26.604172 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:05:26.606867 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.80605, "process_user_time": 2.447723, "process_kernel_time": 0.391151, "process_mem_max_rss": "105380", "process_in_blocks": "440", "process_out_blocks": "664", "command_success": false}
[0m15:05:26.609025 [debug] [MainThread]: Command `dbt run` failed at 15:05:26.608751 after 1.81 seconds
[0m15:05:26.610637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d185d8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d18c61030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x780d15080520>]}
[0m15:05:26.612133 [debug] [MainThread]: Flushing usage events
[0m15:05:37.354071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc4624880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc2aa5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc2aa5720>]}


============================== 15:05:37.360288 | 8c287b37-4abc-4bcd-b0f6-770f6f604745 ==============================
[0m15:05:37.360288 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:05:37.362298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_meeting_contacts', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:05:37.564820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c287b37-4abc-4bcd-b0f6-770f6f604745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc2ae74f0>]}
[0m15:05:37.657086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c287b37-4abc-4bcd-b0f6-770f6f604745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc4cb0ca0>]}
[0m15:05:37.659481 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:05:37.676184 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:05:38.506658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:05:38.509674 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_meeting_contacts.sql
[0m15:05:38.853418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c287b37-4abc-4bcd-b0f6-770f6f604745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc2976a70>]}
[0m15:05:38.898017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c287b37-4abc-4bcd-b0f6-770f6f604745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc0ecb7c0>]}
[0m15:05:38.899744 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:05:38.901877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c287b37-4abc-4bcd-b0f6-770f6f604745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc2ae7580>]}
[0m15:05:38.905003 [info ] [MainThread]: 
[0m15:05:38.907709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:05:38.910290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:05:38.921759 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:05:38.923150 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:05:38.924326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:38.935373 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:05:38.938030 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:05:38.943432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m15:05:38.945322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:05:38.947424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:05:38.948931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:05:38.955338 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:05:38.958128 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:05:38.962133 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:05:38.965634 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:05:38.967280 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:05:38.968915 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:05:38.970515 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:05:38.971852 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:05:38.973372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:38.975068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:38.976660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:38.977933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:38.987106 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:38.988677 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:38.990109 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:05:38.990686 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:38.991771 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:05:38.992296 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:05:38.993889 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:05:38.995130 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:05:38.996292 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:05:38.998135 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:05:39.000974 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:05:39.002481 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:05:39.003557 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:39.008672 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:05:39.009167 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:39.009983 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:05:39.010605 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m15:05:39.011491 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:05:39.013815 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:05:39.016325 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:05:39.019383 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:05:39.022734 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:05:39.024167 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:05:39.025256 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:05:39.036709 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:39.038834 [debug] [MainThread]: On master: BEGIN
[0m15:05:39.040361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:39.050618 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:39.052375 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:39.054018 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:05:39.089248 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:05:39.091889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c287b37-4abc-4bcd-b0f6-770f6f604745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc0d8afb0>]}
[0m15:05:39.094229 [debug] [MainThread]: On master: ROLLBACK
[0m15:05:39.096063 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:39.097715 [debug] [MainThread]: On master: BEGIN
[0m15:05:39.099767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:39.101436 [debug] [MainThread]: On master: COMMIT
[0m15:05:39.102936 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:39.104309 [debug] [MainThread]: On master: COMMIT
[0m15:05:39.105963 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:39.107377 [debug] [MainThread]: On master: Close
[0m15:05:39.109248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:05:39.111280 [info ] [MainThread]: 
[0m15:05:39.120555 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_meeting_contacts
[0m15:05:39.122506 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_meeting_contacts ................. [RUN]
[0m15:05:39.124574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_meeting_contacts)
[0m15:05:39.126213 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_meeting_contacts
[0m15:05:39.135679 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:39.149852 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_meeting_contacts (compile): 15:05:39.127959 => 15:05:39.149397
[0m15:05:39.152068 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_meeting_contacts
[0m15:05:39.185610 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:39.198467 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:39.200460 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: BEGIN
[0m15:05:39.202146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:39.212114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:05:39.213966 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:39.215408 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_meeting_contacts"} */

  create view "warehouse"."marts_staging"."stg_meeting_contacts__dbt_tmp"
    
    
  as (
    with meetings as (
    select
        meeting_id,
        contacts_json
    from "warehouse"."marts_staging"."stg_engagements_meetings"
),

exploded as (
    select
        m.meeting_id,
        (c)::text::bigint as contact_id
    from meetings m
    cross join lateral jsonb_array_elements_text(m.contacts_json) as c
)

select * from exploded
  );
[0m15:05:39.221435 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:05:39.228358 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:39.230205 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_meeting_contacts"} */
alter table "warehouse"."marts_staging"."stg_meeting_contacts__dbt_tmp" rename to "stg_meeting_contacts"
[0m15:05:39.232436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:05:39.246489 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: COMMIT
[0m15:05:39.248561 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:39.250116 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: COMMIT
[0m15:05:39.255796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:05:39.263459 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_meeting_contacts__dbt_backup"
[0m15:05:39.268754 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_contacts"
[0m15:05:39.270540 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_meeting_contacts"} */
drop view if exists "warehouse"."marts_staging"."stg_meeting_contacts__dbt_backup" cascade
[0m15:05:39.272531 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:05:39.275287 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_meeting_contacts (execute): 15:05:39.153786 => 15:05:39.275097
[0m15:05:39.276869 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_contacts: Close
[0m15:05:39.278975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c287b37-4abc-4bcd-b0f6-770f6f604745', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cbab921a0>]}
[0m15:05:39.280948 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_meeting_contacts ............ [[32mCREATE VIEW[0m in 0.15s]
[0m15:05:39.283282 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_meeting_contacts
[0m15:05:39.286539 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:39.288284 [debug] [MainThread]: On master: BEGIN
[0m15:05:39.289674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:05:39.299493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:05:39.301474 [debug] [MainThread]: On master: COMMIT
[0m15:05:39.302866 [debug] [MainThread]: Using postgres connection "master"
[0m15:05:39.304543 [debug] [MainThread]: On master: COMMIT
[0m15:05:39.306462 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:05:39.307801 [debug] [MainThread]: On master: Close
[0m15:05:39.309265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:39.310998 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:05:39.312977 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:05:39.314575 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:05:39.316494 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_meeting_contacts' was properly closed.
[0m15:05:39.318385 [info ] [MainThread]: 
[0m15:05:39.320391 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:05:39.322840 [debug] [MainThread]: Command end result
[0m15:05:39.355846 [info ] [MainThread]: 
[0m15:05:39.357930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:39.360159 [info ] [MainThread]: 
[0m15:05:39.362050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:05:39.364624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0673099, "process_user_time": 2.658537, "process_kernel_time": 0.419138, "process_mem_max_rss": "108580", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:05:39.366818 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:39.366613 after 2.07 seconds
[0m15:05:39.368889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc4624880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc1122bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722cc2aa75e0>]}
[0m15:05:39.370373 [debug] [MainThread]: Flushing usage events
[0m15:06:01.641166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdbba10610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb9e3d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb9e3d6c0>]}


============================== 15:06:01.648074 | a48e0f18-0414-4a2b-8834-9d842918b437 ==============================
[0m15:06:01.648074 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:06:01.649954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_meeting_companies', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:02.035744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a48e0f18-0414-4a2b-8834-9d842918b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb9e7f4c0>]}
[0m15:06:02.121228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a48e0f18-0414-4a2b-8834-9d842918b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdbbf4a170>]}
[0m15:06:02.123538 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:06:02.140304 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:06:03.089096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:03.092179 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_meeting_companies.sql
[0m15:06:03.417536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a48e0f18-0414-4a2b-8834-9d842918b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb60148e0>]}
[0m15:06:03.464099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a48e0f18-0414-4a2b-8834-9d842918b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb826f6d0>]}
[0m15:06:03.466267 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:06:03.467943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a48e0f18-0414-4a2b-8834-9d842918b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb826f7c0>]}
[0m15:06:03.471644 [info ] [MainThread]: 
[0m15:06:03.474269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:03.477207 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:06:03.489386 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:06:03.491380 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:06:03.493131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:03.505889 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:06:03.508715 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:06:03.513589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_marts)
[0m15:06:03.515090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:06:03.517005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:06:03.518482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:06:03.524698 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:06:03.527902 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:06:03.531312 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:06:03.534950 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:06:03.536583 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:06:03.538018 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:06:03.539732 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:06:03.541183 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:06:03.542777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:03.544194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:03.545961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:03.547840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:03.558434 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:03.560224 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:03.560724 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:06:03.562244 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:03.563544 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:03.564057 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:06:03.565382 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:06:03.566959 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:06:03.568474 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:06:03.570004 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:06:03.572661 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:06:03.574746 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:06:03.575527 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:03.580796 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m15:06:03.581348 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:03.582880 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:03.584514 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:06:03.587308 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:06:03.589753 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:06:03.592167 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:06:03.594168 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:06:03.595961 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:06:03.597776 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:06:03.599399 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:06:03.611817 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:03.613670 [debug] [MainThread]: On master: BEGIN
[0m15:06:03.615425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:03.625327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:03.627199 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:03.628847 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:06:03.664203 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m15:06:03.667424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a48e0f18-0414-4a2b-8834-9d842918b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb82d3370>]}
[0m15:06:03.669442 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:03.671438 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:03.673008 [debug] [MainThread]: On master: BEGIN
[0m15:06:03.675096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:03.676885 [debug] [MainThread]: On master: COMMIT
[0m15:06:03.678410 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:03.680170 [debug] [MainThread]: On master: COMMIT
[0m15:06:03.681942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:03.683500 [debug] [MainThread]: On master: Close
[0m15:06:03.685419 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:03.687533 [info ] [MainThread]: 
[0m15:06:03.697754 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_meeting_companies
[0m15:06:03.699556 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_meeting_companies ................ [RUN]
[0m15:06:03.702548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_meeting_companies)
[0m15:06:03.704099 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_meeting_companies
[0m15:06:03.713421 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_meeting_companies"
[0m15:06:03.726978 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_meeting_companies (compile): 15:06:03.705452 => 15:06:03.726628
[0m15:06:03.728627 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_meeting_companies
[0m15:06:03.763429 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_meeting_companies"
[0m15:06:03.775375 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_companies"
[0m15:06:03.776950 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_companies: BEGIN
[0m15:06:03.778497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:03.787318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:06:03.789039 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_companies"
[0m15:06:03.790463 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_companies: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_meeting_companies"} */

  create view "warehouse"."marts_staging"."stg_meeting_companies__dbt_tmp"
    
    
  as (
    with meetings as (
    select
        meeting_id,
        companies_json
    from "warehouse"."marts_staging"."stg_engagements_meetings"
),

exploded as (
    select
        m.meeting_id,
        (c)::text::bigint as company_id
    from meetings m
    cross join lateral jsonb_array_elements_text(m.companies_json) as c
)

select * from exploded
  );
[0m15:06:03.795721 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:06:03.802503 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_companies"
[0m15:06:03.804875 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_companies: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_meeting_companies"} */
alter table "warehouse"."marts_staging"."stg_meeting_companies__dbt_tmp" rename to "stg_meeting_companies"
[0m15:06:03.807784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:03.822071 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_companies: COMMIT
[0m15:06:03.823911 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_companies"
[0m15:06:03.825739 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_companies: COMMIT
[0m15:06:03.830193 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:06:03.838216 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_meeting_companies__dbt_backup"
[0m15:06:03.844108 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_meeting_companies"
[0m15:06:03.846363 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_companies: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_meeting_companies"} */
drop view if exists "warehouse"."marts_staging"."stg_meeting_companies__dbt_backup" cascade
[0m15:06:03.848659 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:06:03.852167 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_meeting_companies (execute): 15:06:03.729921 => 15:06:03.851936
[0m15:06:03.854546 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_meeting_companies: Close
[0m15:06:03.856886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a48e0f18-0414-4a2b-8834-9d842918b437', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb5fa7010>]}
[0m15:06:03.859197 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_meeting_companies ........... [[32mCREATE VIEW[0m in 0.15s]
[0m15:06:03.861703 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_meeting_companies
[0m15:06:03.865187 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:03.866724 [debug] [MainThread]: On master: BEGIN
[0m15:06:03.868108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:03.876297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:03.877720 [debug] [MainThread]: On master: COMMIT
[0m15:06:03.879108 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:03.880470 [debug] [MainThread]: On master: COMMIT
[0m15:06:03.882341 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:03.884094 [debug] [MainThread]: On master: Close
[0m15:06:03.885832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:03.887382 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:06:03.889075 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:06:03.890746 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:06:03.891996 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_meeting_companies' was properly closed.
[0m15:06:03.893292 [info ] [MainThread]: 
[0m15:06:03.895366 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:06:03.897371 [debug] [MainThread]: Command end result
[0m15:06:03.929057 [info ] [MainThread]: 
[0m15:06:03.931020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:03.932994 [info ] [MainThread]: 
[0m15:06:03.934887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:06:03.937359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3562512, "process_user_time": 3.150313, "process_kernel_time": 0.459753, "process_mem_max_rss": "108924", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:06:03.939288 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:03.939104 after 2.36 seconds
[0m15:06:03.940602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdbba10610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdb8524250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bdbbf4a170>]}
[0m15:06:03.941904 [debug] [MainThread]: Flushing usage events
[0m15:06:38.587368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cec17849a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebfbed900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebfbed8a0>]}


============================== 15:06:38.594001 | f4a18b89-9851-4019-8b15-28b1416ace02 ==============================
[0m15:06:38.594001 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:06:38.596126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_engagements_tasks', 'send_anonymous_usage_stats': 'True'}
[0m15:06:38.794878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4a18b89-9851-4019-8b15-28b1416ace02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebfc37550>]}
[0m15:06:38.880120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4a18b89-9851-4019-8b15-28b1416ace02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cec1e00d60>]}
[0m15:06:38.882827 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:06:38.901110 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:06:40.007272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:40.009126 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:40.020699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4a18b89-9851-4019-8b15-28b1416ace02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebe051930>]}
[0m15:06:40.083520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4a18b89-9851-4019-8b15-28b1416ace02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebe220550>]}
[0m15:06:40.088226 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:06:40.092174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4a18b89-9851-4019-8b15-28b1416ace02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebe220760>]}
[0m15:06:40.099646 [info ] [MainThread]: 
[0m15:06:40.109633 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:40.117298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:06:40.158874 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:06:40.164281 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:06:40.168119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:40.189966 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:06:40.195222 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:06:40.204368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m15:06:40.206851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:06:40.209733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:06:40.220470 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:06:40.222148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:06:40.228796 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:06:40.235493 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:06:40.237766 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:06:40.242364 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:06:40.244671 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:06:40.246470 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:06:40.248154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:40.249895 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:06:40.251992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:40.253987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:40.257435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:40.264877 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:40.267583 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:06:40.269451 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:40.270915 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:40.272048 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:06:40.273519 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:40.274348 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:06:40.275904 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:06:40.279759 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:06:40.282119 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:06:40.283079 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:40.284618 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:06:40.286719 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:06:40.291496 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:06:40.293029 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m15:06:40.298632 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:40.301993 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:06:40.304705 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:06:40.305270 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:40.307362 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:06:40.310689 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:06:40.312811 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:06:40.314674 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:06:40.318933 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:06:40.327852 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:40.329494 [debug] [MainThread]: On master: BEGIN
[0m15:06:40.331278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:40.340569 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:40.342462 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:40.344468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:06:40.385245 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m15:06:40.388362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4a18b89-9851-4019-8b15-28b1416ace02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebdeb3c10>]}
[0m15:06:40.390449 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:40.392607 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:40.394179 [debug] [MainThread]: On master: BEGIN
[0m15:06:40.396738 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:40.398902 [debug] [MainThread]: On master: COMMIT
[0m15:06:40.400944 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:40.402509 [debug] [MainThread]: On master: COMMIT
[0m15:06:40.404034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:40.405395 [debug] [MainThread]: On master: Close
[0m15:06:40.407449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:40.409942 [info ] [MainThread]: 
[0m15:06:40.420279 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagements_tasks
[0m15:06:40.422280 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagements_tasks ................ [RUN]
[0m15:06:40.424649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_engagements_tasks)
[0m15:06:40.426263 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagements_tasks
[0m15:06:40.434626 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:40.446721 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagements_tasks (compile): 15:06:40.427390 => 15:06:40.446307
[0m15:06:40.448970 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagements_tasks
[0m15:06:40.483054 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:40.495371 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:40.496994 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: BEGIN
[0m15:06:40.498703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:40.507272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:06:40.509058 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:40.510262 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_tasks"} */

  create view "warehouse"."marts_staging"."stg_engagements_tasks__dbt_tmp"
    
    
  as (
    with src as (
  select (_airbyte_data)::jsonb as j
  from warehouse.airbyte_internal.raw_hubspot_raw__stream_engagements_tasks
)
select
  (j->>'id')::bigint                                     as task_id,
  (j->'properties'->>'hs_task_subject')                  as subject,
  (j->'properties'->>'hs_task_type')                     as task_type,
  (j->'properties'->>'hs_task_family')                   as task_family,
  (j->'properties'->>'hs_task_priority')                 as priority,
  (j->'properties'->>'hs_task_status')                   as status,
  coalesce((j->'properties'->>'hs_task_is_completed')::int,0) = 1 as is_completed,
  coalesce((j->'properties'->>'hs_task_is_overdue')::boolean,false) as is_overdue,
  nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,
  nullif(j->'properties'->>'hs_associated_contact_labels','') as associated_contact_labels,
  nullif(j->'properties'->>'hs_associated_company_labels','') as associated_company_labels,
  nullif(j->'properties'->>'createdate','')::timestamptz as created_at,
  nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz as updated_at
from src;
  );
[0m15:06:40.512247 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: from src;
                 ^

[0m15:06:40.513675 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: ROLLBACK
[0m15:06:40.516187 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagements_tasks (execute): 15:06:40.450110 => 15:06:40.515593
[0m15:06:40.517584 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: Close
[0m15:06:40.520523 [debug] [Thread-1 (]: Database Error in model stg_engagements_tasks (models/staging/hubspot/stg_engagements_tasks.sql)
  syntax error at or near ";"
  LINE 25: from src;
                   ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_engagements_tasks.sql
[0m15:06:40.522336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4a18b89-9851-4019-8b15-28b1416ace02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebdf5df30>]}
[0m15:06:40.524097 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_engagements_tasks ....... [[31mERROR[0m in 0.10s]
[0m15:06:40.526105 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagements_tasks
[0m15:06:40.529382 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:40.530778 [debug] [MainThread]: On master: BEGIN
[0m15:06:40.531996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:40.540115 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:40.541661 [debug] [MainThread]: On master: COMMIT
[0m15:06:40.543286 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:40.544860 [debug] [MainThread]: On master: COMMIT
[0m15:06:40.546828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:40.548785 [debug] [MainThread]: On master: Close
[0m15:06:40.550882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:40.552788 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:06:40.554408 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:06:40.555638 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:06:40.556986 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagements_tasks' was properly closed.
[0m15:06:40.558726 [info ] [MainThread]: 
[0m15:06:40.560264 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:06:40.562407 [debug] [MainThread]: Command end result
[0m15:06:40.642795 [info ] [MainThread]: 
[0m15:06:40.644971 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:06:40.646968 [info ] [MainThread]: 
[0m15:06:40.648999 [error] [MainThread]:   Database Error in model stg_engagements_tasks (models/staging/hubspot/stg_engagements_tasks.sql)
  syntax error at or near ";"
  LINE 25: from src;
                   ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_engagements_tasks.sql
[0m15:06:40.650806 [info ] [MainThread]: 
[0m15:06:40.652907 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:06:40.657150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.1279123, "process_user_time": 2.460619, "process_kernel_time": 0.406779, "process_mem_max_rss": "105276", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:06:40.659733 [debug] [MainThread]: Command `dbt run` failed at 15:06:40.659498 after 2.13 seconds
[0m15:06:40.663565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cec17849a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebe366860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cebe270d60>]}
[0m15:06:40.666121 [debug] [MainThread]: Flushing usage events
[0m15:06:48.927080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce9af44610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce99375720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce993756c0>]}


============================== 15:06:48.933766 | 8c5234e2-9db6-4206-9320-50fd199d6ae2 ==============================
[0m15:06:48.933766 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:06:48.935922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_engagements_tasks', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:49.138071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c5234e2-9db6-4206-9320-50fd199d6ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce993b34c0>]}
[0m15:06:49.223549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c5234e2-9db6-4206-9320-50fd199d6ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce9b47e170>]}
[0m15:06:49.226111 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:06:49.243392 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:06:50.506918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:50.509612 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_engagements_tasks.sql
[0m15:06:50.927594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c5234e2-9db6-4206-9320-50fd199d6ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce955c53f0>]}
[0m15:06:50.972288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c5234e2-9db6-4206-9320-50fd199d6ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce977a3730>]}
[0m15:06:50.973984 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:06:50.975989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c5234e2-9db6-4206-9320-50fd199d6ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce977a3820>]}
[0m15:06:50.979113 [info ] [MainThread]: 
[0m15:06:50.981544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:06:50.984393 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:06:50.996978 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:06:50.999175 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:06:51.000528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:51.011465 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:06:51.014298 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:06:51.020225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:06:51.021694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:06:51.023269 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:06:51.024561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:06:51.030475 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:06:51.034289 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:06:51.037659 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:06:51.041561 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:06:51.043537 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:06:51.045345 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:06:51.047161 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:06:51.048919 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:06:51.050526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:51.052184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:51.053858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:51.055300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:51.065594 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:51.066709 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:51.067707 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:06:51.068413 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:51.069476 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:06:51.069979 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:06:51.070937 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:06:51.072312 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:06:51.073540 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:06:51.075008 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:06:51.077603 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:06:51.080233 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:06:51.080839 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m15:06:51.083283 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:51.085540 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:06:51.086026 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:51.086920 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:06:51.088343 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:06:51.090127 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:06:51.092032 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:06:51.094021 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:06:51.095931 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:06:51.100289 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:06:51.101639 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:06:51.111768 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:51.113672 [debug] [MainThread]: On master: BEGIN
[0m15:06:51.115025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:51.124325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:51.126111 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:51.127346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:06:51.163534 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m15:06:51.166949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c5234e2-9db6-4206-9320-50fd199d6ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce97aadae0>]}
[0m15:06:51.168714 [debug] [MainThread]: On master: ROLLBACK
[0m15:06:51.170256 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:51.171666 [debug] [MainThread]: On master: BEGIN
[0m15:06:51.173925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:51.175297 [debug] [MainThread]: On master: COMMIT
[0m15:06:51.176496 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:51.177672 [debug] [MainThread]: On master: COMMIT
[0m15:06:51.179088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:51.180917 [debug] [MainThread]: On master: Close
[0m15:06:51.182962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:51.185089 [info ] [MainThread]: 
[0m15:06:51.194677 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagements_tasks
[0m15:06:51.196461 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagements_tasks ................ [RUN]
[0m15:06:51.198389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_intermediate, now model.hubspot_dbt.stg_engagements_tasks)
[0m15:06:51.200162 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagements_tasks
[0m15:06:51.209507 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:51.220875 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagements_tasks (compile): 15:06:51.201474 => 15:06:51.220513
[0m15:06:51.222942 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagements_tasks
[0m15:06:51.257140 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:51.269656 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:51.271366 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: BEGIN
[0m15:06:51.273073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:06:51.282872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:06:51.284331 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:51.285579 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_tasks"} */

  create view "warehouse"."marts_staging"."stg_engagements_tasks__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_engagements_tasks
)

select
    (j->>'id')::bigint                                   as task_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    (j->'properties'->>'hs_task_subject')               as subject,
    (j->'properties'->>'hs_task_type')                  as task_type,
    (j->'properties'->>'hs_task_family')                as task_family,
    (j->'properties'->>'hs_task_status')                as status,
    (j->'properties'->>'hs_task_priority')              as priority,

    coalesce((j->'properties'->>'hs_task_is_completed')::int,0)      as is_completed,
    coalesce((j->'properties'->>'hs_task_is_overdue')::boolean,false) as is_overdue,
    coalesce((j->'properties'->>'hs_task_missed_due_date')::boolean,false) as is_missed_due_date,

    nullif(j->'properties'->>'hs_timestamp','')::timestamptz         as task_timestamp,
    nullif(j->'properties'->>'hs_task_last_sales_activity_timestamp','')::timestamptz as last_sales_activity_ts,

    nullif(j->'properties'->>'hubspot_owner_id','')::bigint          as owner_id,

    j->'contacts'   as contacts_json,
    j->'companies'  as companies_json,
    j->'deals'      as deals_json,
    j->'tickets'    as tickets_json,

    extracted_at
from src
  );
[0m15:06:51.290602 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:06:51.297752 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:51.299666 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_tasks"} */
alter table "warehouse"."marts_staging"."stg_engagements_tasks__dbt_tmp" rename to "stg_engagements_tasks"
[0m15:06:51.301762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:06:51.316233 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: COMMIT
[0m15:06:51.317994 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:51.319763 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: COMMIT
[0m15:06:51.324738 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:06:51.332216 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_engagements_tasks__dbt_backup"
[0m15:06:51.338059 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_tasks"
[0m15:06:51.340264 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_tasks"} */
drop view if exists "warehouse"."marts_staging"."stg_engagements_tasks__dbt_backup" cascade
[0m15:06:51.342709 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:06:51.345842 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagements_tasks (execute): 15:06:51.224936 => 15:06:51.345600
[0m15:06:51.347961 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_tasks: Close
[0m15:06:51.350431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5234e2-9db6-4206-9320-50fd199d6ae2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce9546c280>]}
[0m15:06:51.352926 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_engagements_tasks ........... [[32mCREATE VIEW[0m in 0.15s]
[0m15:06:51.355533 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagements_tasks
[0m15:06:51.359102 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:51.360570 [debug] [MainThread]: On master: BEGIN
[0m15:06:51.362155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:06:51.371543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:06:51.373098 [debug] [MainThread]: On master: COMMIT
[0m15:06:51.374140 [debug] [MainThread]: Using postgres connection "master"
[0m15:06:51.375302 [debug] [MainThread]: On master: COMMIT
[0m15:06:51.377038 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:06:51.378202 [debug] [MainThread]: On master: Close
[0m15:06:51.379598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:51.381012 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:06:51.382714 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:06:51.384071 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:06:51.385408 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagements_tasks' was properly closed.
[0m15:06:51.386826 [info ] [MainThread]: 
[0m15:06:51.388596 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:06:51.390796 [debug] [MainThread]: Command end result
[0m15:06:51.422257 [info ] [MainThread]: 
[0m15:06:51.424383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:51.426736 [info ] [MainThread]: 
[0m15:06:51.428509 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:06:51.431098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.55994, "process_user_time": 2.742059, "process_kernel_time": 0.410902, "process_mem_max_rss": "108700", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:06:51.433649 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:51.433408 after 2.56 seconds
[0m15:06:51.435547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce9af44610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce97bebfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ce955c7d90>]}
[0m15:06:51.437027 [debug] [MainThread]: Flushing usage events
[0m15:07:33.278929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1eb1e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e960d720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e960d6c0>]}


============================== 15:07:33.285829 | df1d8b53-bda7-4736-bbf6-a24f066708a8 ==============================
[0m15:07:33.285829 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:07:33.288250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_engagements_notes', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:07:33.495332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df1d8b53-bda7-4736-bbf6-a24f066708a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e964f4c0>]}
[0m15:07:33.598257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df1d8b53-bda7-4736-bbf6-a24f066708a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1eb71a170>]}
[0m15:07:33.600452 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:07:33.618519 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:07:34.568257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:07:34.570894 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_engagements_notes.sql
[0m15:07:34.914442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df1d8b53-bda7-4736-bbf6-a24f066708a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e58613f0>]}
[0m15:07:34.960525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df1d8b53-bda7-4736-bbf6-a24f066708a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e7a3f730>]}
[0m15:07:34.962452 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:07:34.964412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df1d8b53-bda7-4736-bbf6-a24f066708a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e7a3f820>]}
[0m15:07:34.967499 [info ] [MainThread]: 
[0m15:07:34.970786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:34.973913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:07:34.985909 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:07:34.987647 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:07:34.989524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:35.002310 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:07:35.004846 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:07:35.010288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:07:35.012231 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:07:35.013823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:07:35.015350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:07:35.022755 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:07:35.026241 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:07:35.029452 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:07:35.033284 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:07:35.034998 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:07:35.036808 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:07:35.038530 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:07:35.040391 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:07:35.041821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:35.043685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:35.047036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:35.049572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:35.059209 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:07:35.061209 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:07:35.061757 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:07:35.063045 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:07:35.063524 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:07:35.065212 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:07:35.065750 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:07:35.066683 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:07:35.068709 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:07:35.070148 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:07:35.071505 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:07:35.072227 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:07:35.077156 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:07:35.078259 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:07:35.081637 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:07:35.083951 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:07:35.084423 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:07:35.087125 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:07:35.088790 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:07:35.089573 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:07:35.091095 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:07:35.101662 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:07:35.103446 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:07:35.104843 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:07:35.113529 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.114889 [debug] [MainThread]: On master: BEGIN
[0m15:07:35.116100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:35.123992 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:07:35.125600 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.126804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:07:35.163557 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m15:07:35.166947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df1d8b53-bda7-4736-bbf6-a24f066708a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e569e950>]}
[0m15:07:35.169070 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:35.171136 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.173260 [debug] [MainThread]: On master: BEGIN
[0m15:07:35.175279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:07:35.176980 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.178491 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.180235 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.182485 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:07:35.184447 [debug] [MainThread]: On master: Close
[0m15:07:35.186796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:35.189171 [info ] [MainThread]: 
[0m15:07:35.205111 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagements_notes
[0m15:07:35.207664 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagements_notes ................ [RUN]
[0m15:07:35.211328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_engagements_notes)
[0m15:07:35.214259 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagements_notes
[0m15:07:35.224742 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagements_notes"
[0m15:07:35.246158 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagements_notes (compile): 15:07:35.216277 => 15:07:35.245421
[0m15:07:35.248728 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagements_notes
[0m15:07:35.287825 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagements_notes"
[0m15:07:35.304355 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_notes"
[0m15:07:35.306800 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_notes: BEGIN
[0m15:07:35.308918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:35.320529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:07:35.323993 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_notes"
[0m15:07:35.326764 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_notes: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_notes"} */

  create view "warehouse"."marts_staging"."stg_engagements_notes__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_engagements_notes
)

select
    (j->>'id')::bigint                                   as note_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    (j->'properties'->>'hs_note_body')                  as body_html,
    (j->'properties'->>'hs_body_preview')               as body_text,

    nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

    -- associations
    j->'contacts'   as contacts_json,
    j->'companies'  as companies_json,
    j->'deals'      as deals_json,
    j->'tickets'    as tickets_json,

    extracted_at
from src
  );
[0m15:07:35.334790 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:07:35.346536 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_notes"
[0m15:07:35.348225 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_notes: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_notes"} */
alter table "warehouse"."marts_staging"."stg_engagements_notes__dbt_tmp" rename to "stg_engagements_notes"
[0m15:07:35.350537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:07:35.368590 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_notes: COMMIT
[0m15:07:35.370442 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_notes"
[0m15:07:35.372711 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_notes: COMMIT
[0m15:07:35.378225 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:07:35.389564 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_engagements_notes__dbt_backup"
[0m15:07:35.410309 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagements_notes"
[0m15:07:35.412744 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_notes: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagements_notes"} */
drop view if exists "warehouse"."marts_staging"."stg_engagements_notes__dbt_backup" cascade
[0m15:07:35.416639 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:07:35.420895 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagements_notes (execute): 15:07:35.250796 => 15:07:35.420420
[0m15:07:35.423672 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagements_notes: Close
[0m15:07:35.426737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df1d8b53-bda7-4736-bbf6-a24f066708a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e570e050>]}
[0m15:07:35.429960 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_engagements_notes ........... [[32mCREATE VIEW[0m in 0.22s]
[0m15:07:35.433157 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagements_notes
[0m15:07:35.438606 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.441321 [debug] [MainThread]: On master: BEGIN
[0m15:07:35.444036 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:35.458117 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:07:35.460694 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.463539 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:35.466104 [debug] [MainThread]: On master: COMMIT
[0m15:07:35.468731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:07:35.471704 [debug] [MainThread]: On master: Close
[0m15:07:35.474177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:35.476889 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:07:35.479015 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:07:35.480868 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:07:35.483242 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagements_notes' was properly closed.
[0m15:07:35.485710 [info ] [MainThread]: 
[0m15:07:35.488062 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m15:07:35.491871 [debug] [MainThread]: Command end result
[0m15:07:35.536302 [info ] [MainThread]: 
[0m15:07:35.538644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:35.540865 [info ] [MainThread]: 
[0m15:07:35.542862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:07:35.545788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3264794, "process_user_time": 2.955567, "process_kernel_time": 0.455317, "process_mem_max_rss": "109156", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:07:35.548047 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:35.547693 after 2.33 seconds
[0m15:07:35.549480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1eb1e0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e7e87fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d1e7a3ea40>]}
[0m15:07:35.551251 [debug] [MainThread]: Flushing usage events
[0m15:08:15.791550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891d6809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891bafd900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891bafd8a0>]}


============================== 15:08:15.798455 | e4a9370c-ce58-40c7-99ba-5f6946d558e0 ==============================
[0m15:08:15.798455 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:08:15.800316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_note_tickets', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:08:16.007808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4a9370c-ce58-40c7-99ba-5f6946d558e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891bb3f550>]}
[0m15:08:16.103069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4a9370c-ce58-40c7-99ba-5f6946d558e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891dd08d60>]}
[0m15:08:16.105363 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:08:16.123402 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:08:17.071648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:17.074634 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_note_tickets.sql
[0m15:08:17.537568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4a9370c-ce58-40c7-99ba-5f6946d558e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891ba25a80>]}
[0m15:08:17.584433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4a9370c-ce58-40c7-99ba-5f6946d558e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8919f23940>]}
[0m15:08:17.586232 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:08:17.588439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a9370c-ce58-40c7-99ba-5f6946d558e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89180c1db0>]}
[0m15:08:17.591304 [info ] [MainThread]: 
[0m15:08:17.593608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:17.596752 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:08:17.608298 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:08:17.609614 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:08:17.610670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:17.621896 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:08:17.624654 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:08:17.630276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m15:08:17.631662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:08:17.633555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:08:17.635487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:08:17.641907 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:08:17.645108 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:08:17.648797 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:08:17.652276 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:08:17.654198 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:08:17.656128 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:08:17.657772 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:08:17.659251 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:08:17.661124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:17.662908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:17.664503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:17.665981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:17.675539 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:17.676864 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:17.677808 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:08:17.678339 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:17.679375 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:08:17.680930 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:08:17.681468 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:17.682697 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:08:17.684369 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:08:17.686707 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:08:17.688190 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:08:17.689847 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:17.691415 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:08:17.694695 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:08:17.695204 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:17.697313 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m15:08:17.698478 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:08:17.700294 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:08:17.700782 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:17.703099 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:08:17.706811 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:08:17.708721 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:08:17.710397 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:08:17.716336 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:08:17.726620 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:17.728341 [debug] [MainThread]: On master: BEGIN
[0m15:08:17.730068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:17.739021 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:17.741019 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:17.742611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:08:17.780468 [debug] [MainThread]: SQL status: SELECT 11 in 0.0 seconds
[0m15:08:17.783287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4a9370c-ce58-40c7-99ba-5f6946d558e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891ba25a80>]}
[0m15:08:17.785227 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:17.786879 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:17.788435 [debug] [MainThread]: On master: BEGIN
[0m15:08:17.790440 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:17.792061 [debug] [MainThread]: On master: COMMIT
[0m15:08:17.794371 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:17.795991 [debug] [MainThread]: On master: COMMIT
[0m15:08:17.797792 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:17.799363 [debug] [MainThread]: On master: Close
[0m15:08:17.801225 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:08:17.803310 [info ] [MainThread]: 
[0m15:08:17.812751 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_note_tickets
[0m15:08:17.814434 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_note_tickets ..................... [RUN]
[0m15:08:17.816920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_intermediate, now model.hubspot_dbt.stg_note_tickets)
[0m15:08:17.818648 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_note_tickets
[0m15:08:17.829900 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_note_tickets"
[0m15:08:17.841279 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_note_tickets (compile): 15:08:17.820409 => 15:08:17.840908
[0m15:08:17.843396 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_note_tickets
[0m15:08:17.878049 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_note_tickets"
[0m15:08:17.891502 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_note_tickets"
[0m15:08:17.893114 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_note_tickets: BEGIN
[0m15:08:17.894698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:17.903454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:17.904982 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_note_tickets"
[0m15:08:17.906517 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_note_tickets: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_note_tickets"} */

  create view "warehouse"."marts_staging"."stg_note_tickets__dbt_tmp"
    
    
  as (
    with notes as (
    select
        note_id,
        tickets_json
    from "warehouse"."marts_staging"."stg_engagements_notes"
),

exploded as (
    select
        n.note_id,
        (t)::text::bigint as ticket_id
    from notes n
    cross join lateral jsonb_array_elements_text(n.tickets_json) as t
)

select * from exploded
  );
[0m15:08:17.916932 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:08:17.924114 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_note_tickets"
[0m15:08:17.926165 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_note_tickets: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_note_tickets"} */
alter table "warehouse"."marts_staging"."stg_note_tickets__dbt_tmp" rename to "stg_note_tickets"
[0m15:08:17.928363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:08:17.943781 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_note_tickets: COMMIT
[0m15:08:17.945542 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_note_tickets"
[0m15:08:17.947402 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_note_tickets: COMMIT
[0m15:08:17.951916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:08:17.959571 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_note_tickets__dbt_backup"
[0m15:08:17.966159 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_note_tickets"
[0m15:08:17.968156 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_note_tickets: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_note_tickets"} */
drop view if exists "warehouse"."marts_staging"."stg_note_tickets__dbt_backup" cascade
[0m15:08:17.970246 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:08:17.973961 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_note_tickets (execute): 15:08:17.845274 => 15:08:17.973743
[0m15:08:17.976247 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_note_tickets: Close
[0m15:08:17.978554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4a9370c-ce58-40c7-99ba-5f6946d558e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a88e3b9e410>]}
[0m15:08:17.980188 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_note_tickets ................ [[32mCREATE VIEW[0m in 0.16s]
[0m15:08:17.982547 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_note_tickets
[0m15:08:17.987189 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:17.989110 [debug] [MainThread]: On master: BEGIN
[0m15:08:17.990593 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:18.000446 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:18.002036 [debug] [MainThread]: On master: COMMIT
[0m15:08:18.003730 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:18.006226 [debug] [MainThread]: On master: COMMIT
[0m15:08:18.008672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:18.010501 [debug] [MainThread]: On master: Close
[0m15:08:18.012188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:18.014207 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:08:18.015665 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:08:18.017204 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:08:18.018331 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_note_tickets' was properly closed.
[0m15:08:18.019560 [info ] [MainThread]: 
[0m15:08:18.022007 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m15:08:18.024348 [debug] [MainThread]: Command end result
[0m15:08:18.059160 [info ] [MainThread]: 
[0m15:08:18.061992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:08:18.064362 [info ] [MainThread]: 
[0m15:08:18.066711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:08:18.069847 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3357708, "process_user_time": 2.993581, "process_kernel_time": 0.409136, "process_mem_max_rss": "108664", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:08:18.071615 [debug] [MainThread]: Command `dbt run` succeeded at 15:08:18.071426 after 2.34 seconds
[0m15:08:18.073583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891d6809a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a891a1b53f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8919f23e80>]}
[0m15:08:18.074995 [debug] [MainThread]: Flushing usage events
[0m15:08:45.040748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4cdf0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4b21d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4b21d750>]}


============================== 15:08:45.047591 | b4f62962-d46e-4bf4-8349-feeece99e6ba ==============================
[0m15:08:45.047591 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:08:45.049654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_tickets', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:45.250069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f62962-d46e-4bf4-8349-feeece99e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4b25f520>]}
[0m15:08:45.354762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f62962-d46e-4bf4-8349-feeece99e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4b70e2f0>]}
[0m15:08:45.356889 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:08:45.375138 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:08:46.374639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:08:46.377575 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_tickets.sql
[0m15:08:46.730204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4f62962-d46e-4bf4-8349-feeece99e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f495bc190>]}
[0m15:08:46.779129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4f62962-d46e-4bf4-8349-feeece99e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4964f700>]}
[0m15:08:46.781033 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:08:46.783210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f62962-d46e-4bf4-8349-feeece99e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4964f970>]}
[0m15:08:46.786615 [info ] [MainThread]: 
[0m15:08:46.789268 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:08:46.792078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:08:46.804941 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:08:46.806957 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:08:46.808992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:46.822605 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:08:46.825028 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:08:46.830799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_marts)
[0m15:08:46.832651 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:08:46.834686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:08:46.841047 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:08:46.842062 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:08:46.845206 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:08:46.848994 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:08:46.851036 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:08:46.854413 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:08:46.856118 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:08:46.857788 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:08:46.859329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:46.860949 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:08:46.862587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:46.863966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:46.867457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:46.873262 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:46.875596 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:08:46.876747 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:46.877645 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:08:46.879469 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:46.880055 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:08:46.882435 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:08:46.883315 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:08:46.884804 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:08:46.885509 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:46.886666 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:08:46.888116 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:08:46.891555 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:08:46.893247 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:08:46.893944 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:46.896453 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:08:46.899571 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:08:46.900113 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:08:46.901640 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m15:08:46.903710 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:08:46.905730 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:08:46.908356 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:08:46.911918 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:08:46.913472 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:08:46.925036 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:46.926528 [debug] [MainThread]: On master: BEGIN
[0m15:08:46.927909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:46.937039 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:46.939031 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:46.940556 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:08:46.978777 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m15:08:46.982477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f62962-d46e-4bf4-8349-feeece99e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f49907e50>]}
[0m15:08:46.984344 [debug] [MainThread]: On master: ROLLBACK
[0m15:08:46.986361 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:46.988328 [debug] [MainThread]: On master: BEGIN
[0m15:08:46.990432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:46.992134 [debug] [MainThread]: On master: COMMIT
[0m15:08:46.993949 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:46.995361 [debug] [MainThread]: On master: COMMIT
[0m15:08:46.997054 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:46.998937 [debug] [MainThread]: On master: Close
[0m15:08:47.001033 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:08:47.002975 [info ] [MainThread]: 
[0m15:08:47.011633 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_tickets
[0m15:08:47.013350 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_tickets .......................... [RUN]
[0m15:08:47.015458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_tickets)
[0m15:08:47.017585 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_tickets
[0m15:08:47.026567 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_tickets"
[0m15:08:47.040274 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_tickets (compile): 15:08:47.018989 => 15:08:47.039923
[0m15:08:47.041825 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_tickets
[0m15:08:47.077392 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_tickets"
[0m15:08:47.088489 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:08:47.089864 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: BEGIN
[0m15:08:47.091281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:08:47.101139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:08:47.102629 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:08:47.103897 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_tickets"} */

  create view "warehouse"."marts_staging"."stg_tickets__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_tickets
),

base as (
    select
        (j->>'id')::bigint                           as ticket_id,

        nullif(j->>'createdAt','')::timestamptz     as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz     as updated_at_raw,

        -- propriétés
        (j->'properties'->>'subject')               as subject,
        (j->'properties'->>'content')               as content,
        (j->'properties'->>'source_type')           as source_type,

        nullif(j->'properties'->>'createdate','')::timestamptz      as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz as lastmodifieddate,
        nullif(j->'properties'->>'closed_date','')::timestamptz     as closed_date,

        (j->'properties'->>'hs_pipeline')           as pipeline_id,
        (j->'properties'->>'hs_pipeline_stage')     as pipeline_stage_id,

        nullif(j->'properties'->>'time_to_close','')::bigint        as time_to_close_ms,

        nullif(j->'properties'->>'created_by','')::bigint           as created_by_contact_id,
        nullif(j->'properties'->>'hs_primary_company_id','')::bigint as primary_company_id,
        (j->'properties'->>'hs_primary_company_name')               as primary_company_name,

        nullif(j->'properties'->>'hs_last_closed_date','')::timestamptz as last_closed_date,

        -- flags dérivables
        (nullif(j->'properties'->>'closed_date','') is not null)    as is_closed,

        -- associations racine
        j->'contacts'   as contacts_json,
        j->'companies'  as companies_json,

        extracted_at
    from src
)

select
    ticket_id,
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,
    closed_date,
    is_closed,

    subject,
    content,
    source_type,

    pipeline_id,
    pipeline_stage_id,
    time_to_close_ms,

    created_by_contact_id,
    primary_company_id,
    primary_company_name,

    last_closed_date,
    contacts_json,
    companies_json,
    extracted_at
from basewith src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_tickets
),

base as (
    select
        (j->>'id')::bigint                           as ticket_id,

        nullif(j->>'createdAt','')::timestamptz     as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz     as updated_at_raw,

        -- propriétés
        (j->'properties'->>'subject')               as subject,
        (j->'properties'->>'content')               as content,
        (j->'properties'->>'source_type')           as source_type,

        nullif(j->'properties'->>'createdate','')::timestamptz      as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz as lastmodifieddate,
        nullif(j->'properties'->>'closed_date','')::timestamptz     as closed_date,

        (j->'properties'->>'hs_pipeline')           as pipeline_id,
        (j->'properties'->>'hs_pipeline_stage')     as pipeline_stage_id,

        nullif(j->'properties'->>'time_to_close','')::bigint        as time_to_close_ms,

        nullif(j->'properties'->>'created_by','')::bigint           as created_by_contact_id,
        nullif(j->'properties'->>'hs_primary_company_id','')::bigint as primary_company_id,
        (j->'properties'->>'hs_primary_company_name')               as primary_company_name,

        nullif(j->'properties'->>'hs_last_closed_date','')::timestamptz as last_closed_date,

        -- flags dérivables
        (nullif(j->'properties'->>'closed_date','') is not null)    as is_closed,

        -- associations racine
        j->'contacts'   as contacts_json,
        j->'companies'  as companies_json,

        extracted_at
    from src
)

select
    ticket_id,
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,
    closed_date,
    is_closed,

    subject,
    content,
    source_type,

    pipeline_id,
    pipeline_stage_id,
    time_to_close_ms,

    created_by_contact_id,
    primary_company_id,
    primary_company_name,

    last_closed_date,
    contacts_json,
    companies_json,
    extracted_at
from base
  );
[0m15:08:47.106022 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 75: from basewith src as (
                           ^

[0m15:08:47.107492 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: ROLLBACK
[0m15:08:47.108961 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_tickets (execute): 15:08:47.043307 => 15:08:47.108712
[0m15:08:47.110075 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: Close
[0m15:08:47.113307 [debug] [Thread-1 (]: Database Error in model stg_tickets (models/staging/hubspot/stg_tickets.sql)
  syntax error at or near "as"
  LINE 75: from basewith src as (
                             ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_tickets.sql
[0m15:08:47.115129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f62962-d46e-4bf4-8349-feeece99e6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f49a96200>]}
[0m15:08:47.116934 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_tickets ................. [[31mERROR[0m in 0.10s]
[0m15:08:47.118975 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_tickets
[0m15:08:47.122212 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:47.123629 [debug] [MainThread]: On master: BEGIN
[0m15:08:47.125010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:47.134260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:08:47.135959 [debug] [MainThread]: On master: COMMIT
[0m15:08:47.137276 [debug] [MainThread]: Using postgres connection "master"
[0m15:08:47.138583 [debug] [MainThread]: On master: COMMIT
[0m15:08:47.140237 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:08:47.141732 [debug] [MainThread]: On master: Close
[0m15:08:47.143533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:47.144961 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:08:47.146510 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:08:47.148221 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:08:47.149501 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_tickets' was properly closed.
[0m15:08:47.150660 [info ] [MainThread]: 
[0m15:08:47.152207 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m15:08:47.154587 [debug] [MainThread]: Command end result
[0m15:08:47.188403 [info ] [MainThread]: 
[0m15:08:47.190883 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:47.192867 [info ] [MainThread]: 
[0m15:08:47.194795 [error] [MainThread]:   Database Error in model stg_tickets (models/staging/hubspot/stg_tickets.sql)
  syntax error at or near "as"
  LINE 75: from basewith src as (
                             ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_tickets.sql
[0m15:08:47.196833 [info ] [MainThread]: 
[0m15:08:47.198912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:08:47.201828 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.218061, "process_user_time": 2.900448, "process_kernel_time": 0.384874, "process_mem_max_rss": "109120", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:08:47.203697 [debug] [MainThread]: Command `dbt run` failed at 15:08:47.203489 after 2.22 seconds
[0m15:08:47.205495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4cdf0a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4b70e2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709f4b25f790>]}
[0m15:08:47.207224 [debug] [MainThread]: Flushing usage events
[0m15:09:24.591059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7869764610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7867bd16f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7867bd1690>]}


============================== 15:09:24.597988 | ce6cb5f5-61d3-4cdd-84bd-f19fe6800753 ==============================
[0m15:09:24.597988 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:09:24.599816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_tickets', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:09:24.803845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce6cb5f5-61d3-4cdd-84bd-f19fe6800753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7867c17490>]}
[0m15:09:24.893223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce6cb5f5-61d3-4cdd-84bd-f19fe6800753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7869de1030>]}
[0m15:09:24.895473 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:09:24.912046 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:09:25.788072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:25.790233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:25.800653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce6cb5f5-61d3-4cdd-84bd-f19fe6800753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78660318d0>]}
[0m15:09:25.848439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce6cb5f5-61d3-4cdd-84bd-f19fe6800753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78662004f0>]}
[0m15:09:25.850284 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:09:25.852086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6cb5f5-61d3-4cdd-84bd-f19fe6800753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7866200700>]}
[0m15:09:25.855208 [info ] [MainThread]: 
[0m15:09:25.857807 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:09:25.860825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:09:25.873330 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:09:25.874732 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:09:25.875738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:25.887813 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:09:25.890247 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:09:25.895468 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:09:25.896788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:09:25.898183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:09:25.899758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:09:25.905793 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:09:25.908907 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:09:25.912646 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:09:25.916401 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:09:25.918337 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:09:25.920293 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:09:25.922000 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:09:25.923510 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:09:25.925091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:25.926791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:25.928563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:25.930361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:25.939652 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:09:25.941540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:09:25.942001 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:09:25.943659 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:09:25.944192 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:09:25.945411 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:09:25.946153 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:09:25.947712 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:09:25.949635 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:09:25.950896 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:09:25.953049 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:09:25.956208 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:09:25.956891 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m15:09:25.958950 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:09:25.961909 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:09:25.962537 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:09:25.963390 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:09:25.964994 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:09:25.966750 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:09:25.968180 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:09:25.970753 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:09:25.972577 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:09:25.979737 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:09:25.982782 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:09:25.998750 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.001761 [debug] [MainThread]: On master: BEGIN
[0m15:09:26.004713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:26.017156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:09:26.019838 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.022613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:09:26.065463 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m15:09:26.069730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6cb5f5-61d3-4cdd-84bd-f19fe6800753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7865e8a950>]}
[0m15:09:26.071375 [debug] [MainThread]: On master: ROLLBACK
[0m15:09:26.073110 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.075009 [debug] [MainThread]: On master: BEGIN
[0m15:09:26.077016 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:09:26.078362 [debug] [MainThread]: On master: COMMIT
[0m15:09:26.079644 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.081252 [debug] [MainThread]: On master: COMMIT
[0m15:09:26.083327 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:09:26.084680 [debug] [MainThread]: On master: Close
[0m15:09:26.086413 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:26.088661 [info ] [MainThread]: 
[0m15:09:26.098161 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_tickets
[0m15:09:26.099818 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_tickets .......................... [RUN]
[0m15:09:26.101848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_tickets)
[0m15:09:26.103308 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_tickets
[0m15:09:26.112143 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_tickets"
[0m15:09:26.126849 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_tickets (compile): 15:09:26.104586 => 15:09:26.126474
[0m15:09:26.128168 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_tickets
[0m15:09:26.162737 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_tickets"
[0m15:09:26.175645 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:09:26.176880 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: BEGIN
[0m15:09:26.177915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:26.187080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:09:26.188482 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:09:26.189742 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_tickets"} */

  create view "warehouse"."marts_staging"."stg_tickets__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_tickets
),

base as (
    select
        (j->>'id')::bigint                           as ticket_id,

        nullif(j->>'createdAt','')::timestamptz     as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz     as updated_at_raw,

        -- propriétés
        (j->'properties'->>'subject')               as subject,
        (j->'properties'->>'content')               as content,
        (j->'properties'->>'source_type')           as source_type,

        nullif(j->'properties'->>'createdate','')::timestamptz      as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz as lastmodifieddate,
        nullif(j->'properties'->>'closed_date','')::timestamptz     as closed_date,

        (j->'properties'->>'hs_pipeline')           as pipeline_id,
        (j->'properties'->>'hs_pipeline_stage')     as pipeline_stage_id,

        nullif(j->'properties'->>'time_to_close','')::bigint        as time_to_close_ms,

        nullif(j->'properties'->>'created_by','')::bigint           as created_by_contact_id,
        nullif(j->'properties'->>'hs_primary_company_id','')::bigint as primary_company_id,
        (j->'properties'->>'hs_primary_company_name')               as primary_company_name,

        nullif(j->'properties'->>'hs_last_closed_date','')::timestamptz as last_closed_date,

        -- flags dérivables
        (nullif(j->'properties'->>'closed_date','') is not null)    as is_closed,

        -- associations racine
        j->'contacts'   as contacts_json,
        j->'companies'  as companies_json,

        extracted_at
    from src
)

select
    ticket_id,
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,
    closed_date,
    is_closed,

    subject,
    content,
    source_type,

    pipeline_id,
    pipeline_stage_id,
    time_to_close_ms,

    created_by_contact_id,
    primary_company_id,
    primary_company_name,

    last_closed_date,
    contacts_json,
    companies_json,
    extracted_at
from basewith src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_tickets
),

base as (
    select
        (j->>'id')::bigint                           as ticket_id,

        nullif(j->>'createdAt','')::timestamptz     as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz     as updated_at_raw,

        -- propriétés
        (j->'properties'->>'subject')               as subject,
        (j->'properties'->>'content')               as content,
        (j->'properties'->>'source_type')           as source_type,

        nullif(j->'properties'->>'createdate','')::timestamptz      as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz as lastmodifieddate,
        nullif(j->'properties'->>'closed_date','')::timestamptz     as closed_date,

        (j->'properties'->>'hs_pipeline')           as pipeline_id,
        (j->'properties'->>'hs_pipeline_stage')     as pipeline_stage_id,

        nullif(j->'properties'->>'time_to_close','')::bigint        as time_to_close_ms,

        nullif(j->'properties'->>'created_by','')::bigint           as created_by_contact_id,
        nullif(j->'properties'->>'hs_primary_company_id','')::bigint as primary_company_id,
        (j->'properties'->>'hs_primary_company_name')               as primary_company_name,

        nullif(j->'properties'->>'hs_last_closed_date','')::timestamptz as last_closed_date,

        -- flags dérivables
        (nullif(j->'properties'->>'closed_date','') is not null)    as is_closed,

        -- associations racine
        j->'contacts'   as contacts_json,
        j->'companies'  as companies_json,

        extracted_at
    from src
)

select
    ticket_id,
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,
    closed_date,
    is_closed,

    subject,
    content,
    source_type,

    pipeline_id,
    pipeline_stage_id,
    time_to_close_ms,

    created_by_contact_id,
    primary_company_id,
    primary_company_name,

    last_closed_date,
    contacts_json,
    companies_json,
    extracted_at
from base
  );
[0m15:09:26.191626 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 75: from basewith src as (
                           ^

[0m15:09:26.193293 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: ROLLBACK
[0m15:09:26.195204 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_tickets (execute): 15:09:26.129471 => 15:09:26.194905
[0m15:09:26.196309 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: Close
[0m15:09:26.199145 [debug] [Thread-1 (]: Database Error in model stg_tickets (models/staging/hubspot/stg_tickets.sql)
  syntax error at or near "as"
  LINE 75: from basewith src as (
                             ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_tickets.sql
[0m15:09:26.201518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce6cb5f5-61d3-4cdd-84bd-f19fe6800753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7865f45a50>]}
[0m15:09:26.202981 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_tickets ................. [[31mERROR[0m in 0.10s]
[0m15:09:26.205323 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_tickets
[0m15:09:26.209089 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.210601 [debug] [MainThread]: On master: BEGIN
[0m15:09:26.211879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:26.220636 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:09:26.222446 [debug] [MainThread]: On master: COMMIT
[0m15:09:26.224195 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.225542 [debug] [MainThread]: On master: COMMIT
[0m15:09:26.227139 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:09:26.228921 [debug] [MainThread]: On master: Close
[0m15:09:26.230847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:26.232251 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:09:26.233766 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:09:26.235823 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:09:26.237249 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_tickets' was properly closed.
[0m15:09:26.238698 [info ] [MainThread]: 
[0m15:09:26.240322 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:09:26.242800 [debug] [MainThread]: Command end result
[0m15:09:26.322197 [info ] [MainThread]: 
[0m15:09:26.324273 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:26.326640 [info ] [MainThread]: 
[0m15:09:26.328641 [error] [MainThread]:   Database Error in model stg_tickets (models/staging/hubspot/stg_tickets.sql)
  syntax error at or near "as"
  LINE 75: from basewith src as (
                             ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_tickets.sql
[0m15:09:26.330470 [info ] [MainThread]: 
[0m15:09:26.332759 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:09:26.335514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8017305, "process_user_time": 2.369705, "process_kernel_time": 0.420751, "process_mem_max_rss": "105772", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:09:26.337487 [debug] [MainThread]: Command `dbt run` failed at 15:09:26.337283 after 1.80 seconds
[0m15:09:26.339717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7869764610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78663bcc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78662bca90>]}
[0m15:09:26.341643 [debug] [MainThread]: Flushing usage events
[0m15:09:59.161941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53630ec370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5361519690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5361519630>]}


============================== 15:09:59.168362 | 4b1108dd-1844-400a-8620-df3db7e2e5fe ==============================
[0m15:09:59.168362 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:09:59.170301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_tickets', 'send_anonymous_usage_stats': 'True'}
[0m15:09:59.363412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b1108dd-1844-400a-8620-df3db7e2e5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a536155f460>]}
[0m15:09:59.449416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b1108dd-1844-400a-8620-df3db7e2e5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5363621030>]}
[0m15:09:59.451763 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:09:59.469891 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:10:00.733215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:00.736065 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_tickets.sql
[0m15:10:01.081795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b1108dd-1844-400a-8620-df3db7e2e5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a536155f6d0>]}
[0m15:10:01.128695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b1108dd-1844-400a-8620-df3db7e2e5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535f94b730>]}
[0m15:10:01.130801 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:10:01.132932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b1108dd-1844-400a-8620-df3db7e2e5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535f94b820>]}
[0m15:10:01.136649 [info ] [MainThread]: 
[0m15:10:01.138980 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:01.141900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:10:01.153310 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:10:01.154826 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:10:01.156527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:01.168625 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:10:01.171285 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:10:01.176143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m15:10:01.177466 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:10:01.179075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:10:01.180532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:10:01.186346 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:10:01.189452 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:10:01.193231 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:10:01.197120 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:10:01.199049 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:10:01.200579 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:10:01.202100 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:10:01.203778 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:10:01.205206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:01.206768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:01.208509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:01.210069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:01.219871 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:01.221558 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:10:01.222075 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:01.223529 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:01.224110 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:10:01.225386 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:01.226227 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:10:01.227831 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:10:01.230540 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:10:01.232190 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:10:01.233550 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:01.234374 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:10:01.235871 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:10:01.239214 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:10:01.241610 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:01.244010 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:10:01.245843 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:10:01.246300 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m15:10:01.246799 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:01.252831 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:10:01.255419 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:10:01.257893 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:10:01.261906 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:10:01.263399 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:10:01.274270 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:01.276451 [debug] [MainThread]: On master: BEGIN
[0m15:10:01.278112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:01.288206 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:01.289846 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:01.291502 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:01.329415 [debug] [MainThread]: SQL status: SELECT 12 in 0.0 seconds
[0m15:10:01.332821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b1108dd-1844-400a-8620-df3db7e2e5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535fc55450>]}
[0m15:10:01.334552 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:01.336387 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:01.337947 [debug] [MainThread]: On master: BEGIN
[0m15:10:01.340064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:01.341730 [debug] [MainThread]: On master: COMMIT
[0m15:10:01.343162 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:01.344827 [debug] [MainThread]: On master: COMMIT
[0m15:10:01.346647 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:01.348258 [debug] [MainThread]: On master: Close
[0m15:10:01.350151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:01.352163 [info ] [MainThread]: 
[0m15:10:01.361375 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_tickets
[0m15:10:01.363092 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_tickets .......................... [RUN]
[0m15:10:01.365527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_tickets)
[0m15:10:01.367028 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_tickets
[0m15:10:01.376831 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_tickets"
[0m15:10:01.390073 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_tickets (compile): 15:10:01.368296 => 15:10:01.389682
[0m15:10:01.391968 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_tickets
[0m15:10:01.426199 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_tickets"
[0m15:10:01.437540 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:10:01.438805 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: BEGIN
[0m15:10:01.440069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:01.448369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:01.449857 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:10:01.451342 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_tickets"} */

  create view "warehouse"."marts_staging"."stg_tickets__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_tickets
),

base as (
    select
        (j->>'id')::bigint                           as ticket_id,

        nullif(j->>'createdAt','')::timestamptz     as created_at_raw,
        nullif(j->>'updatedAt','')::timestamptz     as updated_at_raw,

        -- propriétés
        (j->'properties'->>'subject')               as subject,
        (j->'properties'->>'content')               as content,
        (j->'properties'->>'source_type')           as source_type,

        nullif(j->'properties'->>'createdate','')::timestamptz      as createdate,
        nullif(j->'properties'->>'hs_lastmodifieddate','')::timestamptz as lastmodifieddate,
        nullif(j->'properties'->>'closed_date','')::timestamptz     as closed_date,

        (j->'properties'->>'hs_pipeline')           as pipeline_id,
        (j->'properties'->>'hs_pipeline_stage')     as pipeline_stage_id,

        nullif(j->'properties'->>'time_to_close','')::bigint        as time_to_close_ms,

        nullif(j->'properties'->>'created_by','')::bigint           as created_by_contact_id,
        nullif(j->'properties'->>'hs_primary_company_id','')::bigint as primary_company_id,
        (j->'properties'->>'hs_primary_company_name')               as primary_company_name,

        nullif(j->'properties'->>'hs_last_closed_date','')::timestamptz as last_closed_date,

        -- flags dérivables
        (nullif(j->'properties'->>'closed_date','') is not null)    as is_closed,

        -- associations racine
        j->'contacts'   as contacts_json,
        j->'companies'  as companies_json,

        extracted_at
    from src
)

select
    ticket_id,
    coalesce(createdate, created_at_raw)       as created_at,
    coalesce(lastmodifieddate, updated_at_raw) as updated_at,
    closed_date,
    is_closed,

    subject,
    content,
    source_type,

    pipeline_id,
    pipeline_stage_id,
    time_to_close_ms,

    created_by_contact_id,
    primary_company_id,
    primary_company_name,

    last_closed_date,
    contacts_json,
    companies_json,
    extracted_at
from base
  );
[0m15:10:01.458229 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:10:01.465360 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:10:01.467272 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_tickets"} */
alter table "warehouse"."marts_staging"."stg_tickets__dbt_tmp" rename to "stg_tickets"
[0m15:10:01.469788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:10:01.485555 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: COMMIT
[0m15:10:01.487504 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:10:01.489757 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: COMMIT
[0m15:10:01.496198 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:10:01.505073 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_tickets__dbt_backup"
[0m15:10:01.510782 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_tickets"
[0m15:10:01.512718 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_tickets"} */
drop view if exists "warehouse"."marts_staging"."stg_tickets__dbt_backup" cascade
[0m15:10:01.514751 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:10:01.517493 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_tickets (execute): 15:10:01.393872 => 15:10:01.517247
[0m15:10:01.518921 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_tickets: Close
[0m15:10:01.520821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b1108dd-1844-400a-8620-df3db7e2e5fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a535d61e050>]}
[0m15:10:01.522522 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_tickets ..................... [[32mCREATE VIEW[0m in 0.16s]
[0m15:10:01.524728 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_tickets
[0m15:10:01.528056 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:01.529494 [debug] [MainThread]: On master: BEGIN
[0m15:10:01.531176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:01.539737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:01.541089 [debug] [MainThread]: On master: COMMIT
[0m15:10:01.542632 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:01.544324 [debug] [MainThread]: On master: COMMIT
[0m15:10:01.546549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:01.548059 [debug] [MainThread]: On master: Close
[0m15:10:01.549992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:01.551754 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:10:01.553259 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:10:01.554694 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:10:01.556011 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_tickets' was properly closed.
[0m15:10:01.557569 [info ] [MainThread]: 
[0m15:10:01.559284 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:10:01.561399 [debug] [MainThread]: Command end result
[0m15:10:01.593861 [info ] [MainThread]: 
[0m15:10:01.596043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:01.597868 [info ] [MainThread]: 
[0m15:10:01.599818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:10:01.602094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.4961863, "process_user_time": 2.801004, "process_kernel_time": 0.448325, "process_mem_max_rss": "108992", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:10:01.603894 [debug] [MainThread]: Command `dbt run` succeeded at 15:10:01.603672 after 2.50 seconds
[0m15:10:01.605710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a53630ec370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5361a08dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5363621030>]}
[0m15:10:01.608227 [debug] [MainThread]: Flushing usage events
[0m15:10:33.939398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba6f0ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba53757b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba5375750>]}


============================== 15:10:33.945766 | 02358028-2f7b-48d3-b515-a51a1b5b5196 ==============================
[0m15:10:33.945766 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:10:33.947417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_ticket_pipelines', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:10:34.165499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02358028-2f7b-48d3-b515-a51a1b5b5196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba53bb520>]}
[0m15:10:34.249874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02358028-2f7b-48d3-b515-a51a1b5b5196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba56762f0>]}
[0m15:10:34.251846 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:10:34.267648 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:10:35.139780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:35.142511 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_ticket_pipelines.sql
[0m15:10:35.478014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02358028-2f7b-48d3-b515-a51a1b5b5196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba3af1210>]}
[0m15:10:35.522927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02358028-2f7b-48d3-b515-a51a1b5b5196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba37af700>]}
[0m15:10:35.524647 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:10:35.526682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02358028-2f7b-48d3-b515-a51a1b5b5196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba37af970>]}
[0m15:10:35.530064 [info ] [MainThread]: 
[0m15:10:35.532999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:10:35.535747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:10:35.547621 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:10:35.549456 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:10:35.550981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:35.562882 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:10:35.566475 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:10:35.572644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m15:10:35.574395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:10:35.575934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:10:35.577512 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:10:35.583947 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:10:35.587086 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:10:35.590459 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:10:35.593722 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:10:35.595702 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:10:35.597416 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:10:35.598898 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:10:35.600569 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:10:35.601899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:35.603272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:35.604600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:35.606178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:35.615167 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:35.616825 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:10:35.617538 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:35.618112 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:35.618923 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:10:35.620698 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:10:35.621446 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:10:35.623818 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:10:35.626476 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:10:35.628212 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:10:35.629356 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:35.630540 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:10:35.633067 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:10:35.635569 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:10:35.635998 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:35.640021 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:10:35.641650 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:10:35.643151 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:10:35.643646 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m15:10:35.646656 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:10:35.648246 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:10:35.650578 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:10:35.652606 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:10:35.655166 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:10:35.665947 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:35.667855 [debug] [MainThread]: On master: BEGIN
[0m15:10:35.669541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:10:35.678786 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:35.680619 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:35.682060 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:10:35.721003 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:10:35.724389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02358028-2f7b-48d3-b515-a51a1b5b5196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba152b6d0>]}
[0m15:10:35.726447 [debug] [MainThread]: On master: ROLLBACK
[0m15:10:35.728297 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:35.729971 [debug] [MainThread]: On master: BEGIN
[0m15:10:35.732071 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:35.733868 [debug] [MainThread]: On master: COMMIT
[0m15:10:35.735570 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:35.737270 [debug] [MainThread]: On master: COMMIT
[0m15:10:35.739037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:35.740662 [debug] [MainThread]: On master: Close
[0m15:10:35.742739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:35.744864 [info ] [MainThread]: 
[0m15:10:35.754359 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_ticket_pipelines
[0m15:10:35.756359 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_ticket_pipelines ................. [RUN]
[0m15:10:35.758980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_ticket_pipelines)
[0m15:10:35.760991 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_ticket_pipelines
[0m15:10:35.771260 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:10:35.785910 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_ticket_pipelines (compile): 15:10:35.762791 => 15:10:35.785539
[0m15:10:35.787509 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_ticket_pipelines
[0m15:10:35.821800 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:10:35.834843 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:10:35.836176 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: BEGIN
[0m15:10:35.837786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:35.846415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:10:35.848498 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:10:35.850042 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_ticket_pipelines"} */

  create view "warehouse"."marts_staging"."stg_ticket_pipelines__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_tickt_pipelines
),

pipelines as (
    select
        (j->>'id')      as pipeline_id,
        (j->>'label')   as pipeline_label,
        j->'stages'     as stages_json,
        extracted_at
    from src
),

stages as (
    select
        p.pipeline_id,
        p.pipeline_label,

        (s->>'id')      as stage_id,
        (s->>'label')   as stage_label,
        coalesce((s->'metadata'->>'isClosed')::boolean, false) as is_closed_stage,
        (s->'metadata'->>'ticketState') as ticket_state,

        (s->>'displayOrder')::int as display_order,
        extracted_at
    from pipelines p
    cross join lateral jsonb_array_elements(p.stages_json) as s
)

select * from stages
  );
[0m15:10:35.852369 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airbyte_internal.raw_hubspot_raw__stream_tickt_pipelines" does not exist
LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                  ^

[0m15:10:35.853836 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: ROLLBACK
[0m15:10:35.855580 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_ticket_pipelines (execute): 15:10:35.789460 => 15:10:35.855277
[0m15:10:35.857503 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: Close
[0m15:10:35.860859 [debug] [Thread-1 (]: Database Error in model stg_ticket_pipelines (models/staging/hubspot/stg_ticket_pipelines.sql)
  relation "airbyte_internal.raw_hubspot_raw__stream_tickt_pipelines" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_ticket_pipelines.sql
[0m15:10:35.862791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02358028-2f7b-48d3-b515-a51a1b5b5196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba37e05b0>]}
[0m15:10:35.864536 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_ticket_pipelines ........ [[31mERROR[0m in 0.10s]
[0m15:10:35.866543 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_ticket_pipelines
[0m15:10:35.870216 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:35.871537 [debug] [MainThread]: On master: BEGIN
[0m15:10:35.872744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:10:35.881706 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:10:35.883189 [debug] [MainThread]: On master: COMMIT
[0m15:10:35.884184 [debug] [MainThread]: Using postgres connection "master"
[0m15:10:35.885373 [debug] [MainThread]: On master: COMMIT
[0m15:10:35.886923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:10:35.887924 [debug] [MainThread]: On master: Close
[0m15:10:35.889332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:35.890419 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:10:35.891436 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:10:35.892978 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:10:35.894065 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_ticket_pipelines' was properly closed.
[0m15:10:35.895425 [info ] [MainThread]: 
[0m15:10:35.897009 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m15:10:35.899464 [debug] [MainThread]: Command end result
[0m15:10:35.929094 [info ] [MainThread]: 
[0m15:10:35.931125 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:10:35.933061 [info ] [MainThread]: 
[0m15:10:35.935108 [error] [MainThread]:   Database Error in model stg_ticket_pipelines (models/staging/hubspot/stg_ticket_pipelines.sql)
  relation "airbyte_internal.raw_hubspot_raw__stream_tickt_pipelines" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw_hubspot_raw__stream_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_ticket_pipelines.sql
[0m15:10:35.937288 [info ] [MainThread]: 
[0m15:10:35.939097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:10:35.941736 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.0573595, "process_user_time": 2.672693, "process_kernel_time": 0.411804, "process_mem_max_rss": "109624", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:10:35.943622 [debug] [MainThread]: Command `dbt run` failed at 15:10:35.943438 after 2.06 seconds
[0m15:10:35.944826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba6f0ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba56762f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e5ba39a8790>]}
[0m15:10:35.946520 [debug] [MainThread]: Flushing usage events
[0m15:10:57.752980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62edbf72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62ec071930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62ec0718d0>]}


============================== 15:10:57.759517 | d4b3fcc1-7ffe-435f-99c9-e773de469d16 ==============================
[0m15:10:57.759517 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:10:57.761672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_ticket_pipelines', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:57.966920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4b3fcc1-7ffe-435f-99c9-e773de469d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62ec0b3580>]}
[0m15:10:58.054427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4b3fcc1-7ffe-435f-99c9-e773de469d16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62ee27cd90>]}
[0m15:10:58.056533 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:10:58.075258 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:10:59.115791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:59.118441 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_ticket_pipelines.sql
[0m15:10:59.403257 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.hubspot_dbt.stg_ticket_pipelines' (models/staging/hubspot/stg_ticket_pipelines.sql) depends on a source named 'hubspot.raw_hubspot_raw__stream_ticket_pipelines' which was not found
[0m15:10:59.406028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7108444, "process_user_time": 2.62736, "process_kernel_time": 0.491391, "process_mem_max_rss": "100512", "process_out_blocks": "608", "command_success": false, "process_in_blocks": "0"}
[0m15:10:59.408062 [debug] [MainThread]: Command `dbt run` failed at 15:10:59.407866 after 1.71 seconds
[0m15:10:59.409695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62edbf72b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62ea39ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b62ea39ff40>]}
[0m15:10:59.411225 [debug] [MainThread]: Flushing usage events
[0m15:11:18.953553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e86968610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e84d95720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e84d956c0>]}


============================== 15:11:18.960431 | 7bf2cf1d-9886-4883-ba00-10dde66a129b ==============================
[0m15:11:18.960431 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:11:18.962417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_ticket_pipelines', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:19.177282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bf2cf1d-9886-4883-ba00-10dde66a129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e84dd74c0>]}
[0m15:11:19.272076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bf2cf1d-9886-4883-ba00-10dde66a129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e86ea2170>]}
[0m15:11:19.274230 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:11:19.293803 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:11:20.558498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:11:20.563484 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/sources/src_hubspot.yml
[0m15:11:20.565634 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_ticket_pipelines.sql
[0m15:11:21.170781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bf2cf1d-9886-4883-ba00-10dde66a129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e80ecbe20>]}
[0m15:11:21.217655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bf2cf1d-9886-4883-ba00-10dde66a129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e833c0520>]}
[0m15:11:21.219890 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:11:21.222211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf2cf1d-9886-4883-ba00-10dde66a129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e833c0730>]}
[0m15:11:21.225647 [info ] [MainThread]: 
[0m15:11:21.228236 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:21.231251 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:11:21.244245 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:11:21.245788 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:11:21.247315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:21.259188 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:11:21.261626 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:11:21.266765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:11:21.268227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:11:21.269982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:11:21.271399 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:11:21.277563 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:11:21.280454 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:11:21.284436 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:11:21.288256 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:11:21.290132 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:11:21.291623 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:11:21.293149 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:11:21.294884 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:11:21.296334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:21.297921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:21.299535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:21.301005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:21.310659 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:21.311892 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:21.313411 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:21.314272 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:11:21.314776 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:21.315762 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:11:21.317114 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:11:21.318573 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:11:21.320012 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:11:21.321450 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:11:21.322973 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:11:21.325654 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:11:21.328702 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m15:11:21.331296 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:11:21.332878 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:11:21.336346 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:11:21.337991 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:11:21.339128 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:11:21.342095 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:11:21.344286 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:11:21.346608 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:11:21.349077 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:11:21.350675 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:11:21.356571 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:11:21.371441 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:21.373416 [debug] [MainThread]: On master: BEGIN
[0m15:11:21.375130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:21.386082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:21.388054 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:21.389418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:21.428842 [debug] [MainThread]: SQL status: SELECT 13 in 0.0 seconds
[0m15:11:21.432535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf2cf1d-9886-4883-ba00-10dde66a129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e831c7670>]}
[0m15:11:21.434522 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:21.436172 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:21.437628 [debug] [MainThread]: On master: BEGIN
[0m15:11:21.439425 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:21.440903 [debug] [MainThread]: On master: COMMIT
[0m15:11:21.442268 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:21.443471 [debug] [MainThread]: On master: COMMIT
[0m15:11:21.445022 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:21.446805 [debug] [MainThread]: On master: Close
[0m15:11:21.448732 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:21.451113 [info ] [MainThread]: 
[0m15:11:21.460594 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_ticket_pipelines
[0m15:11:21.462318 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_ticket_pipelines ................. [RUN]
[0m15:11:21.464376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_ticket_pipelines)
[0m15:11:21.466182 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_ticket_pipelines
[0m15:11:21.474943 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:11:21.487435 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_ticket_pipelines (compile): 15:11:21.467717 => 15:11:21.487071
[0m15:11:21.489578 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_ticket_pipelines
[0m15:11:21.525385 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:11:21.540687 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:11:21.542505 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: BEGIN
[0m15:11:21.544486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:21.553950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:21.555720 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:11:21.557294 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_ticket_pipelines"} */

  create view "warehouse"."marts_staging"."stg_ticket_pipelines__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_ticket_pipelines
),

pipelines as (
    select
        (j->>'id')      as pipeline_id,
        (j->>'label')   as pipeline_label,
        j->'stages'     as stages_json,
        extracted_at
    from src
),

stages as (
    select
        p.pipeline_id,
        p.pipeline_label,

        (s->>'id')      as stage_id,
        (s->>'label')   as stage_label,
        coalesce((s->'metadata'->>'isClosed')::boolean, false) as is_closed_stage,
        (s->'metadata'->>'ticketState') as ticket_state,

        (s->>'displayOrder')::int as display_order,
        extracted_at
    from pipelines p
    cross join lateral jsonb_array_elements(p.stages_json) as s
)

select * from stages
  );
[0m15:11:21.563222 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:11:21.570824 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:11:21.572655 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_ticket_pipelines"} */
alter table "warehouse"."marts_staging"."stg_ticket_pipelines__dbt_tmp" rename to "stg_ticket_pipelines"
[0m15:11:21.575227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:21.589748 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: COMMIT
[0m15:11:21.591805 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:11:21.593672 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: COMMIT
[0m15:11:21.597651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:21.605501 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_ticket_pipelines__dbt_backup"
[0m15:11:21.611446 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_pipelines"
[0m15:11:21.613507 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_ticket_pipelines"} */
drop view if exists "warehouse"."marts_staging"."stg_ticket_pipelines__dbt_backup" cascade
[0m15:11:21.615656 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:11:21.618445 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_ticket_pipelines (execute): 15:11:21.490922 => 15:11:21.618253
[0m15:11:21.620314 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_pipelines: Close
[0m15:11:21.622743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf2cf1d-9886-4883-ba00-10dde66a129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e80d6add0>]}
[0m15:11:21.624799 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_ticket_pipelines ............ [[32mCREATE VIEW[0m in 0.16s]
[0m15:11:21.627082 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_ticket_pipelines
[0m15:11:21.630864 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:21.632223 [debug] [MainThread]: On master: BEGIN
[0m15:11:21.633639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:21.643179 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:21.644698 [debug] [MainThread]: On master: COMMIT
[0m15:11:21.646052 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:21.647438 [debug] [MainThread]: On master: COMMIT
[0m15:11:21.649237 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:21.650945 [debug] [MainThread]: On master: Close
[0m15:11:21.652526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:21.653848 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:11:21.655030 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:11:21.656959 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:11:21.658967 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_ticket_pipelines' was properly closed.
[0m15:11:21.660155 [info ] [MainThread]: 
[0m15:11:21.661811 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m15:11:21.664210 [debug] [MainThread]: Command end result
[0m15:11:21.698350 [info ] [MainThread]: 
[0m15:11:21.700807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:21.702808 [info ] [MainThread]: 
[0m15:11:21.704863 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:11:21.707473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8141944, "process_user_time": 3.107303, "process_kernel_time": 0.494435, "process_mem_max_rss": "110964", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:11:21.709429 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:21.709198 after 2.82 seconds
[0m15:11:21.711269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e86968610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e8347c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745e86ea2170>]}
[0m15:11:21.713485 [debug] [MainThread]: Flushing usage events
[0m15:11:52.068370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791252070610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7912504ed720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7912504ed6c0>]}


============================== 15:11:52.075309 | 19b12a35-5927-48a8-bf1d-5c68adf8402a ==============================
[0m15:11:52.075309 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:11:52.077116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_ticket_contacts', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:52.281320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19b12a35-5927-48a8-bf1d-5c68adf8402a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79125052f4c0>]}
[0m15:11:52.364473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19b12a35-5927-48a8-bf1d-5c68adf8402a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7912526fe170>]}
[0m15:11:52.366793 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:11:52.384613 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:11:53.372858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:11:53.377329 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_ticket_contacts.sql
[0m15:11:53.737460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19b12a35-5927-48a8-bf1d-5c68adf8402a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7912504ec1f0>]}
[0m15:11:53.784561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19b12a35-5927-48a8-bf1d-5c68adf8402a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79124e91f8b0>]}
[0m15:11:53.786476 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:11:53.788583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19b12a35-5927-48a8-bf1d-5c68adf8402a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79125052f550>]}
[0m15:11:53.792522 [info ] [MainThread]: 
[0m15:11:53.794963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:53.798035 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:11:53.809945 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:11:53.812058 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:11:53.813450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:53.826227 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:11:53.828744 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:11:53.834310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_marts)
[0m15:11:53.835806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:11:53.837553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:11:53.839339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:11:53.846227 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:11:53.849074 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:11:53.852959 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:11:53.856299 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:11:53.858013 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:11:53.859983 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:11:53.861514 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:11:53.863058 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:11:53.864778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:53.866516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:53.868341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:53.869992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:53.879718 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:53.881673 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:53.882720 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:11:53.883167 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:53.886301 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:11:53.886813 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:11:53.888648 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:11:53.890007 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:11:53.891322 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:11:53.893249 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:11:53.896939 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:11:53.898811 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:11:53.900790 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:11:53.903853 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:11:53.905141 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:11:53.906548 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:11:53.910926 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m15:11:53.912980 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:11:53.915513 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:11:53.917488 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:11:53.920189 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:11:53.922546 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:11:53.925726 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:11:53.927366 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:11:53.940441 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:53.942135 [debug] [MainThread]: On master: BEGIN
[0m15:11:53.943824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:53.952667 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:53.954260 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:53.955872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:53.996342 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m15:11:53.999910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19b12a35-5927-48a8-bf1d-5c68adf8402a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79124e88f580>]}
[0m15:11:54.001783 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:54.003643 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:54.005432 [debug] [MainThread]: On master: BEGIN
[0m15:11:54.007972 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:54.009628 [debug] [MainThread]: On master: COMMIT
[0m15:11:54.011227 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:54.012709 [debug] [MainThread]: On master: COMMIT
[0m15:11:54.014695 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:54.016446 [debug] [MainThread]: On master: Close
[0m15:11:54.018308 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:54.020246 [info ] [MainThread]: 
[0m15:11:54.029908 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_ticket_contacts
[0m15:11:54.031951 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_ticket_contacts .................. [RUN]
[0m15:11:54.034545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_ticket_contacts)
[0m15:11:54.036310 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_ticket_contacts
[0m15:11:54.045570 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_ticket_contacts"
[0m15:11:54.059867 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_ticket_contacts (compile): 15:11:54.037546 => 15:11:54.059506
[0m15:11:54.061234 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_ticket_contacts
[0m15:11:54.096005 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_ticket_contacts"
[0m15:11:54.110131 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_contacts"
[0m15:11:54.112190 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_contacts: BEGIN
[0m15:11:54.114102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:54.123246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:11:54.124678 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_contacts"
[0m15:11:54.126536 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_ticket_contacts"} */

  create view "warehouse"."marts_staging"."stg_ticket_contacts__dbt_tmp"
    
    
  as (
    with tickets as (
    select
        ticket_id,
        contacts_json
    from "warehouse"."marts_staging"."stg_tickets"
),

exploded as (
    select
        t.ticket_id,
        (c)::text::bigint as contact_id
    from tickets t
    cross join lateral jsonb_array_elements_text(t.contacts_json) as c
)

select * from exploded
  );
[0m15:11:54.132170 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:11:54.139753 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_contacts"
[0m15:11:54.141305 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_ticket_contacts"} */
alter table "warehouse"."marts_staging"."stg_ticket_contacts__dbt_tmp" rename to "stg_ticket_contacts"
[0m15:11:54.143417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:11:54.158110 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_contacts: COMMIT
[0m15:11:54.159999 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_contacts"
[0m15:11:54.161969 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_contacts: COMMIT
[0m15:11:54.167820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:11:54.176029 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_ticket_contacts__dbt_backup"
[0m15:11:54.182047 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_ticket_contacts"
[0m15:11:54.184129 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_contacts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_ticket_contacts"} */
drop view if exists "warehouse"."marts_staging"."stg_ticket_contacts__dbt_backup" cascade
[0m15:11:54.186273 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:11:54.189577 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_ticket_contacts (execute): 15:11:54.062871 => 15:11:54.189301
[0m15:11:54.191265 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_ticket_contacts: Close
[0m15:11:54.193263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19b12a35-5927-48a8-bf1d-5c68adf8402a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79124c5ee0b0>]}
[0m15:11:54.194960 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_ticket_contacts ............. [[32mCREATE VIEW[0m in 0.16s]
[0m15:11:54.197714 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_ticket_contacts
[0m15:11:54.200954 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:54.202608 [debug] [MainThread]: On master: BEGIN
[0m15:11:54.204372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:54.212826 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:11:54.214266 [debug] [MainThread]: On master: COMMIT
[0m15:11:54.215642 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:54.217430 [debug] [MainThread]: On master: COMMIT
[0m15:11:54.219403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:11:54.220730 [debug] [MainThread]: On master: Close
[0m15:11:54.222644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:54.224401 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:11:54.225703 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:11:54.226936 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:11:54.228228 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_ticket_contacts' was properly closed.
[0m15:11:54.229460 [info ] [MainThread]: 
[0m15:11:54.231514 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m15:11:54.233959 [debug] [MainThread]: Command end result
[0m15:11:54.267820 [info ] [MainThread]: 
[0m15:11:54.269614 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:54.271771 [info ] [MainThread]: 
[0m15:11:54.274013 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:11:54.276753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.266545, "process_user_time": 2.954243, "process_kernel_time": 0.546934, "process_mem_max_rss": "109216", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:11:54.278591 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:54.278392 after 2.27 seconds
[0m15:11:54.280357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x791252070610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79124ec25ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79124e91fe80>]}
[0m15:11:54.282296 [debug] [MainThread]: Flushing usage events
[0m15:13:14.129085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5cda18a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5cbe957b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5cbe95750>]}


============================== 15:13:14.136741 | 24b162d9-cdba-4b41-8a3d-a6a58a15aec7 ==============================
[0m15:13:14.136741 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:13:14.138768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_ticket_forms', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:13:14.366326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24b162d9-cdba-4b41-8a3d-a6a58a15aec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5cbed7520>]}
[0m15:13:14.467382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24b162d9-cdba-4b41-8a3d-a6a58a15aec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5cc18e2f0>]}
[0m15:13:14.469853 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:13:14.487507 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:13:15.516094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:13:15.519243 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_forms.sql
[0m15:13:15.858034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24b162d9-cdba-4b41-8a3d-a6a58a15aec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca58bfcdc30>]}
[0m15:13:15.903377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24b162d9-cdba-4b41-8a3d-a6a58a15aec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5ca2c7850>]}
[0m15:13:15.905068 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:13:15.907087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24b162d9-cdba-4b41-8a3d-a6a58a15aec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5ca2c79d0>]}
[0m15:13:15.909446 [warn ] [MainThread]: The selection criterion 'stg_ticket_forms' does not match any nodes
[0m15:13:15.912262 [info ] [MainThread]: 
[0m15:13:15.914310 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:13:15.916487 [debug] [MainThread]: Command end result
[0m15:13:15.949106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8861569, "process_user_time": 2.812074, "process_kernel_time": 0.458791, "process_mem_max_rss": "103880", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m15:13:15.952149 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:15.951903 after 1.89 seconds
[0m15:13:15.954153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5cda18a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5ca512200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ca5ca2c7fd0>]}
[0m15:13:15.956734 [debug] [MainThread]: Flushing usage events
[0m15:14:02.217014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db65aaa0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db658f096f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db658f09690>]}


============================== 15:14:02.223652 | 3f98f39a-ee56-4e3d-adc5-c91fb105035a ==============================
[0m15:14:02.223652 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:14:02.225450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_ticket_form_submissions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:14:02.437481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f98f39a-ee56-4e3d-adc5-c91fb105035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db658f4f490>]}
[0m15:14:02.527820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f98f39a-ee56-4e3d-adc5-c91fb105035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db65b11d030>]}
[0m15:14:02.530106 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:14:02.546360 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:14:03.639643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:14:03.642105 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_form_submissions.sql
[0m15:14:03.997765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f98f39a-ee56-4e3d-adc5-c91fb105035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db655139720>]}
[0m15:14:04.042352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f98f39a-ee56-4e3d-adc5-c91fb105035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6573437c0>]}
[0m15:14:04.043885 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:14:04.045707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f98f39a-ee56-4e3d-adc5-c91fb105035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6573438b0>]}
[0m15:14:04.047874 [warn ] [MainThread]: The selection criterion 'stg_ticket_form_submissions' does not match any nodes
[0m15:14:04.050682 [info ] [MainThread]: 
[0m15:14:04.052723 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:14:04.054794 [debug] [MainThread]: Command end result
[0m15:14:04.086682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9246234, "process_user_time": 3.063093, "process_kernel_time": 0.488791, "process_mem_max_rss": "104216", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m15:14:04.088221 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:04.088083 after 1.93 seconds
[0m15:14:04.089501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db65aaa0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6571b8580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7db6576f8c70>]}
[0m15:14:04.091261 [debug] [MainThread]: Flushing usage events
[0m15:15:50.995226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7ccc38610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7cb061720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7cb0616c0>]}


============================== 15:15:51.002184 | 81674f7e-38ff-4da7-a26a-bcdf212e869f ==============================
[0m15:15:51.002184 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:15:51.004266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_ticket_form_submissions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:15:51.264544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81674f7e-38ff-4da7-a26a-bcdf212e869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7cb0a74c0>]}
[0m15:15:51.354404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81674f7e-38ff-4da7-a26a-bcdf212e869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7cd172170>]}
[0m15:15:51.356712 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:15:51.372815 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:15:52.319063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:15:52.322723 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/sources/src_hubspot.yml
[0m15:15:52.324130 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_form_submissions.sql
[0m15:15:52.935307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81674f7e-38ff-4da7-a26a-bcdf212e869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7ab0a3e80>]}
[0m15:15:52.983575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81674f7e-38ff-4da7-a26a-bcdf212e869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7c9690580>]}
[0m15:15:52.985344 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:15:52.987589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81674f7e-38ff-4da7-a26a-bcdf212e869f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7c9690790>]}
[0m15:15:52.990209 [warn ] [MainThread]: The selection criterion 'stg_ticket_form_submissions' does not match any nodes
[0m15:15:52.993587 [info ] [MainThread]: 
[0m15:15:52.996098 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:15:52.998609 [debug] [MainThread]: Command end result
[0m15:15:53.038003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.101516, "process_user_time": 3.372242, "process_kernel_time": 0.421029, "process_mem_max_rss": "105508", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m15:15:53.040294 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:53.040103 after 2.10 seconds
[0m15:15:53.041858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7ccc38610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7c9696890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ac7c984c6d0>]}
[0m15:15:53.043741 [debug] [MainThread]: Flushing usage events
[0m15:16:18.793900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeeeb66ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee9ad57b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee9ad5750>]}


============================== 15:16:18.800571 | a063fbf6-f0ac-4143-a808-f3d5be04b45d ==============================
[0m15:16:18.800571 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:16:18.802863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_form_submissions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:16:19.020717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a063fbf6-f0ac-4143-a808-f3d5be04b45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee9b1b520>]}
[0m15:16:19.110002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a063fbf6-f0ac-4143-a808-f3d5be04b45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee9dd62f0>]}
[0m15:16:19.111972 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:16:19.128668 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:16:20.221242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:16:20.223046 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:16:20.233956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a063fbf6-f0ac-4143-a808-f3d5be04b45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee7f399c0>]}
[0m15:16:20.349213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a063fbf6-f0ac-4143-a808-f3d5be04b45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee8108640>]}
[0m15:16:20.353987 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:16:20.362721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a063fbf6-f0ac-4143-a808-f3d5be04b45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee81088b0>]}
[0m15:16:20.370525 [info ] [MainThread]: 
[0m15:16:20.375677 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:20.382158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:16:20.407762 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:16:20.410108 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:16:20.414170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:20.429211 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:16:20.431769 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:16:20.438248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_marts)
[0m15:16:20.440407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:16:20.442321 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:16:20.450566 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:16:20.451855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:16:20.455589 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:16:20.460424 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:16:20.462357 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:16:20.466113 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:16:20.468164 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:16:20.469949 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:16:20.471921 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:20.474284 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:16:20.476244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:20.478367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:20.482016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:20.489960 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:16:20.492521 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:16:20.494837 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:16:20.496515 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:16:20.497265 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:16:20.498700 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:16:20.499582 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:16:20.502007 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:16:20.506220 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:16:20.508537 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:16:20.509523 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:16:20.510806 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:16:20.512543 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:16:20.515913 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:16:20.518208 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:16:20.521683 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:16:20.524495 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:16:20.526963 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:16:20.527569 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m15:16:20.530029 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:16:20.534206 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:16:20.541412 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:16:20.544289 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:16:20.551037 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:16:20.611291 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:20.620088 [debug] [MainThread]: On master: BEGIN
[0m15:16:20.629064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:20.652659 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:20.656048 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:20.659706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:20.715193 [debug] [MainThread]: SQL status: SELECT 15 in 0.0 seconds
[0m15:16:20.719118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a063fbf6-f0ac-4143-a808-f3d5be04b45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee7d93520>]}
[0m15:16:20.720729 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:20.722396 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:20.723820 [debug] [MainThread]: On master: BEGIN
[0m15:16:20.725558 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:20.726984 [debug] [MainThread]: On master: COMMIT
[0m15:16:20.728182 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:20.729608 [debug] [MainThread]: On master: COMMIT
[0m15:16:20.731195 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:20.733039 [debug] [MainThread]: On master: Close
[0m15:16:20.735022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:20.737179 [info ] [MainThread]: 
[0m15:16:20.746962 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_form_submissions
[0m15:16:20.749279 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_form_submissions ................. [RUN]
[0m15:16:20.752498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_form_submissions)
[0m15:16:20.754858 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_form_submissions
[0m15:16:20.764534 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_form_submissions"
[0m15:16:20.779601 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_form_submissions (compile): 15:16:20.756436 => 15:16:20.779196
[0m15:16:20.781269 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_form_submissions
[0m15:16:20.820259 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_form_submissions"
[0m15:16:20.837923 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_form_submissions"
[0m15:16:20.840120 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_form_submissions: BEGIN
[0m15:16:20.842228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:20.853022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:20.854890 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_form_submissions"
[0m15:16:20.856723 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_form_submissions: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_form_submissions"} */

  create view "warehouse"."marts_staging"."stg_form_submissions__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_form_submissions_airbyte_tmp
),

base as (
    select
        (j->>'formId')                       as form_id,
        (j->>'pageUrl')                      as page_url,
        (j->>'conversionId')                 as conversion_id,

        -- timestamps en millisecondes
        case when j->>'submittedAt' is not null
             then to_timestamp((j->>'submittedAt')::bigint / 1000.0)
             end                             as submitted_at,
        case when j->>'updatedAt' is not null
             then to_timestamp((j->>'updatedAt')::bigint / 1000.0)
             end                             as updated_at,

        j->'values'                          as values_json,
        extracted_at
    from src
),

extracted_fields as (
    select
        form_id,
        page_url,
        conversion_id,
        submitted_at,
        updated_at,
        extracted_at,
        values_json,

        -- extraction pratique des champs standard (email, firstname, lastname)
        (
          select v->>'value'
          from jsonb_array_elements(values_json) as v
          where v->>'name' = 'email'
          limit 1
        ) as email,

        (
          select v->>'value'
          from jsonb_array_elements(values_json) as v
          where v->>'name' = 'firstname'
          limit 1
        ) as first_name,

        (
          select v->>'value'
          from jsonb_array_elements(values_json) as v
          where v->>'name' = 'lastname'
          limit 1
        ) as last_name
    from base
)

select *
from extracted_fields
  );
[0m15:16:20.875288 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:16:20.883471 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_form_submissions"
[0m15:16:20.885567 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_form_submissions: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_form_submissions"} */
alter table "warehouse"."marts_staging"."stg_form_submissions__dbt_tmp" rename to "stg_form_submissions"
[0m15:16:20.888309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:20.904293 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_form_submissions: COMMIT
[0m15:16:20.906473 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_form_submissions"
[0m15:16:20.908710 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_form_submissions: COMMIT
[0m15:16:20.913655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:20.970544 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_form_submissions__dbt_backup"
[0m15:16:20.977444 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_form_submissions"
[0m15:16:20.979378 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_form_submissions: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_form_submissions"} */
drop view if exists "warehouse"."marts_staging"."stg_form_submissions__dbt_backup" cascade
[0m15:16:20.981527 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:16:20.984330 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_form_submissions (execute): 15:16:20.783173 => 15:16:20.984134
[0m15:16:20.985945 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_form_submissions: Close
[0m15:16:20.988081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a063fbf6-f0ac-4143-a808-f3d5be04b45d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee7e00580>]}
[0m15:16:20.989819 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_form_submissions ............ [[32mCREATE VIEW[0m in 0.24s]
[0m15:16:20.992050 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_form_submissions
[0m15:16:20.995592 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:20.997332 [debug] [MainThread]: On master: BEGIN
[0m15:16:20.999002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:21.007877 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:21.009379 [debug] [MainThread]: On master: COMMIT
[0m15:16:21.010668 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:21.011843 [debug] [MainThread]: On master: COMMIT
[0m15:16:21.013510 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:21.014736 [debug] [MainThread]: On master: Close
[0m15:16:21.016376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:21.017936 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:16:21.019570 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:16:21.020987 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:16:21.022310 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_form_submissions' was properly closed.
[0m15:16:21.023594 [info ] [MainThread]: 
[0m15:16:21.025321 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m15:16:21.027410 [debug] [MainThread]: Command end result
[0m15:16:21.057933 [info ] [MainThread]: 
[0m15:16:21.059893 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:21.062119 [info ] [MainThread]: 
[0m15:16:21.063942 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:16:21.066528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.334361, "process_user_time": 2.56057, "process_kernel_time": 0.438839, "process_mem_max_rss": "104732", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:16:21.068414 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:21.068223 after 2.34 seconds
[0m15:16:21.070098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeeeb66ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee7e00580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eeee8108790>]}
[0m15:16:21.072002 [debug] [MainThread]: Flushing usage events
[0m15:16:58.844555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d17730610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d15b996f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d15b99690>]}


============================== 15:16:58.851377 | 3fd916bd-510f-42d5-b678-869bd233db34 ==============================
[0m15:16:58.851377 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:16:58.853532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_goals', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:16:59.075333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fd916bd-510f-42d5-b678-869bd233db34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d15bdf490>]}
[0m15:16:59.167534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fd916bd-510f-42d5-b678-869bd233db34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d17dad030>]}
[0m15:16:59.169460 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:16:59.186215 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:17:00.352489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:00.354228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:00.364258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fd916bd-510f-42d5-b678-869bd233db34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d13ffd930>]}
[0m15:17:00.421948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fd916bd-510f-42d5-b678-869bd233db34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d141cc550>]}
[0m15:17:00.424073 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:17:00.426063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd916bd-510f-42d5-b678-869bd233db34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d141cc760>]}
[0m15:17:00.429632 [info ] [MainThread]: 
[0m15:17:00.432689 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:17:00.436509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:17:00.451191 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:17:00.453123 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:17:00.455353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:00.470253 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:17:00.473237 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:17:00.480545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:17:00.483760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:17:00.488232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:17:00.497095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:17:00.514444 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:17:00.519992 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:17:00.533686 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:17:00.542447 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:17:00.547569 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:17:00.552086 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:17:00.556850 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:17:00.560732 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:17:00.564120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:00.570996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:00.577397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:00.581886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:00.599801 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:00.603004 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:17:00.605181 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:00.606263 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:00.608310 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:17:00.609307 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:00.611122 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:17:00.613638 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:17:00.617554 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:17:00.619900 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:17:00.621536 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m15:17:00.622810 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:17:00.624861 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:17:00.629638 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:17:00.631906 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:00.635798 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:17:00.636993 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:00.638349 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:17:00.638905 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:00.646070 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:17:00.648774 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:17:00.651368 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:17:00.653617 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:17:00.656644 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:17:00.666098 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:00.667963 [debug] [MainThread]: On master: BEGIN
[0m15:17:00.669807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:00.678826 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:00.680678 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:00.682692 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:17:00.725657 [debug] [MainThread]: SQL status: SELECT 16 in 0.0 seconds
[0m15:17:00.729821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd916bd-510f-42d5-b678-869bd233db34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d13fd3dc0>]}
[0m15:17:00.732475 [debug] [MainThread]: On master: ROLLBACK
[0m15:17:00.735560 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:00.738047 [debug] [MainThread]: On master: BEGIN
[0m15:17:00.740836 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:00.742552 [debug] [MainThread]: On master: COMMIT
[0m15:17:00.744694 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:00.747453 [debug] [MainThread]: On master: COMMIT
[0m15:17:00.750088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:17:00.752249 [debug] [MainThread]: On master: Close
[0m15:17:00.754661 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:00.757107 [info ] [MainThread]: 
[0m15:17:00.769128 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_goals
[0m15:17:00.771254 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_goals ............................ [RUN]
[0m15:17:00.774381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_goals)
[0m15:17:00.777134 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_goals
[0m15:17:00.788442 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_goals"
[0m15:17:00.809817 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_goals (compile): 15:17:00.779218 => 15:17:00.809435
[0m15:17:00.811827 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_goals
[0m15:17:00.849116 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_goals"
[0m15:17:00.859509 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_goals"
[0m15:17:00.861228 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: BEGIN
[0m15:17:00.862823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:00.871663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:17:00.873567 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_goals"
[0m15:17:00.875005 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_goals"} */

  create view "warehouse"."marts_staging"."stg_goals__dbt_tmp"
    
    
  as (
    with src as (
  select (_airbyte_data)::jsonb as j
  from warehouse.airbyte_internal.raw_hubspot_raw__stream_goals
)
select
  (j->>'id')::bigint                               as goal_id,
  (j->'properties'->>'hs_goal_name')               as goal_name,
  (j->'properties'->>'hs_goal_type')               as goal_type,
  (j->'properties'->>'hs_status')                  as status,
  (j->'properties'->>'hs_outcome')                 as outcome,
  nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,
  nullif(j->'properties'->>'hs_assignee_user_id','')::bigint as assignee_user_id,
  nullif(j->'properties'->>'hs_target_amount','')::numeric  as target_amount,
  (j->'properties'->>'hs_goal_target_currency_code') as currency_code,
  nullif(j->'properties'->>'hs_start_datetime','')::timestamptz as start_at,
  nullif(j->'properties'->>'hs_end_datetime','')::timestamptz   as end_at,
  nullif(j->'properties'->>'hs_kpi_progress_percent','')::numeric as progress_percent,
  nullif(j->'properties'->>'hs_kpi_value','')::numeric           as kpi_value,
  nullif(j->'properties'->>'hs_kpi_metric_type','')              as kpi_metric_type
from src;
  );
[0m15:17:00.877098 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 26: from src;
                 ^

[0m15:17:00.878554 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: ROLLBACK
[0m15:17:00.880483 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_goals (execute): 15:17:00.813702 => 15:17:00.880212
[0m15:17:00.881802 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: Close
[0m15:17:00.884766 [debug] [Thread-1 (]: Database Error in model stg_goals (models/staging/hubspot/stg_goals.sql)
  syntax error at or near ";"
  LINE 26: from src;
                   ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_goals.sql
[0m15:17:00.886574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd916bd-510f-42d5-b678-869bd233db34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d13f15a50>]}
[0m15:17:00.888398 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_goals ................... [[31mERROR[0m in 0.11s]
[0m15:17:00.890361 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_goals
[0m15:17:00.893771 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:00.895191 [debug] [MainThread]: On master: BEGIN
[0m15:17:00.896737 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:00.905244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:00.907231 [debug] [MainThread]: On master: COMMIT
[0m15:17:00.908822 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:00.910602 [debug] [MainThread]: On master: COMMIT
[0m15:17:00.913187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:17:00.914835 [debug] [MainThread]: On master: Close
[0m15:17:00.916727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:00.918297 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:17:00.920092 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:17:00.921676 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:17:00.923226 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_goals' was properly closed.
[0m15:17:00.924864 [info ] [MainThread]: 
[0m15:17:00.926716 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:17:00.928835 [debug] [MainThread]: Command end result
[0m15:17:01.006975 [info ] [MainThread]: 
[0m15:17:01.009223 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:17:01.011087 [info ] [MainThread]: 
[0m15:17:01.013140 [error] [MainThread]:   Database Error in model stg_goals (models/staging/hubspot/stg_goals.sql)
  syntax error at or near ";"
  LINE 26: from src;
                   ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_goals.sql
[0m15:17:01.014781 [info ] [MainThread]: 
[0m15:17:01.016894 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:17:01.019554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.2379484, "process_user_time": 2.721256, "process_kernel_time": 0.434756, "process_mem_max_rss": "105624", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:17:01.021353 [debug] [MainThread]: Command `dbt run` failed at 15:17:01.021158 after 2.24 seconds
[0m15:17:01.023299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d17730610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d14388c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763d1428a800>]}
[0m15:17:01.024851 [debug] [MainThread]: Flushing usage events
[0m15:17:09.919292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5eaf49a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5cf6d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5cf6d8a0>]}


============================== 15:17:09.926198 | 37592d72-d37b-496d-aa1d-94a5bf0346cd ==============================
[0m15:17:09.926198 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:17:09.928229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_goals', 'send_anonymous_usage_stats': 'True'}
[0m15:17:10.266837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37592d72-d37b-496d-aa1d-94a5bf0346cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5cfb3550>]}
[0m15:17:10.465626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37592d72-d37b-496d-aa1d-94a5bf0346cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5f17cd60>]}
[0m15:17:10.468947 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:17:10.502486 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:17:11.818147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:11.820622 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_goals.sql
[0m15:17:12.202125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37592d72-d37b-496d-aa1d-94a5bf0346cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5cf6fb20>]}
[0m15:17:12.257116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37592d72-d37b-496d-aa1d-94a5bf0346cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5b3978b0>]}
[0m15:17:12.259263 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:17:12.261887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37592d72-d37b-496d-aa1d-94a5bf0346cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5b397910>]}
[0m15:17:12.265300 [info ] [MainThread]: 
[0m15:17:12.268253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:17:12.271639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:17:12.284254 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:17:12.286268 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:17:12.287910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:12.301229 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:17:12.303801 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:17:12.309240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:17:12.310835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:17:12.312953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:17:12.314467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:17:12.321283 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:17:12.324012 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:17:12.328853 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:17:12.332286 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:17:12.333997 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:17:12.335548 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:17:12.337027 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:17:12.338463 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:17:12.340116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:12.341455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:12.342976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:12.344426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:12.354283 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:12.355599 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:12.356891 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:12.358530 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:17:12.358954 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:12.360322 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:17:12.362060 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:17:12.364374 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:17:12.366672 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:17:12.369351 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:17:12.371985 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:17:12.375789 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:17:12.379330 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m15:17:12.381448 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:12.382309 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:12.385899 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:17:12.386382 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:12.388228 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:17:12.390520 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:17:12.392345 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:17:12.393690 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:17:12.395413 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:17:12.396979 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:17:12.402250 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:17:12.413468 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:12.415142 [debug] [MainThread]: On master: BEGIN
[0m15:17:12.416789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:12.425750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:12.427670 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:12.429140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:17:12.470394 [debug] [MainThread]: SQL status: SELECT 16 in 0.0 seconds
[0m15:17:12.474192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37592d72-d37b-496d-aa1d-94a5bf0346cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5b4e0e50>]}
[0m15:17:12.476462 [debug] [MainThread]: On master: ROLLBACK
[0m15:17:12.478772 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:12.480540 [debug] [MainThread]: On master: BEGIN
[0m15:17:12.482448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:12.484057 [debug] [MainThread]: On master: COMMIT
[0m15:17:12.485496 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:12.487270 [debug] [MainThread]: On master: COMMIT
[0m15:17:12.488948 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:17:12.490194 [debug] [MainThread]: On master: Close
[0m15:17:12.491924 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:12.493976 [info ] [MainThread]: 
[0m15:17:12.503739 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_goals
[0m15:17:12.505614 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_goals ............................ [RUN]
[0m15:17:12.508226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_intermediate, now model.hubspot_dbt.stg_goals)
[0m15:17:12.510045 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_goals
[0m15:17:12.519013 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_goals"
[0m15:17:12.533610 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_goals (compile): 15:17:12.511549 => 15:17:12.533235
[0m15:17:12.535210 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_goals
[0m15:17:12.568567 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_goals"
[0m15:17:12.582577 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_goals"
[0m15:17:12.584422 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: BEGIN
[0m15:17:12.586155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:12.595654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:17:12.597194 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_goals"
[0m15:17:12.598922 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_goals"} */

  create view "warehouse"."marts_staging"."stg_goals__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_goals
)

select
    (j->>'id')::bigint                                   as goal_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    (j->'properties'->>'hs_goal_name')                  as goal_name,
    (j->'properties'->>'hs_goal_type')                  as goal_type,   -- sales_quota, etc.
    (j->'properties'->>'hs_status')                     as status,      -- in_progress, achieved, etc.
    (j->'properties'->>'hs_outcome')                    as outcome,

    nullif(j->'properties'->>'hs_start_datetime','')::timestamptz as start_datetime,
    nullif(j->'properties'->>'hs_end_datetime','')::timestamptz   as end_datetime,

    nullif(j->'properties'->>'hs_assignee_user_id','')::bigint    as assignee_user_id,
    nullif(j->'properties'->>'hubspot_owner_id','')::bigint       as owner_id,

    nullif(j->'properties'->>'hs_target_amount','')::numeric      as target_amount,
    nullif(j->'properties'->>'hs_target_amount_in_home_currency','')::numeric as target_amount_home_currency,

    nullif(j->'properties'->>'hs_kpi_value','')::numeric          as kpi_value,
    nullif(j->'properties'->>'hs_kpi_progress_percent','')::numeric as kpi_progress_percent,

    (j->'properties'->>'hs_goal_target_currency_code')            as currency_code,

    extracted_at
from src
  );
[0m15:17:12.605058 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:17:12.612155 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_goals"
[0m15:17:12.613975 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_goals"} */
alter table "warehouse"."marts_staging"."stg_goals__dbt_tmp" rename to "stg_goals"
[0m15:17:12.616397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:17:12.630524 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: COMMIT
[0m15:17:12.632602 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_goals"
[0m15:17:12.634729 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: COMMIT
[0m15:17:12.641012 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:17:12.648823 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_goals__dbt_backup"
[0m15:17:12.655006 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_goals"
[0m15:17:12.656815 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_goals"} */
drop view if exists "warehouse"."marts_staging"."stg_goals__dbt_backup" cascade
[0m15:17:12.658868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:17:12.661638 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_goals (execute): 15:17:12.537044 => 15:17:12.661440
[0m15:17:12.663256 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_goals: Close
[0m15:17:12.665419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37592d72-d37b-496d-aa1d-94a5bf0346cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5905e290>]}
[0m15:17:12.667227 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_goals ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m15:17:12.669671 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_goals
[0m15:17:12.673036 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:12.674458 [debug] [MainThread]: On master: BEGIN
[0m15:17:12.675999 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:12.684880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:12.686249 [debug] [MainThread]: On master: COMMIT
[0m15:17:12.687239 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:12.688381 [debug] [MainThread]: On master: COMMIT
[0m15:17:12.690075 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:17:12.691166 [debug] [MainThread]: On master: Close
[0m15:17:12.692699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:12.693791 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:17:12.694754 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:17:12.696104 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:17:12.697265 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_goals' was properly closed.
[0m15:17:12.698526 [info ] [MainThread]: 
[0m15:17:12.700125 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m15:17:12.702299 [debug] [MainThread]: Command end result
[0m15:17:12.739439 [info ] [MainThread]: 
[0m15:17:12.741645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:12.743355 [info ] [MainThread]: 
[0m15:17:12.745440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:17:12.747744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.884271, "process_user_time": 3.085859, "process_kernel_time": 0.450607, "process_mem_max_rss": "109188", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:17:12.749628 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:12.749435 after 2.89 seconds
[0m15:17:12.751364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5eaf49a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5b5ee5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74ac5b396bc0>]}
[0m15:17:12.753450 [debug] [MainThread]: Flushing usage events
[0m15:17:29.525492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff6ec4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff5331780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff5331720>]}


============================== 15:17:29.532114 | 2e40fb0f-6473-423c-b92a-ae2f3bee0694 ==============================
[0m15:17:29.532114 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:17:29.534348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_owner', 'send_anonymous_usage_stats': 'True'}
[0m15:17:29.736621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e40fb0f-6473-423c-b92a-ae2f3bee0694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff53774f0>]}
[0m15:17:29.829092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e40fb0f-6473-423c-b92a-ae2f3bee0694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff7540ca0>]}
[0m15:17:29.831453 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:17:29.849613 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:17:31.241448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:31.244550 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_owner.sql
[0m15:17:31.595221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e40fb0f-6473-423c-b92a-ae2f3bee0694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff5377550>]}
[0m15:17:31.648998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e40fb0f-6473-423c-b92a-ae2f3bee0694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff3767820>]}
[0m15:17:31.651269 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:17:31.653569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e40fb0f-6473-423c-b92a-ae2f3bee0694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff3767910>]}
[0m15:17:31.657460 [info ] [MainThread]: 
[0m15:17:31.660047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:17:31.663112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:17:31.676550 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:17:31.678220 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:17:31.680005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:31.693902 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:17:31.696706 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:17:31.701823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m15:17:31.703428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:17:31.704930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:17:31.706483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:17:31.713221 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:17:31.716488 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:17:31.719979 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:17:31.723504 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:17:31.725202 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:17:31.726623 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:17:31.728107 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:17:31.730100 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:17:31.731678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:31.733223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:31.735139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:31.737498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:31.748008 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:31.749638 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:31.751003 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:17:31.751683 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:31.753048 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:17:31.753567 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:31.754973 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:17:31.756789 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:17:31.758770 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:17:31.760256 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:17:31.763832 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:17:31.766923 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:31.767907 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:17:31.769968 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:31.773264 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:17:31.774750 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:31.777508 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:17:31.779783 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:17:31.780348 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m15:17:31.782631 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:17:31.784638 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:17:31.788316 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:17:31.790467 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:17:31.793569 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:17:31.806992 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:31.808678 [debug] [MainThread]: On master: BEGIN
[0m15:17:31.810374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:31.819546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:31.821439 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:31.822896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:17:31.867272 [debug] [MainThread]: SQL status: SELECT 17 in 0.0 seconds
[0m15:17:31.870978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e40fb0f-6473-423c-b92a-ae2f3bee0694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff14ba950>]}
[0m15:17:31.872512 [debug] [MainThread]: On master: ROLLBACK
[0m15:17:31.874363 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:31.876133 [debug] [MainThread]: On master: BEGIN
[0m15:17:31.878207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:31.880428 [debug] [MainThread]: On master: COMMIT
[0m15:17:31.882279 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:31.883778 [debug] [MainThread]: On master: COMMIT
[0m15:17:31.885588 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:17:31.887114 [debug] [MainThread]: On master: Close
[0m15:17:31.889219 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:31.891078 [info ] [MainThread]: 
[0m15:17:31.902163 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_owner
[0m15:17:31.904161 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_owner ............................ [RUN]
[0m15:17:31.907367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_owner)
[0m15:17:31.909377 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_owner
[0m15:17:31.920433 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_owner"
[0m15:17:31.935734 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owner (compile): 15:17:31.911553 => 15:17:31.935347
[0m15:17:31.937705 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_owner
[0m15:17:31.973628 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_owner"
[0m15:17:31.987035 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owner"
[0m15:17:31.988698 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owner: BEGIN
[0m15:17:31.990381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:31.999111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:17:32.000822 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owner"
[0m15:17:32.002230 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owner: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owner"} */

  create view "warehouse"."marts_staging"."stg_owner__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_owners
)

select
    (j->>'id')::bigint                               as owner_id,
    (j->>'email')                                    as email,
    (j->>'firstName')                               as first_name,
    (j->>'lastName')                                as last_name,
    (j->>'archived')::boolean                       as archived_flag,

    nullif(j->>'createdAt','')::timestamptz         as created_at,
    nullif(j->>'updatedAt','')::timestamptz         as updated_at,

    nullif(j->>'userId','')::bigint                 as user_id,
    nullif(j->>'userIdIncludingInactive','')::bigint as user_id_incl_inactive,

    extracted_at
from src
  );
[0m15:17:32.024194 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:17:32.031999 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owner"
[0m15:17:32.033890 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owner: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owner"} */
alter table "warehouse"."marts_staging"."stg_owner__dbt_tmp" rename to "stg_owner"
[0m15:17:32.036519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:17:32.052506 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owner: COMMIT
[0m15:17:32.054719 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owner"
[0m15:17:32.056690 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owner: COMMIT
[0m15:17:32.061245 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:17:32.068819 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_owner__dbt_backup"
[0m15:17:32.074665 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owner"
[0m15:17:32.076746 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owner: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owner"} */
drop view if exists "warehouse"."marts_staging"."stg_owner__dbt_backup" cascade
[0m15:17:32.078955 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:17:32.081737 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owner (execute): 15:17:31.939599 => 15:17:32.081545
[0m15:17:32.083515 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owner: Close
[0m15:17:32.085878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e40fb0f-6473-423c-b92a-ae2f3bee0694', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff1436560>]}
[0m15:17:32.087929 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_owner ....................... [[32mCREATE VIEW[0m in 0.18s]
[0m15:17:32.090617 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_owner
[0m15:17:32.093996 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:32.095429 [debug] [MainThread]: On master: BEGIN
[0m15:17:32.096834 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:32.106540 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:32.108027 [debug] [MainThread]: On master: COMMIT
[0m15:17:32.109915 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:32.111680 [debug] [MainThread]: On master: COMMIT
[0m15:17:32.113803 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:17:32.115426 [debug] [MainThread]: On master: Close
[0m15:17:32.117841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:32.119799 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:17:32.121649 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:17:32.123771 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:17:32.125441 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_owner' was properly closed.
[0m15:17:32.127281 [info ] [MainThread]: 
[0m15:17:32.129106 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m15:17:32.131253 [debug] [MainThread]: Command end result
[0m15:17:32.165965 [info ] [MainThread]: 
[0m15:17:32.168565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:32.170474 [info ] [MainThread]: 
[0m15:17:32.172741 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:17:32.175797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.712823, "process_user_time": 2.905228, "process_kernel_time": 0.476734, "process_mem_max_rss": "109376", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:17:32.177606 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:32.177409 after 2.71 seconds
[0m15:17:32.179435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff6ec4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff3aa94e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c0ff7540ca0>]}
[0m15:17:32.181527 [debug] [MainThread]: Flushing usage events
[0m15:17:53.657149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f5200880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f366d780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f366d720>]}


============================== 15:17:53.664263 | ce261b9c-546b-44f9-8ae9-01f57bb0b3e7 ==============================
[0m15:17:53.664263 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:17:53.666305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_owners_archived', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:53.860254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce261b9c-546b-44f9-8ae9-01f57bb0b3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f36b34f0>]}
[0m15:17:53.944904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce261b9c-546b-44f9-8ae9-01f57bb0b3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f587cca0>]}
[0m15:17:53.947638 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:17:53.963843 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:17:54.842998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:54.845368 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_owners_archived.sql
[0m15:17:55.182029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce261b9c-546b-44f9-8ae9-01f57bb0b3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f36b3760>]}
[0m15:17:55.229910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce261b9c-546b-44f9-8ae9-01f57bb0b3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f1aa37f0>]}
[0m15:17:55.231840 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:17:55.233921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce261b9c-546b-44f9-8ae9-01f57bb0b3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f1aa3a30>]}
[0m15:17:55.237174 [info ] [MainThread]: 
[0m15:17:55.239501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:17:55.242532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:17:55.258731 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:17:55.261483 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:17:55.263774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:55.282590 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:17:55.287012 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:17:55.294254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_marts)
[0m15:17:55.295959 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:17:55.297692 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:17:55.299093 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:17:55.306545 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:17:55.310856 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:17:55.314532 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:17:55.318295 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:17:55.320265 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:17:55.321971 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:17:55.323409 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:17:55.324911 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:17:55.326400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:55.328187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:55.329651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:55.331237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:55.340109 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:55.341875 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:17:55.342395 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:55.343782 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:17:55.345046 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:55.345872 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:17:55.347839 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:17:55.350999 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:55.351999 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:17:55.353480 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:17:55.354934 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:17:55.357389 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:17:55.358501 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:17:55.361194 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:17:55.363122 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:17:55.364022 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:55.369276 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:17:55.369766 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m15:17:55.372697 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:17:55.375347 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:17:55.377932 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:17:55.380895 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:17:55.382397 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:17:55.383748 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:17:55.397261 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:55.399004 [debug] [MainThread]: On master: BEGIN
[0m15:17:55.400591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:55.409130 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:55.410861 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:55.412566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:17:55.454103 [debug] [MainThread]: SQL status: SELECT 18 in 0.0 seconds
[0m15:17:55.458121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce261b9c-546b-44f9-8ae9-01f57bb0b3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f36b3700>]}
[0m15:17:55.460026 [debug] [MainThread]: On master: ROLLBACK
[0m15:17:55.461994 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:55.463935 [debug] [MainThread]: On master: BEGIN
[0m15:17:55.465908 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:55.468004 [debug] [MainThread]: On master: COMMIT
[0m15:17:55.469572 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:55.471127 [debug] [MainThread]: On master: COMMIT
[0m15:17:55.472856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:17:55.474482 [debug] [MainThread]: On master: Close
[0m15:17:55.476840 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:55.478695 [info ] [MainThread]: 
[0m15:17:55.488140 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_owners_archived
[0m15:17:55.490008 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_owners_archived .................. [RUN]
[0m15:17:55.492399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_owners_archived)
[0m15:17:55.494014 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_owners_archived
[0m15:17:55.503148 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_owners_archived"
[0m15:17:55.517905 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_archived (compile): 15:17:55.495054 => 15:17:55.517551
[0m15:17:55.519214 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_owners_archived
[0m15:17:55.552929 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_owners_archived"
[0m15:17:55.564596 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_archived"
[0m15:17:55.566332 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_archived: BEGIN
[0m15:17:55.567886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:55.577267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:17:55.578805 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_archived"
[0m15:17:55.580104 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_archived: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_archived"} */

  create view "warehouse"."marts_staging"."stg_owners_archived__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_owners_archived
)

select
    (j->>'id')::bigint                               as owner_id,
    (j->>'email')                                    as email,
    (j->>'firstName')                               as first_name,
    (j->>'lastName')                                as last_name,
    (j->>'archived')::boolean                       as archived_flag,

    nullif(j->>'createdAt','')::timestamptz         as created_at,
    nullif(j->>'updatedAt','')::timestamptz         as updated_at,

    nullif(j->>'userIdIncludingInactive','')::bigint as user_id_incl_inactive,

    extracted_at
from src
  );
[0m15:17:55.487257 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:17:55.494095 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_archived"
[0m15:17:55.495997 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_archived: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_archived"} */
alter table "warehouse"."marts_staging"."stg_owners_archived__dbt_tmp" rename to "stg_owners_archived"
[0m15:17:55.498042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:17:55.512175 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_archived: COMMIT
[0m15:17:55.514271 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_archived"
[0m15:17:55.516226 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_archived: COMMIT
[0m15:17:55.521571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:17:55.529000 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_owners_archived__dbt_backup"
[0m15:17:55.535309 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_archived"
[0m15:17:55.537517 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_archived: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_archived"} */
drop view if exists "warehouse"."marts_staging"."stg_owners_archived__dbt_backup" cascade
[0m15:17:55.539876 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:17:55.542859 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_archived (execute): 15:17:55.520861 => 15:17:55.542663
[0m15:17:55.544345 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_archived: Close
[0m15:17:55.546357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce261b9c-546b-44f9-8ae9-01f57bb0b3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248eb6a2200>]}
[0m15:17:55.548242 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_owners_archived ............. [[32mCREATE VIEW[0m in 0.05s]
[0m15:17:55.550557 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_owners_archived
[0m15:17:55.553622 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:55.555209 [debug] [MainThread]: On master: BEGIN
[0m15:17:55.556707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:55.570166 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:17:55.573595 [debug] [MainThread]: On master: COMMIT
[0m15:17:55.577155 [debug] [MainThread]: Using postgres connection "master"
[0m15:17:55.580708 [debug] [MainThread]: On master: COMMIT
[0m15:17:55.584060 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:17:55.588367 [debug] [MainThread]: On master: Close
[0m15:17:55.592231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:55.595898 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:17:55.598653 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:17:55.601561 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:17:55.605141 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_owners_archived' was properly closed.
[0m15:17:55.609298 [info ] [MainThread]: 
[0m15:17:55.615549 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:17:55.619641 [debug] [MainThread]: Command end result
[0m15:17:55.699291 [info ] [MainThread]: 
[0m15:17:55.703839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:55.707943 [info ] [MainThread]: 
[0m15:17:55.711915 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:17:55.717006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2137773, "process_user_time": 2.697284, "process_kernel_time": 0.450217, "process_mem_max_rss": "109056", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:17:55.720855 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:55.720346 after 2.22 seconds
[0m15:17:55.724041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f5200880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f18ef250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7248f1aa29e0>]}
[0m15:17:55.726669 [debug] [MainThread]: Flushing usage events
[0m15:18:29.597924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f9280c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f7b9d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f7b9ca60>]}


============================== 15:18:29.604846 | 7cca8c84-be0d-44b1-85a0-1a414f4780c6 ==============================
[0m15:18:29.604846 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:18:29.606714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_owners_all', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:18:29.815228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cca8c84-be0d-44b1-85a0-1a414f4780c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f76ef430>]}
[0m15:18:29.919504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cca8c84-be0d-44b1-85a0-1a414f4780c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f97b9060>]}
[0m15:18:29.922385 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:18:29.950877 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:18:31.484687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:31.488021 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_owners_all.sql
[0m15:18:31.839885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cca8c84-be0d-44b1-85a0-1a414f4780c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f5c34970>]}
[0m15:18:31.887734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cca8c84-be0d-44b1-85a0-1a414f4780c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f5adf760>]}
[0m15:18:31.889423 [info ] [MainThread]: Found 47 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:18:31.891499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cca8c84-be0d-44b1-85a0-1a414f4780c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f5adf850>]}
[0m15:18:31.895054 [info ] [MainThread]: 
[0m15:18:31.897448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:18:31.900440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:18:31.914800 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:18:31.916376 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:18:31.917460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:31.929538 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:18:31.932013 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:18:31.937428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:18:31.939066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:18:31.940621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:18:31.941944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:18:31.947968 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:18:31.951018 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:18:31.954857 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:18:31.959031 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:18:31.960784 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:18:31.962324 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:18:31.964266 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:18:31.966048 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:18:31.967459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:18:31.969483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:31.971648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:31.973617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:18:31.984940 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:31.986503 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:31.989187 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:31.990199 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:18:31.991665 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:18:31.992551 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:18:31.993900 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:18:31.995941 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:18:31.997370 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:18:31.998945 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:18:32.000379 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:18:32.003680 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:18:32.007714 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m15:18:32.009875 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:18:32.010753 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:18:32.014182 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:18:32.015966 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:18:32.017925 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:18:32.020429 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:18:32.022708 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:18:32.025264 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:18:32.027256 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:18:32.028876 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:18:32.035076 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:18:32.049499 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:32.051852 [debug] [MainThread]: On master: BEGIN
[0m15:18:32.053120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:18:32.063085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:32.065348 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:32.067031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:18:32.109641 [debug] [MainThread]: SQL status: SELECT 19 in 0.0 seconds
[0m15:18:32.113479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cca8c84-be0d-44b1-85a0-1a414f4780c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f5f24fa0>]}
[0m15:18:32.115073 [debug] [MainThread]: On master: ROLLBACK
[0m15:18:32.117225 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:32.118757 [debug] [MainThread]: On master: BEGIN
[0m15:18:32.121080 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:32.122364 [debug] [MainThread]: On master: COMMIT
[0m15:18:32.124398 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:32.126243 [debug] [MainThread]: On master: COMMIT
[0m15:18:32.128089 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:32.129793 [debug] [MainThread]: On master: Close
[0m15:18:32.132163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:32.134549 [info ] [MainThread]: 
[0m15:18:32.145701 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_owners_all
[0m15:18:32.148110 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_owners_all ....................... [RUN]
[0m15:18:32.150663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_owners_all)
[0m15:18:32.152614 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_owners_all
[0m15:18:32.163909 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_owners_all"
[0m15:18:32.177549 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_all (compile): 15:18:32.154560 => 15:18:32.177180
[0m15:18:32.179751 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_owners_all
[0m15:18:32.217146 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_owners_all"
[0m15:18:32.229999 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:18:32.232117 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: BEGIN
[0m15:18:32.234257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:32.244678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:18:32.246218 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:18:32.247644 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_all"} */

  create view "warehouse"."marts_staging"."stg_owners_all__dbt_tmp"
    
    
  as (
    with active as (
    select
        owner_id,
        email,
        first_name,
        last_name,
        false as is_archived,
        created_at,
        updated_at,
        user_id           as user_id,
        user_id_incl_inactive,
        extracted_at
    from "warehouse"."marts_staging"."stg_owner"
),

archived as (
    select
        owner_id,
        email,
        first_name,
        last_name,
        true  as is_archived,
        created_at,
        updated_at,
        null  as user_id,
        user_id_incl_inactive,
        extracted_at
    from "warehouse"."marts_staging"."stg_owners_archived"
)

select * from active
union all
select * from archived
  );
[0m15:18:32.251094 [debug] [Thread-1 (]: Postgres adapter: Postgres error: UNION types bigint and text cannot be matched
LINE 39: select * from archived
                ^

[0m15:18:32.253137 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: ROLLBACK
[0m15:18:32.255151 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_all (execute): 15:18:32.181529 => 15:18:32.254601
[0m15:18:32.257024 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: Close
[0m15:18:32.260545 [debug] [Thread-1 (]: Database Error in model stg_owners_all (models/staging/hubspot/stg_owners_all.sql)
  UNION types bigint and text cannot be matched
  LINE 39: select * from archived
                  ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_owners_all.sql
[0m15:18:32.263408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cca8c84-be0d-44b1-85a0-1a414f4780c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3c7631f60>]}
[0m15:18:32.265685 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_owners_all .............. [[31mERROR[0m in 0.11s]
[0m15:18:32.267744 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_owners_all
[0m15:18:32.271419 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:32.273250 [debug] [MainThread]: On master: BEGIN
[0m15:18:32.274642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:32.285545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:18:32.290497 [debug] [MainThread]: On master: COMMIT
[0m15:18:32.293589 [debug] [MainThread]: Using postgres connection "master"
[0m15:18:32.295838 [debug] [MainThread]: On master: COMMIT
[0m15:18:32.298856 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:18:32.301583 [debug] [MainThread]: On master: Close
[0m15:18:32.304893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:32.307491 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:18:32.309668 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:18:32.312079 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:18:32.314795 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_owners_all' was properly closed.
[0m15:18:32.316831 [info ] [MainThread]: 
[0m15:18:32.319407 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:18:32.322667 [debug] [MainThread]: Command end result
[0m15:18:32.368714 [info ] [MainThread]: 
[0m15:18:32.371672 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:18:32.373831 [info ] [MainThread]: 
[0m15:18:32.375630 [error] [MainThread]:   Database Error in model stg_owners_all (models/staging/hubspot/stg_owners_all.sql)
  UNION types bigint and text cannot be matched
  LINE 39: select * from archived
                  ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_owners_all.sql
[0m15:18:32.377520 [info ] [MainThread]: 
[0m15:18:32.379839 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:18:32.382587 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.84098, "process_user_time": 2.791651, "process_kernel_time": 0.42917, "process_mem_max_rss": "109080", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:18:32.384785 [debug] [MainThread]: Command `dbt run` failed at 15:18:32.384593 after 2.84 seconds
[0m15:18:32.386362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f9280c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3c77abdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75e3f7b9e320>]}
[0m15:18:32.389094 [debug] [MainThread]: Flushing usage events
[0m15:20:03.740502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd5040370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd34b9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd34b9630>]}


============================== 15:20:03.747141 | 9d34aa03-dff4-4ee3-ac07-319c9cb2e704 ==============================
[0m15:20:03.747141 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:20:03.748924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_engagement_calls', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:03.945559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d34aa03-dff4-4ee3-ac07-319c9cb2e704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd34ff460>]}
[0m15:20:04.030794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d34aa03-dff4-4ee3-ac07-319c9cb2e704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd56cd030>]}
[0m15:20:04.032999 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:20:04.050492 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:20:04.929387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:20:04.932184 [debug] [MainThread]: Partial parsing: added file: hubspot_dbt://models/staging/hubspot/stg_engagement_calls.sql
[0m15:20:05.083666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d34aa03-dff4-4ee3-ac07-319c9cb2e704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd005c0d0>]}
[0m15:20:05.177158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d34aa03-dff4-4ee3-ac07-319c9cb2e704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd17af370>]}
[0m15:20:05.179024 [info ] [MainThread]: Found 48 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:20:05.181124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d34aa03-dff4-4ee3-ac07-319c9cb2e704', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd176d960>]}
[0m15:20:05.183478 [warn ] [MainThread]: The selection criterion 'stg_engagement_calls' does not match any nodes
[0m15:20:05.186218 [info ] [MainThread]: 
[0m15:20:05.187996 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:20:05.190300 [debug] [MainThread]: Command end result
[0m15:20:05.223840 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5370446, "process_user_time": 2.351332, "process_kernel_time": 0.412089, "process_mem_max_rss": "102360", "process_out_blocks": "608", "process_in_blocks": "0"}
[0m15:20:05.226205 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:05.226005 after 1.54 seconds
[0m15:20:05.227798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd5040370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd176d960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7babd17ae6e0>]}
[0m15:20:05.229586 [debug] [MainThread]: Flushing usage events
[0m15:20:25.969509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2007b5c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2005fd5720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2005fd56c0>]}


============================== 15:20:25.976355 | c40c96d5-13b1-4eb4-9659-4fa770ade82a ==============================
[0m15:20:25.976355 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:20:25.978731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_engagement_calls', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:20:26.171416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c40c96d5-13b1-4eb4-9659-4fa770ade82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c200601b4c0>]}
[0m15:20:26.254218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c40c96d5-13b1-4eb4-9659-4fa770ade82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20081e6170>]}
[0m15:20:26.256451 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:20:26.272026 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:20:27.270033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:20:27.273574 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_engagement_calls.sql
[0m15:20:27.439015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c40c96d5-13b1-4eb4-9659-4fa770ade82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20021740d0>]}
[0m15:20:27.534578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c40c96d5-13b1-4eb4-9659-4fa770ade82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c20042b9a20>]}
[0m15:20:27.536358 [info ] [MainThread]: Found 48 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:20:27.538383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40c96d5-13b1-4eb4-9659-4fa770ade82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2004280220>]}
[0m15:20:27.541640 [info ] [MainThread]: 
[0m15:20:27.544110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:20:27.547083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:20:27.559889 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:20:27.561976 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:20:27.563745 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:27.576102 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:20:27.578550 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:20:27.584103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_intermediate)
[0m15:20:27.585604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:20:27.587258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:20:27.594317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:20:27.595317 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:20:27.598708 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:20:27.602415 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:20:27.606680 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:20:27.608352 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:20:27.610160 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:20:27.611956 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:20:27.613702 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:20:27.615218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:27.617025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:27.618656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:27.620194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:27.630520 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:20:27.632624 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:20:27.633584 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:20:27.634252 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:20:27.635103 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:20:27.636475 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:20:27.637621 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:20:27.639185 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:20:27.641807 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:20:27.643447 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:20:27.645057 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:20:27.645532 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:20:27.646991 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:20:27.650616 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:20:27.652444 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:20:27.655611 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:20:27.656824 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m15:20:27.658631 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:20:27.659226 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:20:27.663240 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:20:27.665228 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:20:27.667117 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:20:27.669041 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:20:27.671839 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:20:27.683699 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:27.685793 [debug] [MainThread]: On master: BEGIN
[0m15:20:27.687135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:27.697053 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:20:27.699030 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:27.700429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:20:27.747438 [debug] [MainThread]: SQL status: SELECT 19 in 0.0 seconds
[0m15:20:27.751006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40c96d5-13b1-4eb4-9659-4fa770ade82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2004269120>]}
[0m15:20:27.752995 [debug] [MainThread]: On master: ROLLBACK
[0m15:20:27.755120 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:27.758427 [debug] [MainThread]: On master: BEGIN
[0m15:20:27.760228 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:20:27.761602 [debug] [MainThread]: On master: COMMIT
[0m15:20:27.762754 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:27.764364 [debug] [MainThread]: On master: COMMIT
[0m15:20:27.766042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:20:27.767280 [debug] [MainThread]: On master: Close
[0m15:20:27.769576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:20:27.771766 [info ] [MainThread]: 
[0m15:20:27.782330 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagement_calls
[0m15:20:27.784021 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagement_calls ................. [RUN]
[0m15:20:27.786045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_kpi, now model.hubspot_dbt.stg_engagement_calls)
[0m15:20:27.787483 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagement_calls
[0m15:20:27.797490 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagement_calls"
[0m15:20:27.811420 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_calls (compile): 15:20:27.789463 => 15:20:27.811009
[0m15:20:27.813200 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagement_calls
[0m15:20:27.852339 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagement_calls"
[0m15:20:27.863691 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_calls"
[0m15:20:27.865235 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_calls: BEGIN
[0m15:20:27.866642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:27.875635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:20:27.877655 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_calls"
[0m15:20:27.879105 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_calls: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_calls"} */

  create view "warehouse"."marts_staging"."stg_engagement_calls__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_engagements_calls
)

select
    (j->>'id')::bigint                                   as call_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    nullif(j->'properties'->>'hs_timestamp','')::timestamptz as call_timestamp,
    nullif(j->'properties'->>'hs_call_duration','')::int     as duration_seconds,
    (j->'properties'->>'hs_call_direction')             as direction, -- INBOUND / OUTBOUND
    (j->'properties'->>'hs_call_status')                as status,
    (j->'properties'->>'hs_call_outcome')               as outcome,

    nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

    j->'contacts'   as contacts_json,
    j->'companies'  as companies_json,
    j->'deals'      as deals_json,
    j->'tickets'    as tickets_json,

    extracted_at
from src
  );
[0m15:20:27.887007 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:20:27.894201 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_calls"
[0m15:20:27.895723 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_calls: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_calls"} */
alter table "warehouse"."marts_staging"."stg_engagement_calls__dbt_tmp" rename to "stg_engagement_calls"
[0m15:20:27.898641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:20:27.913256 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_calls: COMMIT
[0m15:20:27.915070 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_calls"
[0m15:20:27.916586 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_calls: COMMIT
[0m15:20:27.922934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:20:27.932376 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_engagement_calls__dbt_backup"
[0m15:20:27.938776 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_calls"
[0m15:20:27.940865 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_calls: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_calls"} */
drop view if exists "warehouse"."marts_staging"."stg_engagement_calls__dbt_backup" cascade
[0m15:20:27.943184 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:20:27.946228 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_calls (execute): 15:20:27.814568 => 15:20:27.946030
[0m15:20:27.948119 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_calls: Close
[0m15:20:27.950295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40c96d5-13b1-4eb4-9659-4fa770ade82a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c200221ab00>]}
[0m15:20:27.952572 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_engagement_calls ............ [[32mCREATE VIEW[0m in 0.16s]
[0m15:20:27.954993 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagement_calls
[0m15:20:27.958496 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:27.960090 [debug] [MainThread]: On master: BEGIN
[0m15:20:27.961735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:27.971303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:20:27.973323 [debug] [MainThread]: On master: COMMIT
[0m15:20:27.975314 [debug] [MainThread]: Using postgres connection "master"
[0m15:20:27.976971 [debug] [MainThread]: On master: COMMIT
[0m15:20:27.978823 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:20:27.980353 [debug] [MainThread]: On master: Close
[0m15:20:27.982564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:27.984165 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:20:27.985657 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:20:27.987040 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:20:27.988827 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagement_calls' was properly closed.
[0m15:20:27.990425 [info ] [MainThread]: 
[0m15:20:27.992069 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:20:27.994314 [debug] [MainThread]: Command end result
[0m15:20:28.027599 [info ] [MainThread]: 
[0m15:20:28.030115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:28.032464 [info ] [MainThread]: 
[0m15:20:28.034593 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:20:28.037528 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.125065, "process_user_time": 2.460603, "process_kernel_time": 0.496121, "process_mem_max_rss": "108112", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:20:28.039581 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:28.039361 after 2.13 seconds
[0m15:20:28.041231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2007b5c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c2004275d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c200601b4c0>]}
[0m15:20:28.042954 [debug] [MainThread]: Flushing usage events
[0m15:21:02.987421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71589abb4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715898fe1780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715898fe1720>]}


============================== 15:21:02.994485 | 5199f8d8-07c5-4c30-b19c-77f99575889a ==============================
[0m15:21:02.994485 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:21:02.996453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_engagement_emails', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:03.226737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5199f8d8-07c5-4c30-b19c-77f99575889a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7158990234f0>]}
[0m15:21:03.339492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5199f8d8-07c5-4c30-b19c-77f99575889a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71589b0ecca0>]}
[0m15:21:03.341922 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:21:03.360763 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:21:04.343861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:21:04.346436 [debug] [MainThread]: Partial parsing: added file: hubspot_dbt://models/staging/hubspot/stg_engagement_emails.sql
[0m15:21:04.508278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5199f8d8-07c5-4c30-b19c-77f99575889a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7158951b8370>]}
[0m15:21:04.604486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5199f8d8-07c5-4c30-b19c-77f99575889a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715897281270>]}
[0m15:21:04.606438 [info ] [MainThread]: Found 49 models, 39 tests, 20 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:21:04.608366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5199f8d8-07c5-4c30-b19c-77f99575889a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71589728c1c0>]}
[0m15:21:04.611429 [info ] [MainThread]: 
[0m15:21:04.614249 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:21:04.617108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:21:04.628880 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:21:04.630489 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:21:04.631993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:04.644797 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:21:04.647217 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:21:04.653153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m15:21:04.654861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:21:04.656817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:21:04.663374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:21:04.664801 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:21:04.668309 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:21:04.671951 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:21:04.675989 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:21:04.677709 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:21:04.679353 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:21:04.680753 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:21:04.682491 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:21:04.684062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:04.686104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:04.688003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:04.689419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:04.698680 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:21:04.700318 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:21:04.701397 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:21:04.702373 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:21:04.703530 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:21:04.704605 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:21:04.705858 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:21:04.707236 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:21:04.708612 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:21:04.710133 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:21:04.711715 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:21:04.714381 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:21:04.717693 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:21:04.720237 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:21:04.722052 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m15:21:04.725335 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:21:04.728474 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:21:04.729325 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:21:04.731985 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:21:04.734040 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:21:04.735743 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:21:04.737613 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:21:04.739569 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:21:04.744327 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:21:04.756643 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:04.758568 [debug] [MainThread]: On master: BEGIN
[0m15:21:04.760190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:04.769388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:21:04.771049 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:04.772667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:21:04.816399 [debug] [MainThread]: SQL status: SELECT 20 in 0.0 seconds
[0m15:21:04.820322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5199f8d8-07c5-4c30-b19c-77f99575889a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71589745ce20>]}
[0m15:21:04.822524 [debug] [MainThread]: On master: ROLLBACK
[0m15:21:04.824384 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:04.825923 [debug] [MainThread]: On master: BEGIN
[0m15:21:04.828243 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:21:04.829967 [debug] [MainThread]: On master: COMMIT
[0m15:21:04.831366 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:04.832743 [debug] [MainThread]: On master: COMMIT
[0m15:21:04.834672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:21:04.836419 [debug] [MainThread]: On master: Close
[0m15:21:04.838177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:21:04.839875 [info ] [MainThread]: 
[0m15:21:04.850407 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagement_emails
[0m15:21:04.852141 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagement_emails ................ [RUN]
[0m15:21:04.854665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_intermediate, now model.hubspot_dbt.stg_engagement_emails)
[0m15:21:04.856791 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagement_emails
[0m15:21:04.865110 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagement_emails"
[0m15:21:04.880582 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_emails (compile): 15:21:04.858517 => 15:21:04.879920
[0m15:21:04.882462 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagement_emails
[0m15:21:04.916479 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagement_emails"
[0m15:21:04.928261 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:21:04.929709 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: BEGIN
[0m15:21:04.931461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:04.940585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:21:04.942195 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:21:04.943561 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_emails"} */

  create view "warehouse"."marts_staging"."stg_engagement_emails__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw__stream_engagements_emails
)

select
    (j->>'id')::bigint                                   as email_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    nullif(j->'properties'->>'hs_timestamp','')::timestamptz as email_timestamp,
    (j->'properties'->>'hs_email_subject')              as subject,
    (j->'properties'->>'hs_email_status')               as status,
    (j->'properties'->>'hs_email_direction')            as direction, -- INCOMING / OUTGOING

    nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

    j->'contacts'   as contacts_json,
    j->'companies'  as companies_json,
    j->'deals'      as deals_json,
    j->'tickets'    as tickets_json,

    extracted_at
from src
  );
[0m15:21:04.945862 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airbyte_internal.raw__stream_engagements_emails" does not exist
LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                  ^

[0m15:21:04.947456 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: ROLLBACK
[0m15:21:04.949235 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_emails (execute): 15:21:04.883796 => 15:21:04.948938
[0m15:21:04.950406 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: Close
[0m15:21:04.953860 [debug] [Thread-1 (]: Database Error in model stg_engagement_emails (models/staging/hubspot/stg_engagement_emails.sql)
  relation "airbyte_internal.raw__stream_engagements_emails" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_engagement_emails.sql
[0m15:21:04.955800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5199f8d8-07c5-4c30-b19c-77f99575889a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715894f71d50>]}
[0m15:21:04.957581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_engagement_emails ....... [[31mERROR[0m in 0.10s]
[0m15:21:04.959699 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagement_emails
[0m15:21:04.963087 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:04.964500 [debug] [MainThread]: On master: BEGIN
[0m15:21:04.965956 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:04.974150 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:21:04.975919 [debug] [MainThread]: On master: COMMIT
[0m15:21:04.977637 [debug] [MainThread]: Using postgres connection "master"
[0m15:21:04.979400 [debug] [MainThread]: On master: COMMIT
[0m15:21:04.981844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:21:04.983813 [debug] [MainThread]: On master: Close
[0m15:21:04.985887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:04.987303 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:21:04.988845 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:21:04.990440 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:21:04.991783 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagement_emails' was properly closed.
[0m15:21:04.993177 [info ] [MainThread]: 
[0m15:21:04.994921 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:21:04.997419 [debug] [MainThread]: Command end result
[0m15:21:05.030139 [info ] [MainThread]: 
[0m15:21:05.032808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:21:05.034958 [info ] [MainThread]: 
[0m15:21:05.036720 [error] [MainThread]:   Database Error in model stg_engagement_emails (models/staging/hubspot/stg_engagement_emails.sql)
  relation "airbyte_internal.raw__stream_engagements_emails" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_engagement_emails.sql
[0m15:21:05.038940 [info ] [MainThread]: 
[0m15:21:05.041261 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:05.043815 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.116945, "process_user_time": 2.928835, "process_kernel_time": 0.537621, "process_mem_max_rss": "108620", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:21:05.045742 [debug] [MainThread]: Command `dbt run` failed at 15:21:05.045536 after 2.12 seconds
[0m15:21:05.047190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71589abb4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715897417e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x715898fe35e0>]}
[0m15:21:05.048839 [debug] [MainThread]: Flushing usage events
[0m15:22:07.041181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce137f30610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce1363ad720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce1363ad6c0>]}


============================== 15:22:07.047726 | 7fe0fff6-59a2-4434-8afa-604ad73e6a03 ==============================
[0m15:22:07.047726 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:22:07.049720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_engagement_emails', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:22:07.253816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fe0fff6-59a2-4434-8afa-604ad73e6a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce1363ef4c0>]}
[0m15:22:07.349780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fe0fff6-59a2-4434-8afa-604ad73e6a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce1385ba170>]}
[0m15:22:07.352213 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:22:07.369078 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:22:08.307094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:22:08.311601 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/sources/src_hubspot.yml
[0m15:22:08.864741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fe0fff6-59a2-4434-8afa-604ad73e6a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce12e331480>]}
[0m15:22:08.911815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fe0fff6-59a2-4434-8afa-604ad73e6a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce1349d4ee0>]}
[0m15:22:08.913732 [info ] [MainThread]: Found 49 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:22:08.915767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fe0fff6-59a2-4434-8afa-604ad73e6a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce1349d5030>]}
[0m15:22:08.919018 [info ] [MainThread]: 
[0m15:22:08.921626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:08.924525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:22:08.937234 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:22:08.939328 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:22:08.941035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.951762 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:22:08.954648 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:22:08.961320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m15:22:08.962603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:22:08.964337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:22:08.965812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:22:08.972060 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:22:08.975674 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:22:08.979703 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:22:08.982760 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:22:08.984913 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:22:08.986536 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:22:08.988178 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:22:08.989598 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:22:08.990992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:08.992490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.993911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:08.995163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:09.004807 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:09.006003 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:09.007560 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:09.008557 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:22:09.010405 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:22:09.010901 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:09.012206 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:22:09.013695 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:22:09.015297 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:22:09.016742 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:22:09.017995 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:22:09.021517 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:22:09.023711 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:22:09.024174 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:22:09.026918 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:22:09.027556 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m15:22:09.029820 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:22:09.030343 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:22:09.031851 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:22:09.034119 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:22:09.036062 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:22:09.037905 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:22:09.041443 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:22:09.044076 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:22:09.056640 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.058250 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.059651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:09.069031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:09.070884 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.072392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:09.115011 [debug] [MainThread]: SQL status: SELECT 20 in 0.0 seconds
[0m15:22:09.118933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fe0fff6-59a2-4434-8afa-604ad73e6a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce12e34e380>]}
[0m15:22:09.120992 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:09.122887 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.124501 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.127328 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:09.129038 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.130886 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.132596 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.134772 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:22:09.136308 [debug] [MainThread]: On master: Close
[0m15:22:09.138329 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:09.140296 [info ] [MainThread]: 
[0m15:22:09.149346 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagement_emails
[0m15:22:09.151139 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagement_emails ................ [RUN]
[0m15:22:09.153577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_engagement_emails)
[0m15:22:09.155369 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagement_emails
[0m15:22:09.163573 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagement_emails"
[0m15:22:09.175277 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_emails (compile): 15:22:09.156740 => 15:22:09.174798
[0m15:22:09.176787 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagement_emails
[0m15:22:09.210588 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagement_emails"
[0m15:22:09.222320 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:22:09.223565 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: BEGIN
[0m15:22:09.224981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:09.233520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:22:09.235026 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:22:09.236424 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_emails"} */

  create view "warehouse"."marts_staging"."stg_engagement_emails__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw__stream_engagements_emails
)

select
    (j->>'id')::bigint                                   as email_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    nullif(j->'properties'->>'hs_timestamp','')::timestamptz as email_timestamp,
    (j->'properties'->>'hs_email_subject')              as subject,
    (j->'properties'->>'hs_email_status')               as status,
    (j->'properties'->>'hs_email_direction')            as direction, -- INCOMING / OUTGOING

    nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

    j->'contacts'   as contacts_json,
    j->'companies'  as companies_json,
    j->'deals'      as deals_json,
    j->'tickets'    as tickets_json,

    extracted_at
from src
  );
[0m15:22:09.239107 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airbyte_internal.raw__stream_engagements_emails" does not exist
LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                  ^

[0m15:22:09.240816 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: ROLLBACK
[0m15:22:09.242444 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_emails (execute): 15:22:09.177701 => 15:22:09.242199
[0m15:22:09.244107 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: Close
[0m15:22:09.247291 [debug] [Thread-1 (]: Database Error in model stg_engagement_emails (models/staging/hubspot/stg_engagement_emails.sql)
  relation "airbyte_internal.raw__stream_engagements_emails" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_engagement_emails.sql
[0m15:22:09.249989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fe0fff6-59a2-4434-8afa-604ad73e6a03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce12e3948e0>]}
[0m15:22:09.251923 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_engagement_emails ....... [[31mERROR[0m in 0.10s]
[0m15:22:09.254130 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagement_emails
[0m15:22:09.257427 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.258917 [debug] [MainThread]: On master: BEGIN
[0m15:22:09.260299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:09.269448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:09.271412 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.273130 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:09.274808 [debug] [MainThread]: On master: COMMIT
[0m15:22:09.276464 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:22:09.277859 [debug] [MainThread]: On master: Close
[0m15:22:09.279683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:09.281592 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:22:09.282987 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:22:09.284054 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:22:09.285144 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagement_emails' was properly closed.
[0m15:22:09.286383 [info ] [MainThread]: 
[0m15:22:09.288301 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:22:09.290523 [debug] [MainThread]: Command end result
[0m15:22:09.323827 [info ] [MainThread]: 
[0m15:22:09.325869 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:22:09.327855 [info ] [MainThread]: 
[0m15:22:09.329789 [error] [MainThread]:   Database Error in model stg_engagement_emails (models/staging/hubspot/stg_engagement_emails.sql)
  relation "airbyte_internal.raw__stream_engagements_emails" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_engagement_emails.sql
[0m15:22:09.331709 [info ] [MainThread]: 
[0m15:22:09.333608 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:22:09.336245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.3528519, "process_user_time": 2.899497, "process_kernel_time": 0.338274, "process_mem_max_rss": "112144", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:22:09.338262 [debug] [MainThread]: Command `dbt run` failed at 15:22:09.338054 after 2.35 seconds
[0m15:22:09.340393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce137f30610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce1385ba170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ce12e3948e0>]}
[0m15:22:09.342157 [debug] [MainThread]: Flushing usage events
[0m15:22:47.101080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124225009a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712420979900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124209798a0>]}


============================== 15:22:47.107914 | 254a2793-b9f4-4623-80d2-0ee611ab26a3 ==============================
[0m15:22:47.107914 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:22:47.110386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_engagement_emails', 'send_anonymous_usage_stats': 'True'}
[0m15:22:47.326355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '254a2793-b9f4-4623-80d2-0ee611ab26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124209bf550>]}
[0m15:22:47.414281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '254a2793-b9f4-4623-80d2-0ee611ab26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x712422b88d60>]}
[0m15:22:47.416805 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:22:47.433074 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:22:48.416170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:48.418008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:48.429295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '254a2793-b9f4-4623-80d2-0ee611ab26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71241edd2500>]}
[0m15:22:48.478402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '254a2793-b9f4-4623-80d2-0ee611ab26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71241eeb5180>]}
[0m15:22:48.480237 [info ] [MainThread]: Found 49 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:22:48.482452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '254a2793-b9f4-4623-80d2-0ee611ab26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71241eeb52d0>]}
[0m15:22:48.486288 [info ] [MainThread]: 
[0m15:22:48.488748 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:22:48.491884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:22:48.504135 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:22:48.505817 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:22:48.506965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:48.518726 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:22:48.521211 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:22:48.526817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:22:48.528233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:22:48.529410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:22:48.530685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:22:48.536921 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:22:48.540009 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:22:48.543913 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:22:48.547467 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:22:48.549398 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:22:48.551148 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:22:48.553556 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:22:48.555228 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:22:48.556532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:48.557755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:48.558994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:48.560943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:48.569742 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:48.571425 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:22:48.571895 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:48.573126 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:48.573711 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:22:48.575187 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:22:48.575693 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:22:48.577486 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:22:48.579487 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:22:48.581153 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:22:48.582819 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:22:48.583430 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m15:22:48.585043 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:22:48.590826 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:22:48.591472 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:22:48.592320 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:22:48.594503 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:22:48.596723 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:22:48.597409 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:22:48.599493 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:22:48.605761 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:22:48.607850 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:22:48.609964 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:22:48.612991 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:22:48.621987 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.623915 [debug] [MainThread]: On master: BEGIN
[0m15:22:48.625626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:48.634757 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:48.636413 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.638013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:22:48.681637 [debug] [MainThread]: SQL status: SELECT 20 in 0.0 seconds
[0m15:22:48.685208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '254a2793-b9f4-4623-80d2-0ee611ab26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71241eeb4490>]}
[0m15:22:48.687068 [debug] [MainThread]: On master: ROLLBACK
[0m15:22:48.689067 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.690566 [debug] [MainThread]: On master: BEGIN
[0m15:22:48.692941 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:48.694806 [debug] [MainThread]: On master: COMMIT
[0m15:22:48.696333 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.697861 [debug] [MainThread]: On master: COMMIT
[0m15:22:48.699649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:22:48.701495 [debug] [MainThread]: On master: Close
[0m15:22:48.703669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:48.705596 [info ] [MainThread]: 
[0m15:22:48.715698 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagement_emails
[0m15:22:48.717532 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagement_emails ................ [RUN]
[0m15:22:48.719233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_engagement_emails)
[0m15:22:48.720798 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagement_emails
[0m15:22:48.730272 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagement_emails"
[0m15:22:48.742511 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_emails (compile): 15:22:48.722053 => 15:22:48.742130
[0m15:22:48.744558 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagement_emails
[0m15:22:48.777881 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagement_emails"
[0m15:22:48.790042 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:22:48.791490 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: BEGIN
[0m15:22:48.792913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:48.802008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:22:48.803389 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:22:48.805042 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_emails"} */

  create view "warehouse"."marts_staging"."stg_engagement_emails__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw__stream_engagements_emails
)

select
    (j->>'id')::bigint                                   as email_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    nullif(j->'properties'->>'hs_timestamp','')::timestamptz as email_timestamp,
    (j->'properties'->>'hs_email_subject')              as subject,
    (j->'properties'->>'hs_email_status')               as status,
    (j->'properties'->>'hs_email_direction')            as direction, -- INCOMING / OUTGOING

    nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

    j->'contacts'   as contacts_json,
    j->'companies'  as companies_json,
    j->'deals'      as deals_json,
    j->'tickets'    as tickets_json,

    extracted_at
from src
  );
[0m15:22:48.807392 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "airbyte_internal.raw__stream_engagements_emails" does not exist
LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                  ^

[0m15:22:48.808882 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: ROLLBACK
[0m15:22:48.810581 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_emails (execute): 15:22:48.745812 => 15:22:48.810271
[0m15:22:48.812035 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: Close
[0m15:22:48.815266 [debug] [Thread-1 (]: Database Error in model stg_engagement_emails (models/staging/hubspot/stg_engagement_emails.sql)
  relation "airbyte_internal.raw__stream_engagements_emails" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_engagement_emails.sql
[0m15:22:48.817017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254a2793-b9f4-4623-80d2-0ee611ab26a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71241eaea7a0>]}
[0m15:22:48.818622 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_engagement_emails ....... [[31mERROR[0m in 0.10s]
[0m15:22:48.820854 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagement_emails
[0m15:22:48.824270 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.825560 [debug] [MainThread]: On master: BEGIN
[0m15:22:48.826739 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:48.835297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:22:48.836608 [debug] [MainThread]: On master: COMMIT
[0m15:22:48.837543 [debug] [MainThread]: Using postgres connection "master"
[0m15:22:48.838421 [debug] [MainThread]: On master: COMMIT
[0m15:22:48.839696 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:22:48.841398 [debug] [MainThread]: On master: Close
[0m15:22:48.844121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:48.845607 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:22:48.847228 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:22:48.849132 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:22:48.850502 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagement_emails' was properly closed.
[0m15:22:48.851866 [info ] [MainThread]: 
[0m15:22:48.853355 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m15:22:48.855482 [debug] [MainThread]: Command end result
[0m15:22:48.935673 [info ] [MainThread]: 
[0m15:22:48.937474 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:22:48.939349 [info ] [MainThread]: 
[0m15:22:48.941487 [error] [MainThread]:   Database Error in model stg_engagement_emails (models/staging/hubspot/stg_engagement_emails.sql)
  relation "airbyte_internal.raw__stream_engagements_emails" does not exist
  LINE 11:     from warehouse.airbyte_internal.raw__stream_engagements_...
                    ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_engagement_emails.sql
[0m15:22:48.943493 [info ] [MainThread]: 
[0m15:22:48.945592 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:22:48.948416 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.903353, "process_user_time": 2.409496, "process_kernel_time": 0.488303, "process_mem_max_rss": "105672", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:22:48.950352 [debug] [MainThread]: Command `dbt run` failed at 15:22:48.950157 after 1.91 seconds
[0m15:22:48.952141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7124225009a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71241ef4cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71241edc9e40>]}
[0m15:22:48.954379 [debug] [MainThread]: Flushing usage events
[0m15:23:07.921624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef9919c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef97619900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef976198a0>]}


============================== 15:23:07.928367 | c5540309-361f-4c23-9fc6-ccec8312252b ==============================
[0m15:23:07.928367 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:23:07.930384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_engagement_emails', 'send_anonymous_usage_stats': 'True'}
[0m15:23:08.122197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5540309-361f-4c23-9fc6-ccec8312252b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef9765b550>]}
[0m15:23:08.206069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5540309-361f-4c23-9fc6-ccec8312252b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef99828d60>]}
[0m15:23:08.208265 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:23:08.225465 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:23:09.128685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:23:09.131537 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_engagement_emails.sql
[0m15:23:09.292786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5540309-361f-4c23-9fc6-ccec8312252b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef8f73c5e0>]}
[0m15:23:09.382466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5540309-361f-4c23-9fc6-ccec8312252b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef958b75b0>]}
[0m15:23:09.384484 [info ] [MainThread]: Found 49 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:23:09.386351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5540309-361f-4c23-9fc6-ccec8312252b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef958e4520>]}
[0m15:23:09.389597 [info ] [MainThread]: 
[0m15:23:09.392147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:09.395497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:23:09.407091 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:23:09.408972 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:23:09.410358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:09.421136 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:23:09.423976 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:23:09.429407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_staging)
[0m15:23:09.430929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:23:09.432370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:23:09.439331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:23:09.440478 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:23:09.443956 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:23:09.447144 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:23:09.451962 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:23:09.453454 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:23:09.455202 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:23:09.456827 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:23:09.458252 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:23:09.459533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:09.460965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:09.462641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:09.464278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:09.473204 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:09.474311 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:09.475418 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:23:09.477004 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:09.478184 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:09.479004 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:23:09.480642 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:23:09.481810 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:23:09.483005 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:23:09.484442 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:23:09.486883 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:23:09.488557 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:23:09.490350 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.0 seconds
[0m15:23:09.494001 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:23:09.495234 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:23:09.496125 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:23:09.498384 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:23:09.500984 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:23:09.503781 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:23:09.506461 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:23:09.508663 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:23:09.509929 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:23:09.511290 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:23:09.512756 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:23:09.528588 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.530144 [debug] [MainThread]: On master: BEGIN
[0m15:23:09.531709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:09.540269 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:09.541734 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.543110 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:09.586833 [debug] [MainThread]: SQL status: SELECT 20 in 0.0 seconds
[0m15:23:09.590413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5540309-361f-4c23-9fc6-ccec8312252b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef9765b5b0>]}
[0m15:23:09.592418 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:09.594210 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.596216 [debug] [MainThread]: On master: BEGIN
[0m15:23:09.598415 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:09.600049 [debug] [MainThread]: On master: COMMIT
[0m15:23:09.601474 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.603062 [debug] [MainThread]: On master: COMMIT
[0m15:23:09.604949 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:09.606876 [debug] [MainThread]: On master: Close
[0m15:23:09.608870 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:23:09.610579 [info ] [MainThread]: 
[0m15:23:09.620557 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_engagement_emails
[0m15:23:09.622086 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_engagement_emails ................ [RUN]
[0m15:23:09.624226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_marts, now model.hubspot_dbt.stg_engagement_emails)
[0m15:23:09.626256 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_engagement_emails
[0m15:23:09.634766 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_engagement_emails"
[0m15:23:09.648920 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_emails (compile): 15:23:09.627565 => 15:23:09.648424
[0m15:23:09.650775 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_engagement_emails
[0m15:23:09.685850 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_engagement_emails"
[0m15:23:09.696740 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:23:09.697866 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: BEGIN
[0m15:23:09.698815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:09.707646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:09.709388 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:23:09.710455 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_emails"} */

  create view "warehouse"."marts_staging"."stg_engagement_emails__dbt_tmp"
    
    
  as (
    with src as (
    select
        (_airbyte_data)::jsonb as j,
        _airbyte_extracted_at  as extracted_at
    from warehouse.airbyte_internal.raw_hubspot_raw__stream_engagements_emails
)

select
    (j->>'id')::bigint                                   as email_id,

    nullif(j->>'createdAt','')::timestamptz             as created_at_raw,
    nullif(j->>'updatedAt','')::timestamptz             as updated_at_raw,

    nullif(j->'properties'->>'hs_timestamp','')::timestamptz as email_timestamp,
    (j->'properties'->>'hs_email_subject')              as subject,
    (j->'properties'->>'hs_email_status')               as status,
    (j->'properties'->>'hs_email_direction')            as direction, -- INCOMING / OUTGOING

    nullif(j->'properties'->>'hubspot_owner_id','')::bigint as owner_id,

    j->'contacts'   as contacts_json,
    j->'companies'  as companies_json,
    j->'deals'      as deals_json,
    j->'tickets'    as tickets_json,

    extracted_at
from src
  );
[0m15:23:09.717719 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:23:09.724475 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:23:09.726226 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_emails"} */
alter table "warehouse"."marts_staging"."stg_engagement_emails__dbt_tmp" rename to "stg_engagement_emails"
[0m15:23:09.727877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:23:09.741519 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: COMMIT
[0m15:23:09.743803 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:23:09.745100 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: COMMIT
[0m15:23:09.749106 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:23:09.757946 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_engagement_emails__dbt_backup"
[0m15:23:09.763139 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_engagement_emails"
[0m15:23:09.765025 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_engagement_emails"} */
drop view if exists "warehouse"."marts_staging"."stg_engagement_emails__dbt_backup" cascade
[0m15:23:09.766749 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:23:09.769346 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_engagement_emails (execute): 15:23:09.652685 => 15:23:09.769144
[0m15:23:09.771096 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_engagement_emails: Close
[0m15:23:09.773175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5540309-361f-4c23-9fc6-ccec8312252b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef8f52ff40>]}
[0m15:23:09.775016 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_engagement_emails ........... [[32mCREATE VIEW[0m in 0.15s]
[0m15:23:09.777248 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_engagement_emails
[0m15:23:09.781373 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.782951 [debug] [MainThread]: On master: BEGIN
[0m15:23:09.784920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:09.794337 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:09.795962 [debug] [MainThread]: On master: COMMIT
[0m15:23:09.797466 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:09.798964 [debug] [MainThread]: On master: COMMIT
[0m15:23:09.800687 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:09.802013 [debug] [MainThread]: On master: Close
[0m15:23:09.803720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:09.805072 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:23:09.806582 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:23:09.808034 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:23:09.809260 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_engagement_emails' was properly closed.
[0m15:23:09.810635 [info ] [MainThread]: 
[0m15:23:09.812333 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m15:23:09.814417 [debug] [MainThread]: Command end result
[0m15:23:09.849474 [info ] [MainThread]: 
[0m15:23:09.851561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:09.853291 [info ] [MainThread]: 
[0m15:23:09.855311 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:23:09.857861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9918314, "process_user_time": 2.607244, "process_kernel_time": 0.416997, "process_mem_max_rss": "108464", "process_out_blocks": "664", "process_in_blocks": "0"}
[0m15:23:09.859738 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:09.859534 after 1.99 seconds
[0m15:23:09.861609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef9919c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef958c71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ef95b59210>]}
[0m15:23:09.864004 [debug] [MainThread]: Flushing usage events
[0m15:23:32.164063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c488b04370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c4872757b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c487274a60>]}


============================== 15:23:32.171092 | 1755f4a8-30af-4d3f-8a28-0f778ff3b5e4 ==============================
[0m15:23:32.171092 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:23:32.173092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_owners_all', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:32.380513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1755f4a8-30af-4d3f-8a28-0f778ff3b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c486fc7430>]}
[0m15:23:32.467049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1755f4a8-30af-4d3f-8a28-0f778ff3b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c48918d060>]}
[0m15:23:32.469533 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:23:32.486209 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:23:33.503334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:33.505309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:33.515489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1755f4a8-30af-4d3f-8a28-0f778ff3b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c4853d63e0>]}
[0m15:23:33.565353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1755f4a8-30af-4d3f-8a28-0f778ff3b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c4854b5060>]}
[0m15:23:33.567228 [info ] [MainThread]: Found 49 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:23:33.569384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1755f4a8-30af-4d3f-8a28-0f778ff3b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c4854b51b0>]}
[0m15:23:33.572610 [info ] [MainThread]: 
[0m15:23:33.575027 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:33.578043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:23:33.590773 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:23:33.592541 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:23:33.593921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:33.607423 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:23:33.610414 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:23:33.616297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m15:23:33.618296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:23:33.619669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:23:33.621515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:23:33.627476 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:23:33.630548 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:23:33.634571 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:23:33.638077 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:23:33.639793 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:23:33.641137 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:23:33.643020 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:23:33.644846 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:23:33.646362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:33.647831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:33.649598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:33.651122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:33.661629 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:33.663686 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:33.665899 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:23:33.666534 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:33.667953 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:23:33.668551 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:23:33.669926 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:23:33.671861 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:23:33.673501 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:23:33.675452 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:23:33.678891 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:23:33.681928 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:23:33.682701 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:23:33.685431 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:23:33.689099 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m15:23:33.691065 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:23:33.694972 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:23:33.697970 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:23:33.698460 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:23:33.700335 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:23:33.702141 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:23:33.703663 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:23:33.705841 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:23:33.716970 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:23:33.726089 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.727661 [debug] [MainThread]: On master: BEGIN
[0m15:23:33.728904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:33.737455 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:33.738945 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.740276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:33.784295 [debug] [MainThread]: SQL status: SELECT 21 in 0.0 seconds
[0m15:23:33.788245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1755f4a8-30af-4d3f-8a28-0f778ff3b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c4851e5b40>]}
[0m15:23:33.789964 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:33.791812 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.793258 [debug] [MainThread]: On master: BEGIN
[0m15:23:33.795186 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:33.796751 [debug] [MainThread]: On master: COMMIT
[0m15:23:33.798235 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.799673 [debug] [MainThread]: On master: COMMIT
[0m15:23:33.801299 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:33.802925 [debug] [MainThread]: On master: Close
[0m15:23:33.804836 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:23:33.806576 [info ] [MainThread]: 
[0m15:23:33.816667 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_owners_all
[0m15:23:33.818695 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_owners_all ....................... [RUN]
[0m15:23:33.820867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_intermediate, now model.hubspot_dbt.stg_owners_all)
[0m15:23:33.822632 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_owners_all
[0m15:23:33.831306 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_owners_all"
[0m15:23:33.845708 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_all (compile): 15:23:33.824129 => 15:23:33.845316
[0m15:23:33.847920 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_owners_all
[0m15:23:33.884036 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_owners_all"
[0m15:23:33.895781 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:23:33.897221 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: BEGIN
[0m15:23:33.898547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:33.924070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:23:33.926059 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:23:33.927418 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_all"} */

  create view "warehouse"."marts_staging"."stg_owners_all__dbt_tmp"
    
    
  as (
    with active as (
    select
        owner_id,
        email,
        first_name,
        last_name,
        false as is_archived,
        created_at,
        updated_at,
        user_id           as user_id,
        user_id_incl_inactive,
        extracted_at
    from "warehouse"."marts_staging"."stg_owner"
),

archived as (
    select
        owner_id,
        email,
        first_name,
        last_name,
        true  as is_archived,
        created_at,
        updated_at,
        null  as user_id,
        user_id_incl_inactive,
        extracted_at
    from "warehouse"."marts_staging"."stg_owners_archived"
)

select * from active
union all
select * from archived
  );
[0m15:23:33.930498 [debug] [Thread-1 (]: Postgres adapter: Postgres error: UNION types bigint and text cannot be matched
LINE 39: select * from archived
                ^

[0m15:23:33.932206 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: ROLLBACK
[0m15:23:33.934205 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_all (execute): 15:23:33.849645 => 15:23:33.933896
[0m15:23:33.935909 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: Close
[0m15:23:33.939880 [debug] [Thread-1 (]: Database Error in model stg_owners_all (models/staging/hubspot/stg_owners_all.sql)
  UNION types bigint and text cannot be matched
  LINE 39: select * from archived
                  ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_owners_all.sql
[0m15:23:33.941951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1755f4a8-30af-4d3f-8a28-0f778ff3b5e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c4850ee770>]}
[0m15:23:33.944173 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_owners_all .............. [[31mERROR[0m in 0.12s]
[0m15:23:33.946658 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_owners_all
[0m15:23:33.951100 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.952684 [debug] [MainThread]: On master: BEGIN
[0m15:23:33.954041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:33.962836 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:23:33.964486 [debug] [MainThread]: On master: COMMIT
[0m15:23:33.966534 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:33.968367 [debug] [MainThread]: On master: COMMIT
[0m15:23:33.970388 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:23:33.972404 [debug] [MainThread]: On master: Close
[0m15:23:33.974675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:33.976070 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:23:33.977212 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:23:33.978510 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:23:33.979924 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_owners_all' was properly closed.
[0m15:23:33.981156 [info ] [MainThread]: 
[0m15:23:33.982870 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:23:33.984997 [debug] [MainThread]: Command end result
[0m15:23:34.067470 [info ] [MainThread]: 
[0m15:23:34.069828 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:23:34.071954 [info ] [MainThread]: 
[0m15:23:34.073875 [error] [MainThread]:   Database Error in model stg_owners_all (models/staging/hubspot/stg_owners_all.sql)
  UNION types bigint and text cannot be matched
  LINE 39: select * from archived
                  ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_owners_all.sql
[0m15:23:34.076060 [info ] [MainThread]: 
[0m15:23:34.078248 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:23:34.081059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9724026, "process_user_time": 2.784851, "process_kernel_time": 0.506705, "process_mem_max_rss": "106224", "process_out_blocks": "664", "command_success": false, "process_in_blocks": "0"}
[0m15:23:34.083221 [debug] [MainThread]: Command `dbt run` failed at 15:23:34.082966 after 1.97 seconds
[0m15:23:34.085242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c488b04370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c48566e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c4853d2f80>]}
[0m15:23:34.087071 [debug] [MainThread]: Flushing usage events
[0m15:50:06.139361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f639544610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6379c1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f6379c16c0>]}


============================== 15:50:06.149594 | ad339fd7-f7e5-4b2d-840c-b08fbb5462fc ==============================
[0m15:50:06.149594 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:50:06.151624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_owners_all', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:06.388504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad339fd7-f7e5-4b2d-840c-b08fbb5462fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f637a034c0>]}
[0m15:50:06.493288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad339fd7-f7e5-4b2d-840c-b08fbb5462fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f639bce170>]}
[0m15:50:06.495368 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:50:06.514226 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:50:07.464997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:07.466759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:07.475853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad339fd7-f7e5-4b2d-840c-b08fbb5462fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f635e16470>]}
[0m15:50:07.531931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad339fd7-f7e5-4b2d-840c-b08fbb5462fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f635ef90f0>]}
[0m15:50:07.534010 [info ] [MainThread]: Found 49 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:50:07.536139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad339fd7-f7e5-4b2d-840c-b08fbb5462fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f635ef9240>]}
[0m15:50:07.539411 [info ] [MainThread]: 
[0m15:50:07.542122 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:07.546385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:50:07.562815 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:50:07.564773 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:50:07.566249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:07.584333 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:50:07.586837 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:50:07.593477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_kpi)
[0m15:50:07.594994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_marts'
[0m15:50:07.597383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:50:07.604416 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:50:07.605564 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:50:07.608664 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:50:07.613464 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:50:07.617504 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:50:07.619230 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:50:07.620526 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:50:07.622049 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:50:07.623711 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:50:07.625332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:07.626562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:07.627850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:07.629577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:07.640084 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:07.643934 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:07.645382 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:50:07.645899 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:07.646957 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:50:07.648184 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:50:07.649573 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:50:07.650090 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:07.651024 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:50:07.653424 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:50:07.655037 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:50:07.661934 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:50:07.662579 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:50:07.665645 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:50:07.666097 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:50:07.667627 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m15:50:07.668091 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:50:07.669568 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:50:07.672477 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:50:07.676250 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:50:07.676930 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:50:07.678000 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:50:07.682213 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:50:07.689617 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:50:07.697606 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.699469 [debug] [MainThread]: On master: BEGIN
[0m15:50:07.701145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:07.710803 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:07.712519 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.714083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:07.758665 [debug] [MainThread]: SQL status: SELECT 21 in 0.0 seconds
[0m15:50:07.762300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad339fd7-f7e5-4b2d-840c-b08fbb5462fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f635c25b40>]}
[0m15:50:07.764086 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:07.766106 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.767723 [debug] [MainThread]: On master: BEGIN
[0m15:50:07.769752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:07.771426 [debug] [MainThread]: On master: COMMIT
[0m15:50:07.773266 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.774656 [debug] [MainThread]: On master: COMMIT
[0m15:50:07.776283 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:07.777647 [debug] [MainThread]: On master: Close
[0m15:50:07.779599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:07.781272 [info ] [MainThread]: 
[0m15:50:07.791367 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_owners_all
[0m15:50:07.793169 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_owners_all ....................... [RUN]
[0m15:50:07.795501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_intermediate, now model.hubspot_dbt.stg_owners_all)
[0m15:50:07.797289 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_owners_all
[0m15:50:07.806760 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_owners_all"
[0m15:50:07.823261 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_all (compile): 15:50:07.798803 => 15:50:07.822909
[0m15:50:07.824694 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_owners_all
[0m15:50:07.860097 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_owners_all"
[0m15:50:07.871937 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:50:07.873752 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: BEGIN
[0m15:50:07.875292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:07.885553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:07.887092 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:50:07.888675 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_all"} */

  create view "warehouse"."marts_staging"."stg_owners_all__dbt_tmp"
    
    
  as (
    with active as (
    select
        owner_id,
        email,
        first_name,
        last_name,
        false as is_archived,
        created_at,
        updated_at,
        user_id           as user_id,
        user_id_incl_inactive,
        extracted_at
    from "warehouse"."marts_staging"."stg_owner"
),

archived as (
    select
        owner_id,
        email,
        first_name,
        last_name,
        true  as is_archived,
        created_at,
        updated_at,
        null  as user_id,
        user_id_incl_inactive,
        extracted_at
    from "warehouse"."marts_staging"."stg_owners_archived"
)

select * from active
union all
select * from archived
  );
[0m15:50:07.891833 [debug] [Thread-1 (]: Postgres adapter: Postgres error: UNION types bigint and text cannot be matched
LINE 39: select * from archived
                ^

[0m15:50:07.893609 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: ROLLBACK
[0m15:50:07.895529 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_all (execute): 15:50:07.826141 => 15:50:07.895225
[0m15:50:07.897044 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: Close
[0m15:50:07.907103 [debug] [Thread-1 (]: Database Error in model stg_owners_all (models/staging/hubspot/stg_owners_all.sql)
  UNION types bigint and text cannot be matched
  LINE 39: select * from archived
                  ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_owners_all.sql
[0m15:50:07.908824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad339fd7-f7e5-4b2d-840c-b08fbb5462fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f635d01570>]}
[0m15:50:07.910664 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marts_staging.stg_owners_all .............. [[31mERROR[0m in 0.11s]
[0m15:50:07.913101 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_owners_all
[0m15:50:07.916915 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.918575 [debug] [MainThread]: On master: BEGIN
[0m15:50:07.919962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:07.930402 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:07.932096 [debug] [MainThread]: On master: COMMIT
[0m15:50:07.933926 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:07.935264 [debug] [MainThread]: On master: COMMIT
[0m15:50:07.937060 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:07.938567 [debug] [MainThread]: On master: Close
[0m15:50:07.940712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:07.942454 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:50:07.944072 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:50:07.945635 [debug] [MainThread]: Connection 'list_warehouse_marts_staging' was properly closed.
[0m15:50:07.947059 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_owners_all' was properly closed.
[0m15:50:07.948477 [info ] [MainThread]: 
[0m15:50:07.950139 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:50:07.952446 [debug] [MainThread]: Command end result
[0m15:50:08.032517 [info ] [MainThread]: 
[0m15:50:08.034631 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:08.036477 [info ] [MainThread]: 
[0m15:50:08.038412 [error] [MainThread]:   Database Error in model stg_owners_all (models/staging/hubspot/stg_owners_all.sql)
  UNION types bigint and text cannot be matched
  LINE 39: select * from archived
                  ^
  compiled Code at target/run/hubspot_dbt/models/staging/hubspot/stg_owners_all.sql
[0m15:50:08.040212 [info ] [MainThread]: 
[0m15:50:08.042323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:50:08.045037 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.973438, "process_user_time": 2.466006, "process_kernel_time": 0.543494, "process_mem_max_rss": "105644", "process_in_blocks": "1072", "process_out_blocks": "664", "command_success": false}
[0m15:50:08.046818 [debug] [MainThread]: Command `dbt run` failed at 15:50:08.046632 after 1.98 seconds
[0m15:50:08.048057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f639544610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f63603ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76f635e0c970>]}
[0m15:50:08.049417 [debug] [MainThread]: Flushing usage events
[0m15:50:24.343044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170db990880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d9dfd780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d9dfd720>]}


============================== 15:50:24.350716 | 6707cb6b-581e-4ff1-aac2-44a0004aabe6 ==============================
[0m15:50:24.350716 [info ] [MainThread]: Running with dbt=1.7.10
[0m15:50:24.352508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_owners_all', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:24.576203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6707cb6b-581e-4ff1-aac2-44a0004aabe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d9e3f4f0>]}
[0m15:50:24.658876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6707cb6b-581e-4ff1-aac2-44a0004aabe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170dc00cca0>]}
[0m15:50:24.660967 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m15:50:24.678165 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m15:50:25.549896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:25.552365 [debug] [MainThread]: Partial parsing: updated file: hubspot_dbt://models/staging/hubspot/stg_owners_all.sql
[0m15:50:25.904327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6707cb6b-581e-4ff1-aac2-44a0004aabe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d85e8b50>]}
[0m15:50:25.969603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6707cb6b-581e-4ff1-aac2-44a0004aabe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d823bf70>]}
[0m15:50:25.971695 [info ] [MainThread]: Found 49 models, 39 tests, 21 sources, 0 exposures, 0 metrics, 402 macros, 0 groups, 0 semantic models
[0m15:50:25.973776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6707cb6b-581e-4ff1-aac2-44a0004aabe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d9e3f730>]}
[0m15:50:25.977594 [info ] [MainThread]: 
[0m15:50:25.979984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:25.984043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse'
[0m15:50:25.997086 [debug] [ThreadPool]: Using postgres connection "list_warehouse"
[0m15:50:25.998879 [debug] [ThreadPool]: On list_warehouse: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:50:26.000325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:26.022802 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m15:50:26.025568 [debug] [ThreadPool]: On list_warehouse: Close
[0m15:50:26.031874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_warehouse, now list_warehouse_marts_marts)
[0m15:50:26.034364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_intermediate'
[0m15:50:26.035873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_kpi'
[0m15:50:26.037283 [debug] [ThreadPool]: Acquiring new postgres connection 'list_warehouse_marts_staging'
[0m15:50:26.043373 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:50:26.046753 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:50:26.050336 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:50:26.054004 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:50:26.055593 [debug] [ThreadPool]: On list_warehouse_marts_marts: BEGIN
[0m15:50:26.057354 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: BEGIN
[0m15:50:26.058825 [debug] [ThreadPool]: On list_warehouse_marts_kpi: BEGIN
[0m15:50:26.060592 [debug] [ThreadPool]: On list_warehouse_marts_staging: BEGIN
[0m15:50:26.062214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:26.063662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:26.065326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:26.066992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:26.077640 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:26.078805 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:26.080164 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_marts"
[0m15:50:26.082021 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_intermediate"
[0m15:50:26.083466 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:26.084434 [debug] [ThreadPool]: On list_warehouse_marts_marts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_marts"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_marts'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_marts'
  
[0m15:50:26.085729 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:50:26.086567 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_intermediate"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_intermediate'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_intermediate'
  
[0m15:50:26.088230 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_kpi"
[0m15:50:26.090792 [debug] [ThreadPool]: Using postgres connection "list_warehouse_marts_staging"
[0m15:50:26.093818 [debug] [ThreadPool]: On list_warehouse_marts_kpi: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_kpi"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_kpi'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_kpi'
  
[0m15:50:26.095637 [debug] [ThreadPool]: On list_warehouse_marts_staging: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "list_warehouse_marts_staging"} */
select
      'warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'marts_staging'
    union all
    select
      'warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'marts_staging'
  
[0m15:50:26.097326 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:50:26.099966 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:50:26.101896 [debug] [ThreadPool]: On list_warehouse_marts_marts: ROLLBACK
[0m15:50:26.104697 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: ROLLBACK
[0m15:50:26.105455 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m15:50:26.106085 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
[0m15:50:26.107763 [debug] [ThreadPool]: On list_warehouse_marts_marts: Close
[0m15:50:26.109474 [debug] [ThreadPool]: On list_warehouse_marts_intermediate: Close
[0m15:50:26.111641 [debug] [ThreadPool]: On list_warehouse_marts_kpi: ROLLBACK
[0m15:50:26.114668 [debug] [ThreadPool]: On list_warehouse_marts_staging: ROLLBACK
[0m15:50:26.121046 [debug] [ThreadPool]: On list_warehouse_marts_kpi: Close
[0m15:50:26.122830 [debug] [ThreadPool]: On list_warehouse_marts_staging: Close
[0m15:50:26.137759 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:26.139176 [debug] [MainThread]: On master: BEGIN
[0m15:50:26.140549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:26.155351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:26.157151 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:26.159040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:26.211903 [debug] [MainThread]: SQL status: SELECT 21 in 0.0 seconds
[0m15:50:26.215661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6707cb6b-581e-4ff1-aac2-44a0004aabe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d5ebfa60>]}
[0m15:50:26.217426 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:26.219158 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:26.220697 [debug] [MainThread]: On master: BEGIN
[0m15:50:26.222820 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:26.224380 [debug] [MainThread]: On master: COMMIT
[0m15:50:26.226128 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:26.227633 [debug] [MainThread]: On master: COMMIT
[0m15:50:26.229304 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:26.230814 [debug] [MainThread]: On master: Close
[0m15:50:26.232827 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:26.234854 [info ] [MainThread]: 
[0m15:50:26.244352 [debug] [Thread-1 (]: Began running node model.hubspot_dbt.stg_owners_all
[0m15:50:26.246138 [info ] [Thread-1 (]: 1 of 1 START sql view model marts_staging.stg_owners_all ....................... [RUN]
[0m15:50:26.248611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_warehouse_marts_staging, now model.hubspot_dbt.stg_owners_all)
[0m15:50:26.250631 [debug] [Thread-1 (]: Began compiling node model.hubspot_dbt.stg_owners_all
[0m15:50:26.262281 [debug] [Thread-1 (]: Writing injected SQL for node "model.hubspot_dbt.stg_owners_all"
[0m15:50:26.274574 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_all (compile): 15:50:26.252209 => 15:50:26.274162
[0m15:50:26.276849 [debug] [Thread-1 (]: Began executing node model.hubspot_dbt.stg_owners_all
[0m15:50:26.315684 [debug] [Thread-1 (]: Writing runtime sql for node "model.hubspot_dbt.stg_owners_all"
[0m15:50:26.329143 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:50:26.331091 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: BEGIN
[0m15:50:26.332616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:26.342200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:50:26.343728 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:50:26.345340 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_all"} */

  create view "warehouse"."marts_staging"."stg_owners_all__dbt_tmp"
    
    
  as (
    with active as (
    select
        owner_id::bigint                         as owner_id,
        email::text                              as email,
        first_name::text                         as first_name,
        last_name::text                          as last_name,
        false                                    as is_archived,
        created_at::timestamptz                  as created_at,
        updated_at::timestamptz                  as updated_at,
        user_id::bigint                          as user_id,
        user_id_incl_inactive::bigint            as user_id_incl_inactive,
        extracted_at
    from "warehouse"."marts_staging"."stg_owner"
),

archived as (
    select
        owner_id::bigint                         as owner_id,
        email::text                              as email,
        first_name::text                         as first_name,
        last_name::text                          as last_name,
        true                                     as is_archived,
        created_at::timestamptz                  as created_at,
        updated_at::timestamptz                  as updated_at,
        null::bigint                             as user_id,
        user_id_incl_inactive::bigint            as user_id_incl_inactive,
        extracted_at
    from "warehouse"."marts_staging"."stg_owners_archived"
)

select *
from active
union all
select *
from archived
  );
[0m15:50:26.354751 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:26.362345 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:50:26.364115 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_all"} */
alter table "warehouse"."marts_staging"."stg_owners_all__dbt_tmp" rename to "stg_owners_all"
[0m15:50:26.366348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:26.381301 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: COMMIT
[0m15:50:26.382913 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:50:26.384240 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: COMMIT
[0m15:50:26.389024 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:26.397475 [debug] [Thread-1 (]: Applying DROP to: "warehouse"."marts_staging"."stg_owners_all__dbt_backup"
[0m15:50:26.403721 [debug] [Thread-1 (]: Using postgres connection "model.hubspot_dbt.stg_owners_all"
[0m15:50:26.405487 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "hubspot_elt", "target_name": "dev", "node_id": "model.hubspot_dbt.stg_owners_all"} */
drop view if exists "warehouse"."marts_staging"."stg_owners_all__dbt_backup" cascade
[0m15:50:26.408014 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:26.410820 [debug] [Thread-1 (]: Timing info for model.hubspot_dbt.stg_owners_all (execute): 15:50:26.278629 => 15:50:26.410632
[0m15:50:26.412567 [debug] [Thread-1 (]: On model.hubspot_dbt.stg_owners_all: Close
[0m15:50:26.414960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6707cb6b-581e-4ff1-aac2-44a0004aabe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d5f0eec0>]}
[0m15:50:26.416909 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marts_staging.stg_owners_all .................. [[32mCREATE VIEW[0m in 0.17s]
[0m15:50:26.419260 [debug] [Thread-1 (]: Finished running node model.hubspot_dbt.stg_owners_all
[0m15:50:26.423365 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:26.425066 [debug] [MainThread]: On master: BEGIN
[0m15:50:26.426728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:26.436373 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:26.438265 [debug] [MainThread]: On master: COMMIT
[0m15:50:26.439852 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:26.441700 [debug] [MainThread]: On master: COMMIT
[0m15:50:26.443718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:26.445365 [debug] [MainThread]: On master: Close
[0m15:50:26.447246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:26.449039 [debug] [MainThread]: Connection 'list_warehouse_marts_marts' was properly closed.
[0m15:50:26.450529 [debug] [MainThread]: Connection 'list_warehouse_marts_intermediate' was properly closed.
[0m15:50:26.451938 [debug] [MainThread]: Connection 'list_warehouse_marts_kpi' was properly closed.
[0m15:50:26.453301 [debug] [MainThread]: Connection 'model.hubspot_dbt.stg_owners_all' was properly closed.
[0m15:50:26.454789 [info ] [MainThread]: 
[0m15:50:26.456850 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m15:50:26.459041 [debug] [MainThread]: Command end result
[0m15:50:26.493502 [info ] [MainThread]: 
[0m15:50:26.495498 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:26.497509 [info ] [MainThread]: 
[0m15:50:26.499802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:50:26.503578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2156756, "process_user_time": 2.895587, "process_kernel_time": 0.517355, "process_mem_max_rss": "108788", "process_in_blocks": "2264", "process_out_blocks": "664"}
[0m15:50:26.505725 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:26.505441 after 2.22 seconds
[0m15:50:26.507538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170db990880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d9dff5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7170d823bdc0>]}
[0m15:50:26.509097 [debug] [MainThread]: Flushing usage events
